                  DYLANWORKS REQUIRES ONE-WORD OBJECTS
                          issue.dylan-oneword
                       obsolete complete defect 
                             drj 1995-08-02

Urgency: 6 - serious
Importance: 6 - significant
Discoverer: drj
Discovery date: 02/08/95 16:27:03
Discovery process: chance -- metering Dylan code
Locaction: MMprod_dw_src!dwformat.c(<1.4)


DESCRIPTION:

drj: DylanWorks allocates 4 byte objects (1 word, no slots).  Currently we 
can't technically cope with this.  We need to amend our code to cope.

ROOT CAUSE:

richard:

1. The Dylan Project object format requirements weren't determined properly and 
documented.  The wrapper document doesn't explicitly exclude the possibility of 
one-word objects, and does implicitly include them.

2. The object format code was produced without properly considering this 
possibility.  A wrong assumption was made when designing the broken heart 
format.

SUGGESTIONS:

richard: We should be able to fix this by using a one-word broken heart which 
is actually a pointer with, say, the LSB set.  All that needs doing is to 
change the DWMove and DWIsMoved functions in MMprod_dw_src!dwformat.c to do 
this.  At the moment, we use a two-word broken heart with the second word being 
the forwarding pointer.

PROCESS SUGGESTIONS:



Resolver: richard
Date resolved: 14/08/95
Resolution process: Fixed during obj.two-phase-interface
Resolution: Modified DWMove and DWIsMoved in dwformat.c to use a one-word broken heart.


Internal notes: drj: DylanWorks allocates 4 byte objects (1 word, no slots).  Currently we 
can't technically cope with this.  We need to amend our code to cope.

richard: We should be able to fix this by using a one-word broken heart which 
is actually a pointer with, say, the LSB set.  All that needs doing is to 
change the DWMove and DWIsMoved functions to do this.  At the moment, we use a 
two-word broken heart with the second word being the forwarding pointer.
