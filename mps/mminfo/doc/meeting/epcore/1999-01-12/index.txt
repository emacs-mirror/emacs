                     MM/EP-CORE MEETING 1999-01-12
                       meeting.epcore.1999-01-12
                               draft doc
                            pekka 1999-01-14

.intro: Pekka P. Pirinen <pekka> met with Dave T. Berry <dtb> and Eric Penfold 
<ericp> to discuss the current situation of MM/EP-Core and the upcoming 
release, called brisling.

.situation.mm: MM are about to release brisling to QA, and are aiming to get 
brisling integrated to SW trunk on --01-25.  Eric can have a prerelease (on NT) 
this week.

.brisling.contents: From the list of important changes agreed at the last 
meeting (meeting.epcore.1998-12-15.priorities),
  1. colour pool (better than MV)
  2. VM performance
  3. MVFF performance
  4. segment placement (clever, with hints from client)
  5. SMP VM arenas
  6. meaningful MM asserts
  7. realloc
  8. pool merging
  9. allocation points
  10. garbage collection
2, 3, and 9 are going to be in brisling.  Pekka has tried various options for a 
faster colour pool, but has not been succesful yet.  Apart from that, we're on 
track for brisling.

.colour.analysis: According to the MM group's analysis, the colour pool never 
has very many objects in the free list, even though it allocates and frees a 
lot.  This means that clever free list structures cannot produce a significant 
improvement, what matters are the overheads.

.colour.reaction: Dave was unsatisfied in the lack of progress, and questioned 
whether all this overhead was necessary.  Pekka explained that it was the cost 
of modularity and flexibility, and promised to look at whether shaving a few 
corners would help (in particular the extra arguments of mps_alloc).  Dave 
suggested that lower-level interfaces could be provided that avoided some of 
the function calls in the current call path.

.colour.andy: Eric explained that Andy's segregated pool code 
(meeting.epcore.1998-12-15.color) actually caches a number of blocks on its 
free lists, avoiding calling mps_alloc.

.colour.manual-ap: Pekka explained that a similar idea, called manual 
allocation points, that would open-code some free list handling in the client 
code, had been considered by the MM group in the past.  This should be better 
than providing lots of new low-level  interfaces.  Pekka will raise the 
possibility of implementing it with the group.

.brisling.other: Pekka surveyed minor changes in brisling [the release notes 
will be a better source for this], and noted that five changes were proposed in 
the glue code.

.glue.mac: The MM group are lifting the Mac VM arena stubs out of the MPS 
interface, and this would ordinarily require a change in the glue.  The core 
group do not want to have _any_ platform dependencies in the core RIP, even in 
the makefiles, so Pekka agreed to include the stubs in the libraries the MM 
group produces for SW.  Dave was unhappy about hearing about an interface 
change after it was decided; Pekka explained that he had expected that 
discussing it with the other glue changes would be adequate, and promised to 
poll the core group about future interface changes at an early stage.

.glue.logs: The MM group are requesting some small additions to the glue to 
emit more information into the MPS logs, as this improves their ability to 
diagnose.  .glue.finish: For the same reason and on general principles, they 
are also requesting that as many as pools as possible be finished off in the 
proper way, and destroyed at least in mm_finish, if not earlier.  Pekka has 
identified some changes in the glue that are required for this [details on 
branch MMdevel_brisling; I'll work this out with Eric], and complained that he 
still couldn't destroy the temp pool, because "the tickle chain" is allocated 
there.  Eric will look at this, and he is also considering writing an 
mm_finish_local to clean up properly in the render threads.

.presentation: The MM presentation to the core group is scheduled for next 
Monday 3:30 at the House.  Dave asked MM to provide any handouts on Friday.

.next: The next MM/EP-Core meeting is tentatively scheduled on Tue 1999-02-02.

