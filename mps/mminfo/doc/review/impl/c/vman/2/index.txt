                    REVIEW RECORD FOR IMPL.C.VMAN(2)
                          review.impl.c.vman.2
                              draft review
                             drj 1995-10-06

Candidate: impl.c.vman(2)
Rules: rule.universal, guide.impl.c.*
Author: richard
Leader: richard
Lines: 155
Status: draft
Entry: ?
Exit: ?
Checkers: richard, dsm (tired and emotional), drj (perfectly sane, thanks)
Kickoff time: 1995-10-06 12:45

Rate: 10 lines/min

Logging start: 16:24  finish: 16:38  majors: 6  minors: 9  new: 2  questions: 2

1. M, drj, 77, Conformance between size_t and Addr is not checked, so they 
might not fit.
2. M, drj, 77, size parameter is used as size_t without a cast.
3. C, drj, 128, VMMap and VMUnmap are almost identical.
4. q, dsm, 93, Why use memset and not LibMemset, malloc and not LibMalloc, etc.?
5. m, dsm, 131-133, Confusing way to write that: write in ascending order using 
< and <= only.
6. MN, dsm, 93, size is used as a size_t without any sort of check.
7. M, richard, 1, Source documents aren't listed -- should include link to 
design.
8. m, richard, 9, "pretend" doesn't quite express the right thing.  It's 
inefficient, perhaps.  What is the aim?
9. m, richard, 12, Comment doesn't really explain what goes on very well.
10. q, richard, 21, Should we check that ANSI_VM is defined?
11. m, richard, 36, The purpose of the block field is to pass to free().  
Document.
12. M, richard, 42, Explain the purpose of VMAN_GRAIN in the leader comment and 
include a reference here.
13. m, richard, 60, Check the relationship of the block field to the base and 
limit fields.
14. MN, drj, 1, What if we malloc the last memory in store?
15. m, richard, 77, We can malloc size+VMAN_GRAIN-1.  Note, 14 doesn't apply if 
this isn't "fixed"!  Document this!!!
16. m, richard, 85, Suggest AVER that limit <= block + size.
17. m, richard, 93, Do the memset before we do the final validation.  
Validation should come last.
18. m, richard, 138, Uncast zero.

Edit (richard, 1995-10-13)

1. Added assertion to check.
2. Cast inserted.
3. That's a coincidence.
4. Answered question in mail.
5. Changed to use < and <= only.
6. See 1.
7. Added link to design.
8. Improved description.
9. See 8.
10. Punted to issue.vm-vman-check.
11. Added comment.
12. Done.
13. Done.
14. Not a problem.  Documented reason.
15. See 14.
16. Added, but < rather than <= (see 14).
17. Done.
18. Added cast.

Exit

Estimated remaining majors per page: 1.3

