                   DYLANWORKS OBJECT CONTAINER FORMAT
                         design.dylan.container
                             incomplete doc
                           richard 1996-04-10

INTRODUCTION

This document describes the formatting information that must be present
in DylanWorks run-time objects in order for the DylanWorks Memory
Manager to analyse and collect them.  This format information is known as
as the `container' of an object.


ATTACHMENTS


Dylan Container Format Reference, version 0
(ClarisWorks 1.0)


Dylan Container Format Reference, version 1
Vector Bias field, Version field.
(ClarisWorks 1.0)
(PostScript)

Dylan Container Format Reference, version 2
Subtype mask, explanation of header tags and dylan tags
 - DYLCO2.CWK  - DYLCO2.CWK (DR).ps 

ADDITIONAL NOTES

Requirements

Here is a(n incomplete) list of the DylanWorks requirements that have lead
to this design:

 - class pointer retrieval from object
 - fast hashing of objects by class
 - objects with a fixed number of slots
 - fixed slots may be an arbitrary mixuture of traceable and non-traceable
   words (tagged and untagged)
 - objects with different combinations of traceable and non-traceable
   slots but with the same layout (offset of slot from base of object)
 - vectors with a variable number of slots which are either all traceable
   or all non-traceable
 - no restriction on vector length
 - stretchy vectors with an atomic resize operation
 - vectors with non-word-sized slots.


Traceability and Tagging

Fields within an object are either traceable or non-traceable.  A
traceable field is considered to be a reference to another object if it
is aligned (the bottom (log_2 Q)-3 bits are zero), otherwise it is
ignored.  Non-traceable fields are ignored.
[The Dylan run-time currently uses tag 00 for references, 01 for ints,
and 10 for chars, I believe -- richard 1995-01-23]


Header Word

Currently all objects are wrapped and the header word is a pointer to the 
wrapper object.
Bits 0 and 1 of the header word are reserved for use during garbage collection 
and must
be left clear.

ATTACHMENTS
   "DYLCO2.CWK (DR).ps"
   "DYLCO2.CWK"
   "DYLCO1.PS"
   "ATT9O1N2"
   "DYLCO.CWK"

