            TIMING THE VIRTUAL MEMORY MANAGER IN WINDOWS NT
                             os.nt.vmalloc
                               draft doc
                             drj 1994-11-02

Caveat

The tests performed to produce the results in this document were
extremely naive.  The performance of the system under real conditions
can probably not be deduced from these results.

The tests

All the tests, except the variable size allocation test at the end,
performed 100000 allocations of some sort, with various options of
committing memory, writing to the memory, and with various sizes of
allocation.  Allocation was performed in bursts of 1000 allocations
followed by 1000 frees.

4k per allocation, MEM_RESERVE
  VirtualAlloc 25073ms
  VirtualFree  20124ms

As above but with 40k per allocation
  VirtualAlloc 28xxxms
  VirtualFree  24xxxms

4k per allocation, MEM_COMMIT
  VirtualAlloc 29574ms
  VirtualFree  23583ms

As above, with a write to each committed page
  VirtualAlloc 35680ms
  VirtualFree  21390ms

10000 variable size allocations (linearly increasing through
the burst) with a write to each block
  VirtualAlloc 3136.1ms
  VirtualFree  3676.0ms

From this we might conclude that a single VirtualAlloc takes from 300
to 350 microseconds, and a single VirtualFree from 200 to 400
microseconds.

