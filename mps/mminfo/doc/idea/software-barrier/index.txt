                           SOFTWARE BARRIERS
                         idea.software-barrier
                               draft idea
                            pekka 1997-09-23

I have thought for some time that we ought to have "store" and "load" functions 
in the MPS Interface, that would emulate all the protection stuff in hardware.  
These would be the default way of implementing a software barrier.  They 
wouldn't be hard to write. [richard 1997-09-03]

The first cut could trivially do the load or store, and let the hardware 
protection sort it out.  The second cut could avoid the OS overhead by checking 
the protection mode and calling ArenaAccess directly if necessary.  As a final 
improvement, we could have a version of PoolScan that scans a single reference 
(at a given location).  Probably optionally, since we could always check a pool 
attribute to see if the pool provides it, and scan the whole segment if it 
doesn't.

A software barrier with single reference scanning could be a significant 
optimization for weak tables.  See mail.pekka.1997-08-21.15-51(0).

