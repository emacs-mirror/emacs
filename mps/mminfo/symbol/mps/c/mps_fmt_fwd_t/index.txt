        DESCRIPTION OF THE MPS C INTERFACE SYMBOL MPS_FMT_FWD_T
                       symbol.mps.c.mps_fmt_fwd_t
                              draft symbol
                             drj 1999-05-10

NAME

mps_fmt_fwd_t

SUMMARY

The type of a format's forward method.  A forward method is used to insert 
relocation information in a heap.

ASSOCIATED PROTOCOLS

Copying collections; format.

TYPE

typedef void (*mps_fmt_fwd_t)(mps_addr_t old, mps_addr_t new);

ARGUMENTS

old
  the address of an object in the heap.
new
  an address in the heap that is suitably aligned for storing a copy of the 
object at address 'old' at.

RETURNED VALUES

N/A.

DESCRIPTION

A forward method is provided by the client as part of a format (see 
protocol.mps.format(0)).  The MPS calls a forward method when it has relocated 
an object.  The forward method when called must replace the object at 'old' 
with a "forwarding marker" that points to the address 'new'.  The forwarding 
marker must meet the following requirements:
- it must be possible for the MPS to call other format methods with the address 
of a forwarding marker as the argument.
- the forwarding marker must not be bigger than the original object.
- it must be possible to distinguish the forwarding marker from ordinary 
objects using the isfwd method (see symbol.mps.c.mps_fmt_isfwd_t(0)), the isfwd 
method must return the address 'new'.

Forward methods are used in format variants A (see symbol.mps.c.mps_fmt_a_t(0)) 
and B (see symbol.mps.c.mps_fmt_B_t(0)).

EXAMPLE

/* define the function */
void example_fwd(mps_addr_t old, mps_addr_t new)
{
  /* ... */
}

/* also define example_scan, example_skip, etc */

/* store pointer to function in the format variant struct */
struct mps_fmt_B_s example_fmt_B = {
  4,  /* align */
  example_scan,
  example_skip,
  example_copy,
  example_fwd,
  example_isfwd,
  example_pad,
  example_class
};

/* The (address of the) example_fmt_B object can now be passed to 
mps_fmt_create_B to create a format. */



SEE ALSO

protocol.mps.format(0)
symbol.mps.c.mps_fmt_a_t(0)
symbol.mps.c.mps_fmt_B_t(0)
symbol.mps.c.mps_fmt_isfwd_t(0)


NOTES




INTERNAL NOTES:

<information on the symbol or the symbol entry for internal use only; for 
example, This symbol's name may change, or The description needs a lot of 
work.  This will not be quoted externally without consultation.>

