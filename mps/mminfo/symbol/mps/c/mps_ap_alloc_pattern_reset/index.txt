              MPS C INTERFACE: MPS_AP_ALLOC_PATTERN_RESET
                symbol.mps.c.mps_ap_alloc_pattern_reset
                           incomplete symbol
                           gavinm 1998-10-21

NAME

mps_ap_alloc_pattern_reset


SUMMARY

Indicates the end of allocation pattern on an allocation point.


ASSOCIATED PROTOCOLS

AP, allocation, ramps, GC


SYNTAX

mps_res_t mps_ap_alloc_pattern_reset(mps_ap_t ap);


ARGUMENTS

ap                     The allocation point in which the patterned allocation 
occurred


RETURNED VALUES

Result code indicating whether end of the allocation patterns was successfully 
registered.


DESCRIPTION

This function may be used in place of mps_ap_alloc_pattern_end to end all 
extant allocation patterns on an allocation point.  It is anticipated that this 
may be used to recover from error conditions.


EXAMPLE

{
  res = mps_ap_alloc_pattern_begin(ap, mps_alloc_pattern_ramp());
  assert(res == mps_res_ok);

  do_some_work(); /* Leaves stuff lying around */

  res = mps_ap_alloc_pattern_begin(ap, mps_alloc_pattern_ramp());
  assert(res == mps_res_ok);

  res = do_some_more_work(); /* Tidies up after itself */
  if(res != mps_res_ok) {
    res = mps_ap_alloc_pattern_reset(ap);
    assert(res == mps_res_ok);
    
    return;
  }  

  res = mps_ap_alloc_pattern_end(ap, mps_alloc_pattern_ramp());
  assert(res == mps_res_ok);

  tidy_up_first_work();

  res = mps_ap_alloc_pattern_end(ap, mps_alloc_pattern_ramp());
  assert(res == mps_res_ok);
}


ERROR HANDLING

Cannot fail at present.  May fail in future if certain allocation patterns 
cannot be ended for that allocation point at that point in time.


SEE ALSO

symbol.mps.c.mps_alloc_pattern_ramp(0)
symbol.mps.c.mps_alloc_pattern_ramp_collect_all(0)
symbol.mps.c.mps_ap_alloc_pattern_begin(0)
symbol.mps.c.mps_ap_alloc_pattern_end(0)
protocol.mps.alloc-pattern-ramp(0)


NOTES


INTERNAL NOTES



