      DESCRIPTION OF THE MPS C INTERFACE SYMBOL "MPS_ROOT_SCAN_T"
                      symbol.mps.c.mps_root_scan_t
                              draft symbol
                            pekka 1998-01-21

NAME

mps_root_scan_t


SUMMARY

Type of root scanning functions for "mps_root_create".


ASSOCIATED PROTOCOLS

Root.


SYNTAX

typedef mps_res_t (*mps_root_scan_t)(mps_ss_t, void *, size_t)


RESOURCES

mps.h


DESCRIPTION

This is the type of root scanning functions the client provides to 
"mps_root_create".  These functions will be called, whenever the root needs to 
be scanned, with a scan state (of type "mps_ss_t"), and the "p" and "s" values 
specified in the call to "mps_root_create".  Apart from the argument list, the 
scanning function works like the format scan methods: it needs to indicate all 
references using mps_fix or MPS_FIX*.


EXAMPLE

static StackFrame *stackBottom;

/* root scanner for an imaginary interpreter for a stack-oriented language */
static mps_res_t rootScanner(mps_ss_t ss, void * p, size_t s)
{
  StackFrame *frame;
  size_t i;
  mps_res_t res;

  UNUSED(p); UNUSED(s);
  for(frame = stackBottom; frame != NULL; frame = frame->next)
    for(i = frame->size; i > 0; --i) {
      res = mps_fix(ss, &frame->locals[i]);
      if(res != MPS_RES_OK) return res;
   }
  return res;
}


ERROR HANDLING

If "mps_fix" returns a value other than "MPS_RES_OK", the scanning function 
must return that value, and may return without scanning further references.  
Generally, it is better if it returns as soon as possible.  If the scanning is 
completed successfully, the function should return "MPS_RES_OK".

SEE ALSO

mps_root_create, mps_fix, mps_ss_t, MPS_SCAN_BEGIN, MPS_SCAN_END, MPS_FIX, 
MPS_FIX1, MPS_FIX2, MPS_FIX_CALL, mps_fmt_scan_t

NOTES

See mps_fix.


INTERNAL NOTES




