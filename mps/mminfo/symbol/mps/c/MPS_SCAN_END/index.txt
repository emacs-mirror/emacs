                 MPS C INTERFACE SYMBOL "MPS_SCAN_END"
                       symbol.mps.c.MPS_SCAN_END
                              draft symbol
                            pekka 1998-01-27

NAME

MPS_SCAN_END


SUMMARY

The macro "MPS_SCAN_END" is part of the scanning protocol; it terminates a 
block started by "MPS_SCAN_BEGIN".


ASSOCIATED PROTOCOLS

Scanning.


SYNTAX

MPS_SCAN_END(ss);


ARGUMENTS

ss    the scan state argument that was passed to the scanning function


RESOURCES

mps.h


DESCRIPTION

This macro is used in the scanning protocol.  Together with "MPS_SCAN_BEGIN", 
it sets up local information used by the fast MPS_FIX* macros.  Note that 
"MPS_SCAN_END" completes the scanning, so successful termination of the 
scanning must invoke it (error branches can return without passing through).


EXAMPLE

mps_res_t scan_array(mps_ss_t ss, mps_addr_t object, size_t length)
{
  size_t i;
  mps_res_t res;
  mps_addr_t *array = (mps_addr_t *)object;

  MPS_SCAN_BEGIN(ss)
    for(i = 0; i < length; ++i) {
      res = MPS_FIX(ss, &array[i]);
      if(res != MPS_RES_OK) return res;
    }
  MPS_SCAN_END(ss);

  return res;
}


SEE ALSO

MPS_SCAN_BEGIN, MPS_FIX1, MPS_FIX2, MPS_FIX_CALL


NOTES

Between MPS_SCAN_BEGIN and MPS_SCAN_END, you may not call another scanning 
function directly, because the scan state parameter is in a strange state, so 
you shouldn't pass it as an argument to a function.  However, you can pass the 
scan state using MPS_FIX_CALL.


INTERNAL NOTES




