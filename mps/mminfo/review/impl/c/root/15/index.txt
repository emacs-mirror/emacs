                       REVIEW OF IMPL.C.ROOT(15)
                         review.impl.c.root.15
                              draft review
                           gavinm 1996-09-11

Rules: rule.impl, rule.universal
Checklists: check.impl.*
Source: impl.h.mpmst(8)
Candidate status: accepted

Author: richard
Leader: gavinm
Editor: gavinm
Scribe: gavinm
Approved: 1996-11-06

Entry: entry.universal, entry.impl
Entry manpower: 0.2


Entry notes:

entry.universal.source-available: No design

entry.universal.source-approved: No design, source in edit

entry.universal.rules-approved: rules unapproved

entry.universal.brief-check: Long lines noted

entry.universal.training: Failed as usual


Loggingstart: 15:13
Loggingend: 15:34
Logginglength: 21
Loggingrate: 1.6

Checkers: NickB;GavinM;PTW
Rate: 10 lines/minute
Length: 277

Kickoff start: 1996-09-11 14:00 BST Byre, Longstanton
Kickoff end: 14:08
Kickoff length: 8


ISSUES:

NickB: 2M, 6m, 1I, 1q, Trick, Limits, Mod, Min, Backwards, Cons (impl.h.mpslib, 
impl.h.mpm)
GavinM: 4M, 8m, 3q, 6I Justify, Platform. Dep, Constrain, Cons (impl.h.mpmst)
PTW: 2M, 3m Simple, Quality, Guide, Adapt, Cons

NickB:
1. 62 M pun
2. 247-269 M Completness: Two cases missing

PTW: 
3. 72-76 M Ring/Serial relationship; unexplained
4. 133 M Inconsistent name

GavinM: 
5. 60 M Doesn't AVER type of theUnion
6. 91,107,124,etc M Doesn't AVER rootReturn, space, rank
7. 211-212 M Pun Addr * and Addr

NickB: 
8. 1-10 m No .scope, .readership, .design, .transe, inadequate
9. 16-50 m No check on grey slot
10. 46 q Should this return FALSE?
11. 74 m should be after 76
12. 173 m Unused arg space
13. 175 m no check on TraceId
14. 240,241,272 q Why $P, not $A, e.g. line 62
15. - I No design doc

PTW:
16. 89 q Do we have a style guide on casting structures by value?
17. 102 m *p is a closure.  Shoudlw ehave a more abstract way?
18. 175 m space and ti not checked
19. 199-220 m Should the common code be moved out of the switch?
20. 7 mN copyright date??

GavinM:
21. 3 m Title could usefully be less terse
22. 9 m This comment is useless
23. 16 m should reference impl.h.mpmst
24. 21-22 I do we have any distinction between checking functions which are 
O(1) and ones which are not?
25. 25 I RootTable breaks naming convention
26. 26&c q why is this not NULL
27. 51 m This function requires comment
28. 68 I Is var a good name for this member
29. 51-84 I design should document initial state and reference &c
30. 140 q Are there any constraints on the value of p and s?
31. 193-194 m Unnecessary cast.
32. 241 m Long line
33. general I we should have a format for printing functions.
34. 240-243 &c I we should have special types for the casts whose names are 
derived systematically from the format codes.





Brainstorm start: 16:01
Brainstorm end: 16:12
Brainstorm length: 11


BRAINSTORM:

1. root * and Addr *.  Compiler doesn't get a chance to convert.  Does this 
happen every SpaceAlloc?  We have a solution.  Could we solve this with a magic 
macro for SpaceAlloc?  Won't get into fresh code.  Should do global search for 
SpaceAlloc.

2. Incomplete switch.  How did it happen?  Richard must have assumed the 
previous function was right.  Describe should have same modularity as rest.  
Might be because adding a new type will still compile without a Describe.  When 
debugging, we want more info than "UNREACHED".  Same with impl.c.pool.  Should 
also return resUNIMPL.  Should have ADT checklist for implementation procedure.


Number of major issues: 7
Number of minor issues: 15
Number of issues: 34
Major defects remaining: 1.75

Edit manpower: 7


Edit notes:

1. Fix: Use intermediate variable to avoid pun
2. Fix: Cases for FMT and REG added
3. Fix: Added design.mps.space.root-ring and reference
4. Fix: Changed to RootCreateFun also in impl.h.mpm and impl.c.mpsi
5. Fix: Created RootVarCheck and added AVER, also impl.h.mpm, impl.c.mpm, 
impl.h.mpmtypes
6. Fix: Added appropriate AVER(T)s
7. Reject: There is no pun here
8. Fix: Added .scope, .design; no .trans needed; .readership implict - 
rule.impl change request passed to Richard
9. Fix: check on grey slot added
10. mail: mail.gavinm.1996-11-06.12-28, design.mps.check.fun.return
11. Fix: moved as suggested
12. Fix: Space argument removed.  Also in impl.h.mpm, impl.c.trace (only use)
13. Fix: AVER added
14. Mail: mail.gavinm.1996-11-06.12-51, impl.c.root (fixed)
15. Reject: design.mps.root exists, but has insufficient in it; not my job to 
complete it 
16. Mail: mail.gavinm.1996-11-06.14-56, and replaced structure passing with 
pointer referece
17. Reject: You can't get more abstract than void *, but I've added a size_t to 
reg.scan, also in impl.h.mps, impl.c.mpsi, impl.h.mpm, impl.h.mpmst, 
impl.h.mpmtypes
18. Fix: See 12 & 13
19. Reject: The code is only common to three of the five cases
20. Fix: Added 1996
21. Reject: Title is not the place for anything else
22. Fix: reworded; more should be in the design
23. Fix: Added reference to impl.h.mpmst.root and also reverse reference to 
impl.c.root
24. Reject: Such issues are addressed in design.mps.check
25. Edit: Naming convention fixed in guide.impl.c.naming.ident.const
26. Mail: mail.gavinm.1996-11-06.13-36
27. Fix: comment addded as suggested
28. Reject: Yes.  It is derived from the name of the type "RootVar", with the 
"Root" removed because it is in the context of a Root.
29. Edit: Added design.mps.root.init and reference from impl.c.root.create
30. Mail: mail.gavinm.1996-11-06.14-05
31. Fix: Casts removed for Addr, SpaceAlloc shouldn't return Addr, created 
Pointer and functions, also in impl.c.space, impl.h.mpm, impl.h.mpmtypes, 
impl.c.mpm, impl.c.pool, impl.c.amc, impl.c.buffer, impl.c.format, impl.c.lo, 
impl.c.than, impl.c.thnti3, design.mps.type
32. Fix: long line split
33. Reject: See design.mps.writef for an examplar use of WriteF in a Describe 
method
34. Pass: Editor of impl.c.mpm (GavinM)


Exit: exit.universal
Exit manpower: 0.5

Manpowerused: 11
Manpowersaved: 70
