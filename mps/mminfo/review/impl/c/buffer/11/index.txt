                      REVIEW OF IMPL.C.BUFFER(11)
                        review.impl.c.buffer.11
                              draft review
                           gavinm 1996-08-20

Rules: rule.impl
Checklists: To be determined
Source: impl.h.mpmst(8), design.mps.buffer(0)
Candidate status: accepted

Author: drj
Leader: gavinm
Editor: drj
Scribe: gavinm
Approved: 1996-10-31

Entry: entry.universal, entry.impl
Entry manpower: 1


Entry notes:

Failed entry.universal.source-approved, entry.universal.rules-approved, entry.universal.training


Loggingstart: 15:30
Loggingend: 16:14
Logginglength: 44
Loggingrate: 2.2

Rate: 10 lines/minute
Length: 578 lines

Kickoff start: 1996-08-21 14:19 BST
Kickoff end: 14:23
Kickoff length: 4


ISSUES:

DRJ: (justify, min, limits, design) 1M 15m 7I 1C 
Richard: (quality, platform, mod, source) 17m 5M 2q (only got half-way through; 
tired)
NickB: (req, simple, trick) 20m 2M 1q 3I
GavinM: ( adapt, guide, dep, backwards) 3M 32m 3q 1I

DRJ:
1. 524-551 M check.impl.justify Why is this code?

Richard:
2. 250 M Rank not checked in general
3. 250 M exposed not checked
4. 250 M shieldMode not checked
5. 335-339 M Need a design
6. 156 M Rank not checked

NickB:
7. 89-92 M Unclear about returned value
8. 485 M Is this a transgression or what?

GavinM
9. 289 M Not all arguments AVERed
10. 517 M p not AVERed

DRJ:
11. check.impl.justify I implementations and requirements are misspelt in 
.scope and .change
12. check.impl.design I .summary is unclear
13. check.impl.limits.domain I Is any deviation in the domain of a function 
from its types documented?
14. check.impl.justify I What has .right got to do with question?
15. 6 m design not referenced
16. 8-113 m This is misplaced design/user doc/pool class impl doc
17. 8-113 m There is no mention of relationship to APs
18. - C There is much design and other doc misplaced, howevere it makes it 
easier to review having it in-line
19. 136 m Misplaced poolClass implementor's doc
20. design.mps.buffer I Document the alignment is always the same as the pool
21. 143 m Richard requested not using iff
22. 155,228,252 m rule.impl.mod
23. 160 m Punning
24. 170 m rule.impl.mod
25. design I fields exposed, seg, ranke, shieldMode, grey, p, and i need 
doc/design
26. 259 m Justification not clear
27. 302ff m Confusion about 0 and NULL
28. 331-342 m This code is misplaced wrt comment at 283-284
29. 335 mN incomplete since seg is not checked, see line 302
30. 364,PARENT I Therefore PARENT must be thread-safe (tag)
31. 384 m Some of this is misplaced design
32. 389,425,466,511 m Justification of Word type is unclear
33. 396,423,517,470 m Inconsistent wrt Word type
34. 485 m tag
35. 505 m asynchronously misspelt

Richard: 
36. 6 m purpose
37. 6 m consistency, no it's not
38. 121-126 m min, never used
39. 136-141 m inconsistent with impl
40. 155,228 m unclear
41. 155 m modularity; should be part of pool interface
42. 170 m justification; what is the alignment field for?
43. 226 m min; unnecessary
44. 287-296 q is it always legal to setBuffer?
45. 298-307 q Is it always legal to ResetBuffer?

NickB:
46. 6 m Does not refer to requirement
47. 6 m Should refer to the declarations in impl.h.mpm
48. 20 m insert "using"
49. - I When structures have sub-structures as fields, I find a lot of 
resulting ocde unclear; suggest such fields are distinguished by tag
50. 121-125 m These are misplaced wrt comment at line 312
51. 155 q Shouldn't this return ResUNIMPL
52. 164ff m Nice if inited in order
53. 164,167-169 m We're using 0 for NULL Addr
54. 204-214 m misplaced design
55. 250-268 I Need BoolCheck for exposed
56. 279 mN and seg field
57. 364 I One of these ap's is a field name; which?
58. 380 m e/it/is/
59. 385 m e/commit/Commit
60. 376-386 m Misplaced design or client doc
61. 420-422 m misplaced design
62. 447-463 m misplaced design
63. 472,474 m clairty; what does "pool will see" mean?
64. 505-508 m Misplaced design
65. 559 m Return value ignored
66. 559 m Not reporting several fields

GavinM:
67. - qN is serial ever used?
68. impl.h.mpmst:294 I add impl.c.buffer
69. 18 m reference
70. 72 m usual way needs reference
71. 149 m should reference impl.h.mpmst buffer and ap definitions
72. 172 m NULL should be cast to Seg
73. 248 m should reference impl.m.mpmst buffer and ap definitions
74. 250-267 m order of checking
75. 268 q can we check that rank is NULL?
76. 283-284 m misplaced comment
77. 302 m need cast NULL to Seg.
78. 376-377 m described above; needs reference
79. 380 m reliance on return value in error contravenes guidelines: it 
guarantees the value of a return argument in an error condition.
80. 403 q Could next be out of range
81. 421-422 m see the description needs reference
82. 448 m "see above" needs reference
83. 453-455 m should reference non-nesting design of commit/reserve
84. 472 m need reference to definition of flip
85. 478 m should document that this guarantees !bufferIsReady()
86. 488-489 m pucntuation; sentence break required
87. 492 m punctuation: capitalize trip
88. 505 m spelling: asynchronously
89. 505-508 m should have reference to design
90. 507-508 m see the description needs reference
91. 554 m needs reference to impl.h.mpmst buffer and ap definitons
92. 570-572 m AP description not structured
93. 565 q Do we do it like this elsewhere

DRJ:
94. 403 IN Requirement that AddrAdd be defined for all input values
95. 470 mN AVER ! BufferIsReady
96. 563-564 mN It's possible that some eights are missing here
----
DRJ (after):
97. 40-60 m The direction of the memory order is unclear



Brainstorm start: 16:15
Brainstorm end: 16:30
Brainstorm length: 15


BRAINSTORM:

2,3,4,6: How can we make sure fields are checked?
Richard: How about making it an entry criterion?
NickB: Polishing

1: Because no design 
Richard: LCLint suggestion, could express facts for checking

8. This is a transgression that needs fixing.
Could have been found on polishing.
Also needs fixing in mps.h

7. Use design documents.

Recommendation for editting: Need design but large load on editor.  Sufficient 
to chuck misplaced design into design doc and tag it.  Small thing but will 
allow editting into required form.  Design is still useful even if it's still a 
bunch of facts.

Richard was writing rules/checklist questions for every issue raised.  This 
seems useful.

Interrupted.  Could have notice on door.  MM Review in progress


Number of major issues: 10
Number of minor issues: 67
Number of issues: 97
Major defects remaining: 1.4

Edit manpower: 5


Edit notes:

1 in design
2 check added
3 check added
4 no check; commented
5 in design
6 check added
7 is clearer
8 tagged
9 check added
10 check added
11 spelled
12 clearer
13 other doc
14 other doc
15 ref design
16 in design
17 in design
18 -
19 in design
20 in design
21 no iff
22 tagged
23 pun rm
24 tagged
25 in design
26 in design
27 clearer
28 fixed
29 check added
30 tagged
31 in design
32 Word -> Size
33 Word -> Size
34 tagged
35 spelled
36 has purpose
37 consistent
38 rm
39 improved
40 clearer
41 tagged
42 in design
43 no action; is clearer
44 in design
45 in design
46 in design
47 refers
48 inserted
49 not done; see review.impl.h.mpmst.8
50 moved or removed
51 answered
52 sorted
53 (Addr)0
54 in design
55 tagged
56 tick ?
57 see 49
58 substituted
59 capitalized
60 in design
61 in design
62 in design
63 in design
64 in design
65 tick ?
66 added and commented
67 answered
68 not done; there exists a nearby tag
69 not done; it's a generic reference
70 changed
71 refers
72 not done; raised for discussion
73 refers
74 sorted
75 not done; it would be an error
76 moved
77 see 72
78 in design
79 raised
80 answered
81 in design
82 in design
83 in design
84 design.mps.collection.flip
85 in design
86 broken
87 capitalized
88 spelled
89 in design
90 in design
91 refers
92 noted ?
93 answered
94 in design
95 check added
96 raised.  Solved with WriteF
97 clearer

mail.drj.1996-08-30.13-36
mail.drj.1996-10-31.14-25 (guess)



Exit: exit.universal
Exit manpower: 1


Exit notes:

18 is a comment; I suppose no action is OK. - GavinM
Manpower saved: 10 major defects * 10 hours each (found in QA) = 100
Estimated remaining: 14 majors found / 10 pages = 1.4


Manpowerused: 14
Manpowersaved: 100
