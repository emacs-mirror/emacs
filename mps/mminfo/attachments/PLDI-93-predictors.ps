%!PS-Adobe-2.0
%%Creator: dvips 5.499 Copyright 1986, 1993 Radical Eye Software
%%Title: pldi.dvi
%%CreationDate: Thu Apr  1 13:04:04 1993
%%Pages: 11
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Roman Times-Italic Courier
%%EndComments
%DVIPSCommandLine: dvips -o pldi.ps pldi
%DVIPSSource:  TeX output 1993.04.01:1303
%%BeginProcSet: tex.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N /X{S N}
B /TR{translate}N /isls false N /vsize 11 72 mul N /@rigin{isls{[0 -1 1 0 0 0]
concat}if 72 Resolution div 72 VResolution div neg scale isls{Resolution hsize
-72 div mul 0 TR}if Resolution VResolution vsize -72 div 1 add mul TR matrix
currentmatrix dup dup 4 get round 4 exch put dup dup 5 get round 5 exch put
setmatrix}N /@landscape{/isls true N}B /@manualfeed{statusdict /manualfeed
true put}B /@copies{/#copies X}B /FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N
/IE 0 N /ctr 0 N /df-tail{/nn 8 dict N nn begin /FontType 3 N /FontMatrix
fntrx N /FontBBox FBB N string /base X array /BitMaps X /BuildChar{
CharBuilder}N /Encoding IE N end dup{/foo findfont setfont}3 array copy cvx N
load 0 nn put /ctr 0 N[}B /df{/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X
/fntrx[sf 0 0 sf neg 0 0]N df-tail}B /E{pop nn dup definefont setfont}B
/ch-width{ch-data dup length 5 sub get}B /ch-height{ch-data dup length 4 sub
get}B /ch-xoff{128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup
length 2 sub get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{
ch-data dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup /base
get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx 0 ch-xoff
ch-yoff ch-height sub ch-xoff ch-width add ch-yoff setcachedevice ch-width
ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff .1 add]{ch-image}imagemask
restore}B /D{/cc X dup type /stringtype ne{]}if nn /base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{dup dup length 1 sub dup 2 index S get sf div put
}if put /ctr ctr 1 add N}B /I{cc 1 add D}B /bop{userdict /bop-hook known{
bop-hook}if /SI save N @rigin 0 0 moveto /V matrix currentmatrix dup 1 get dup
mul exch 0 get dup mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI
restore showpage userdict /eop-hook known{eop-hook}if}N /@start{userdict
/start-hook known{start-hook}if pop /VResolution X /Resolution X 1000 div
/DVImag X /IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0 0]N
/BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V{}B /RV
statusdict begin /product where{pop product dup length 7 ge{0 7 getinterval
dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}ifelse}{false}
ifelse end{{gsave TR -.1 -.1 TR 1 1 scale rulex ruley false RMat{BDot}
imagemask grestore}}{{gsave TR -.1 -.1 TR rulex ruley scale 1 1 false RMat{
BDot}imagemask grestore}}ifelse B /QV{gsave transform round exch round exch
itransform moveto rulex 0 rlineto 0 ruley neg rlineto rulex neg 0 rlineto fill
grestore}B /a{moveto}B /delta 0 N /tail{dup /delta X 0 rmoveto}B /M{S p delta
add tail}B /b{S p tail}B /c{-4 M}B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{
1 M}B /i{2 M}B /j{3 M}B /k{4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p
-2 w}B /o{p -1 w}B /q{p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}
B /y{3 2 roll p a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
%%BeginProcSet: texps.pro
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2 index
/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll exec 0 exch 5
-1 roll VResolution Resolution div mul neg 0 0]/Metrics exch def dict begin
Encoding{exch dup type /integertype ne{pop pop 1 sub dup 0 le{pop}{[}ifelse}{
FontMatrix 0 get div Metrics 0 get div def}ifelse}forall Metrics /Metrics
currentdict end def[2 index currentdict end definefont 3 -1 roll makefont
/setfont load]cvx def}def /ObliqueSlant{dup sin S cos div neg}B /SlantFont{4
index mul add}def /ExtendFont{3 -1 roll mul exch}def /ReEncodeFont{/Encoding
exch def}def end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300
(/tmp_mnt/home/tile/zorn/papers/pred/pldi.dvi) @start /Fa 60[20
195[{}1 33.333332 /Courier rf /Fb 170[19 16 15 3[19 2[16 8[18
1[19 65[{}7 26.666641 /Times-Roman rf /Fc 47[30 86[15 15 22
15 17 9 13 13 1[17 17 17 24 9 2[9 17 17 9 15 17 15 1[17 10[20
1[18 17 20 1[20 24 22 28 18 2[11 1[24 20 20 24 22 1[20 7[17
17 3[17 1[17 17 1[9 1[11 1[22 1[11 11 11 39[{}49 33.333332
/Times-Italic rf /Fd 78[17 2[18 51[15 17 17 24 17 17 9 13 11
17 17 17 17 26 9 17 9 9 17 17 11 15 17 15 17 15 3[11 1[11 20
2[31 1[24 20 18 22 1[18 24 24 30 20 24 13 11 24 24 18 20 24
22 22 24 6[9 17 17 17 17 17 17 17 17 17 17 1[8 11 8 19 1[11
11 40[{}69 33.333332 /Times-Roman rf /Fe 139[22 1[22 14[22
50[22 48[{}4 37.500000 /Courier rf /Ff 201[12 2[12 12 12 49[{}4
25.000000 /Times-Roman rf /Fg 2 50 df<C00060E000E07001C03803801C07000E0E00071C
0003B80001F00001F00003B800071C000E0E001C07003803807001C0E000E0C0006013127B911E
>2 D<07E001F0001FF807FC003FFC1F0E00703E3C0700601F780300E00FF00180C007E00180C0
03E00180C003E00180C003F00180C007F80380600F7C0300701E3E0700387C1FFE001FF00FFC00
07C003F00021107E8F26>49 D E /Fh 168[28 1[22 18 17 20 1[17 22
2[18 22 2[22 1[17 18 22 20 20 22 65[{}16 29.999987 /Times-Roman
rf /Fi 81[16 51[13 15 15 21 1[15 8 11 10 15 15 15 15 23 8 1[8
8 15 15 10 13 15 13 15 13 9[27 2[18 16 19 1[16 21 21 26 18
1[11 10 1[21 2[21 19 1[21 7[15 2[15 2[15 1[15 15 1[7 10 7 4[10
39[{}49 29.166668 /Times-Roman rf /Fj 205[10 10 10 48[{}3 20.833334
/Times-Roman rf /Fk 81[19 51[15 17 17 25 1[19 10 15 15 1[19
19 19 27 10 1[10 10 19 19 10 17 19 17 19 19 12[21 5[25 32[12
45[{}27 37.500000 /Times-Italic rf /Fl 1 63 df<E000007800001E000007800001E000
007800001E000007800001E000007800001E00001E0000780001E0000780001E0000780001E000
0780001E0000780000E0000017167D931E>62 D E /Fm 69[17 8[19 1[21
21 3[17 47[17 19 19 27 19 19 10 15 12 19 19 19 19 29 10 19
10 10 19 19 12 17 19 17 19 17 3[12 1[12 23 27 27 35 1[27 23
21 25 27 21 27 27 33 23 27 15 12 27 27 21 23 27 25 25 27 1[17
3[10 10 19 19 19 19 19 19 19 19 19 19 10 9 12 9 21 1[12 12
12 1[31 37[{}80 37.500000 /Times-Roman rf /Fn 43 120 df<01FC7F8007FDFF800FFFFF
800FFFFF801F87E0801F87E0001F87E0001F87E0001F87E0007FF7FC00FFF7FC00FFF7FC00FFF7
FC001F87E0001F87E0001F87E0001F87E0001F87E0001F87E0001F87E0001F87E0001F87E0001F
87E0001F87E0001F87E0000F87E000191A809918>11 D<FCFCFCFCFCFC06067E850B>46
D<00E003E01FE0FFE0FFE0FFE077E007E007E007E007E007E007E007E007E007E007E007E007E0
07E007E007E07FFCFFFCFFFC7FFC0E1A7D9915>49 D<0FC01FF03FF87FFCFFFE787E603F203F00
3F003F003F007E007C00FC01F803F007C007800F001E003C007FFFFFFFFFFFFFFF7FFF101A7E99
15>I<0FE07FF8FFFC7FFC7FFE307E007E007E007E00FC07FC07F807F807FE007E003F003F003F
003F403F707F7FFEFFFEFFFC7FF80FE0101A7E9915>I<00FE0000FE0001FE0001FE0003FE0003
BE0007BE0007BE000F3E000F3E001F3E001E3E003E3E003E3E007C3E007C3E00F83E00FFFFC0FF
FFC0FFFFC0FFFFC0003E00003E00003E00003E00003E00121A7F9915>I<1FFF003FFF003FFF00
3FFF003FFF003F00003F00003F00003F00003F00003FF8003FFC003FFE003FFF003F1F801E1F80
001F80001F80201F80701F80783F80FFFF007FFF003FFE001FFC0007F000111A7F9915>I<01E0
07F01FF01FF03FF07F107E007C00FC00FDF8FFFCFFFEFFFEFE3FFC3FFC3FFC3FFC3FFC3F7C3F7E
3F7FFE3FFE1FFC0FF807E0101A7E9915>I<FFFFFFFFFFFFFFFFFFFF003E007C00FC00F801F803
F003F007E007E007E00FC00FC00FC00FC01F801F801F801F801F801F801F80101A7E9915>I<01
FE0001FE0003FF0003FF0003FF0007FF8007DF8007CF800FCFC00FCFC00FCFC00F8FC01F87E01F
87E01F87E03F03F03F03F03F03F07FFFF87FFFF87FFFF87FFFF8FC00FCFC00FCFC00FCF8007C16
1A7E991B>65 D<007FC003FFF00FFFF01FFFF03FFFE03FC0E07F00207E00007E0000FC0000FC00
00FC0000FC0000FC0000FC0000FC0000FC00007E00007E00007F00083FC0783FFFF81FFFF80FFF
F803FFF0007F80151A7E991A>67 D<7FFF80FFFF80FFFF80FFFF80FFFF80FC0000FC0000FC0000
FC0000FC0000FC0000FFFF00FFFF00FFFF00FFFF00FC0000FC0000FC0000FC0000FC0000FC0000
FFFF80FFFF80FFFF80FFFF807FFF80111A7C9918>69 D<7C01F8FC01F8FC01F8FC01F8FC01F8FC
01F8FC01F8FC01F8FC01F8FC01F8FFFFF8FFFFF8FFFFF8FFFFF8FC01F8FC01F8FC01F8FC01F8FC
01F8FC01F8FC01F8FC01F8FC01F8FC01F8FC01F87C01F8151A7C991E>72
D<7CFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFC7C061A7D990C>I<7C00FC00FC
00FC00FC00FC00FC00FC00FC00FC00FC00FC00FC00FC00FC00FC00FC00FC00FC00FC00FC00FFFE
FFFEFFFEFFFE7FFE0F1A7C9916>76 D<7F000FF0FF801FF0FF801FF0FFC03FF0FFC03FF0FFC03F
F0FBE07BF0FBE07BF0FBE07BF0FBE07BF0F9F0F3F0F9F0F3F0F9F0F3F0F9F9F3F0F9F9F3F0F8F9
E3F0F8F9E3F0F8F9E3F0F879C3F0F879C3F0F87FC3F0F83F83F0F83F83F0F83F83F0F81F03F078
1F03F01C1A7C9925>I<7FFC00FFFF00FFFF80FFFFC0FC0FC0FC07E0FC07E0FC07E0FC07E0FC07
E0FC07E0FC07E0FC0FC0FFFFC0FFFF80FFFF00FFFC00FC0000FC0000FC0000FC0000FC0000FC00
00FC0000FC00007C0000131A7C991A>80 D<00FF800003FFE0000FFFF8001FFFFC003FC1FE003F
007E007E003F007E003F00FC001F80FC001F80FC001F80FC001F80FC001F80FC001F80FC001F80
FC001F80FC001F80FC001F807E003F007E3F3F007F3FFF003FDFFE001FFFFC000FFFF80007FFF0
0000FFF8000003F8000001FC000000FE0000007E00191E7E991E>I<7FFC00FFFF00FFFF80FFFF
C0FC0FC0FC07E0FC07E0FC07E0FC07E0FC07E0FC0FC0FFFFC0FFFF80FFFF00FFFC00FC7C00FC7E
00FC3F00FC3F00FC1F80FC1F80FC0FC0FC0FC0FC07E0FC07E07C03E0131A7C991A>I<07F8001F
FE003FFF007FFF007FFF00FC0E00F80600F80200FC0000FF80007FF8007FFC003FFF000FFF0007
FF80007FC0000FC04007C06007C07007C0FC0FC0FFFF80FFFF807FFF001FFE0007F800121A7E99
17>I<7FFFFFFFFFFFFFFFFFFFFFFFFFFFFF007E00007E00007E00007E00007E00007E00007E00
007E00007E00007E00007E00007E00007E00007E00007E00007E00007E00007E00007E00007E00
003E00181A7F991B>I<F801FC00F0FC03FE01F0FC03FE01F0FE03FE01F07E07FE03E07E07FF03
E07E07BF03E07F079F03E03F0F9F07C03F0F9F87C03F0F9F87C03F0F1F87C01F8F0F8F801F9F0F
CF801F9F0FCF801F9E0FCF800F9E07CF000F9E07CF000FDE07CF000FDC07DF0007FC03FE0007FC
03FE0007FC03FE0003F803FC0003F801FC0003F801FC00241A7F9927>87
D<0FF03FFC3FFE3FFF383F203F07FF3FFF7FFFFC3FFC3FFC7FFC7F7FFF7FFF3FBF1E3F10117F90
14>97 D<7C0000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FCFC00FFFE00FFFF
00FFFF00FC3F80FC1F80FC1F80FC1F80FC1F80FC1F80FC1F80FC1F80FC3F00FFFF00FFFE00FFFC
007DF800111A7E9915>I<07F81FFE3FFE7FFE7E0CFC00FC00FC00FC00FC00FC00FC027E0E7FFE
3FFE1FFE07F80F117F9012>I<001F80001F80001F80001F80001F80001F80001F80001F80001F
801F9F803FFF807FFF807FFF80FE1F80FC1F80FC1F80FC1F80FC1F80FC1F80FC1F80FC1F80FE1F
807FFF807FFF803FFF800F9F80111A7F9915>I<07F01FFC3FFE7FFE7E3FFC1FFFFFFFFFFFFFFC
00FC00FC007E037FFF3FFF1FFF07FC10117F9013>I<01FC07FC0FFC0FFC1F841F801F801F801F
807FE0FFE0FFE0FFE01F801F801F801F801F801F801F801F801F801F801F801F800F800E1A8099
0D>I<07F9C01FFFE03FFFE03E1F207E1F807E1F807E1F807E1F803E1F003FFF001FFE003FF800
3800003FFF003FFFC03FFFE07FFFE07FFFF0F803F0F801F0F801F07C03E07FFFE03FFFC007FE00
1419809015>I<7C00FC00FC00FC00FC00FC00FC00FC00FC00FCFCFDFEFFFFFFFFFE3FFC3FFC3F
FC3FFC3FFC3FFC3FFC3FFC3FFC3FFC3FFC3F7C3F101A7E9915>I<F8FCFCFCF800000000007CFC
FCFCFCFCFCFCFCFCFCFCFCFCFCFC7C061B7F9A09>I<7800F800F800F800F800F800F800F800F8
00F87EF8FCF9FCFBF8FFF0FFE0FFC0FFC0FFC0FFE0FFF0FBF8F9F8F8FCF87EF87E783E0F1A7E99
14>107 D<7CFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFCFC7C061A7F9909>I<7C7E
0FC0FDFF3FE0FFFFFFF0FFFFFFF0FE1FC3F0FC1F83F0FC1F83F0FC1F83F0FC1F83F0FC1F83F0FC
1F83F0FC1F83F0FC1F83F0FC1F83F0FC1F83F0FC1F83F07C0F81F01C117E9023>I<7CFCFDFEFF
FFFFFFFE3FFC3FFC3FFC3FFC3FFC3FFC3FFC3FFC3FFC3FFC3FFC3F7C3F10117E9015>I<07F800
1FFE003FFF007FFF807E1F80FC0FC0FC0FC0FC0FC0FC0FC0FC0FC0FC0FC0FC0FC07E1F807FFF80
3FFF001FFE0007F80012117F9015>I<7CFC00FFFE00FFFF00FFFF00FC3F80FC1F80FC1F80FC1F
80FC1F80FC1F80FC1F80FC3F80FC3F00FFFF00FFFE00FFFC00FDF800FC0000FC0000FC0000FC00
00FC0000FC00007C000011187E9015>I<7CC0FFC0FFC0FFC0FFC0FE00FC00FC00FC00FC00FC00
FC00FC00FC00FC00FC007C000A117E900E>114 D<1FC03FF07FF0FFF0F860F800FF807FE07FF0
3FF84FF840F8F0F8FFF8FFF07FE01FC00D117F9010>I<1F003F003F003F003F007FE0FFE0FFE0
FFE03F003F003F003F003F003F003F003F003F203FE01FF01FF00FC00C167F950F>I<7C3FFC3F
FC3FFC3FFC3FFC3FFC3FFC3FFC3FFC3FFC3FFC3FFC7FFFFFFFFF7FBF3E3F10117E9015>I<F00F
F81FF81F7C3E7C3E7C3E7E3E3E7C3E7C3E7C1FF81FF81FF80FF00FF00FF007E010117F9013>I<
F03E0780F87F0F80F87F0F80F87F0F807C7F1F007CFF9F007CF79F007CF79F003CE7BE003EE7BE
003EE7FE003FE7FE001FE7FC001FE3FC001FC3FC001FC3FC000F81F80019117F901C>I
E /Fo 78[23 55[23 23 1[23 23 13 18 15 1[23 23 23 36 13 1[13
13 2[15 20 23 20 1[20 6[28 4[33 1[25 11[33 2[33 30 30 33 7[23
23 3[23 23 2[23 1[11 1[11 8[23 35[{}36 45.833332 /Times-Roman
rf /Fp 134[29 2[29 1[16 23 19 1[29 29 29 45 16 2[16 1[29 19
26 29 26 1[26 11[42 4[32 2[52 36 2[19 7[42 65[{}23 58.333336
/Times-Roman rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 141 38 a Fp(Using)14 b(Lifetime)h(Predictors)g(to)g(Impro)o(v)o(e)g
(Memory)g(Allocation)g(Performance)607 150 y Fo(Da)o(vid)c(A.)h(Barrett)g
(and)f(Benjamin)g(G.)h(Zorn)664 207 y(Department)f(of)g(Computer)g(Science)
800 263 y(Campus)g(Box)h(#430)555 320 y(Uni)o(v)o(ersity)e(of)h(Colorado,)h
(Boulder)g(80309\2610430)-76 638 y Fn(Abstract)-76 718 y Fm(Dynamic)c
(storage)g(allocation)h(is)g(used)f(hea)o(vily)g(in)i(man)o(y)e(application)h
(ar)o(-)-76 760 y(eas)i(including)h(interpreters,)i(simulators,)f
(optimizers,)g(and)e(translators.)-76 801 y(W)m(e)j(describe)f(research)g
(that)h(can)f(impro)o(v)o(e)i(all)f(aspects)e(of)j(the)e(perfor)o(-)-76
843 y(mance)8 b(of)i(dynamic)f(storage)f(allocation)h(by)g(predicting)g(the)h
(lifetimes)g(of)-76 884 y(short-li)o(v)o(ed)h(objects)d(when)h(the)o(y)h(are)
g(allocated.)15 b(Using)9 b(\256v)o(e)g(signi\256cant,)-76
926 y(allocation-intensi)o(v)o(e)e(C)g(programs,)g(we)g(sho)o(w)g(that)g(a)g
(great)g(fraction)h(of)f(all)-76 967 y(bytes)j(allocated)f(are)h(short-li)o
(v)o(ed)h(\()p Fl(>)g Fm(90\045)g(in)f(all)h(cases\).)16 b(Furthermore,)-76
1009 y(we)7 b(describe)f(an)h(algorithm)g(for)h(lifetime)h(prediction)e(that)
g(accurately)f(pre-)-76 1050 y(dicts)j(the)h(lifetimes)g(of)g(42\26199\045)e
(of)i(all)g(objects)f(allocated.)k(W)m(e)d(describe)-76 1092
y(and)k(simulate)g(a)g(storage)f(allocator)h(that)h(takes)e(adv)o(antage)f
(of)i(lifetime)-76 1133 y(prediction)d(of)g(short-li)o(v)o(ed)h(objects)e
(and)h(sho)o(w)f(that)h(it)h(can)f(signi\256cantly)-76 1175
y(impro)o(v)o(e)f(a)g(program')n(s)f(memory)g(o)o(v)o(erhead)g(and)g
(reference)g(locality)n(,)g(and)-76 1216 y(e)o(v)o(en,)g(at)g(times,)h(impro)
o(v)o(e)g(CPU)f(performance)f(as)g(well.)-76 1317 y Fn(1)41
b(Intro)q(duction)-76 1409 y Fm(.)-20 1463 y(Dynamic)9 b(storage)f
(allocation)h(\(DSA\))h(is)g(used)e(hea)o(vily)h(in)h(man)o(y)f(ap-)-76
1505 y(plication)k(areas)f(including)g(interpreters,)j(simulators,)f
(optimizers,)g(and)-76 1546 y(translators.)i(Furthermore,)11
b(object-oriented)e(programming)h(languages,)-76 1588 y(such)h(as)h(C++,)j
(encourage)10 b(a)i(programming)h(style)f(that)h(uses)e(more)i(dy-)-76
1629 y(namic)h(memory)g(allocation)g(than)g(their)h(predecessors.)27
b(But)15 b(dynamic)-76 1671 y(storage)c(allocation)g(has)f(been)h(criticized)
g(because)e(it)k(is)f(not)f(as)g(ef)o(\256cient)-76 1712 y(as)g(static)g
(allocation)g([17,)h(p.)20 b(465].)g(Indeed,)11 b(programmers)g(frequently)
-76 1754 y(write)k(their)f(o)o(wn)f(domain-speci\256c)f(allocation)h
(routines)g(to)h(attempt)g(to)-76 1795 y(increase)9 b(the)i(performance)e(of)
i(their)h(programs)e([22].)18 b(In)11 b(this)g(paper)f(we)-76
1837 y(describe)h(and)g(in)o(v)o(estigate)f(a)i(method)f(for)i(impro)o(ving)f
(the)g(performance)-76 1879 y(of)f(dynamic)f(storage)f(allocation)i(that)g
(automates)e(the)h(process)f(that)i(pro-)-76 1920 y(grammers)i(currently)g
(use)f(to)h(increase)e(allocation)i(performance:)20 b(tune)-76
1962 y(the)9 b(allocation)g(strate)o(gy)g(to)g(the)g(beha)o(vior)g(of)g(the)g
(program.)-20 2016 y(Programmers)f(often)g(use)f(runtime)h(pro\256les)f(to)h
(analyze)f(the)g(beha)o(vior)-76 2057 y(of)g(a)f(typical)h(e)o(x)o(ecution)f
(of)g(their)i(program.)k(This)6 b(analysis)f(re)o(v)o(eals)h(perfor)o(-)-76
2099 y(mance)i(bottlenecks)f(that)i(include)f(calls)g(to)i(a)e(dynamic)g
(storage)g(allocator)-76 2140 y(\(e.g.,)13 b(the)e Fk(malloc)h
Fm(function)f(in)g(C,)h(or)g(the)f Fk(ne)o(w)g Fm(operator)h(in)f(C++\).)21
b(The)-76 2182 y(programmer)7 b(then)g(analyzes)t(which)g(calls)f(to)i(the)f
(memory)f(allocator)h(may)-76 2223 y(be)k(customized)f(by)h(a)g(special)g
(purpose)f(routine)h(and)g(writes)h(one)f(that)h(is)-76 2265
y(speci\256cally)c(tuned)g(for)i(these)e(allocation)h(e)o(v)o(ents.)p
-76 2345 399 2 v -36 2370 a Fj(0)-24 2382 y Fi(This)c(paper)g(will)g(appear)g
(in)t(the)t(SIGPLAN'9)o(3)g(Co)o(nfer)o(ence)t(on)t(Prog)o(ram)o(ming)t(Lan)o
(gu)o(age)-76 2415 y(Design)i(and)f(Implementation,)f(June)h(1993,)g(Alb)o
(uquerque,)t(Ne)o(w)i(Mexico)1076 638 y Fm(In)j(short,)g(our)f(research)f(is)
i(an)f(e)o(x)o(ercise)f(in)i(automating)f(this)g(process)1020
680 y(using)k(the)g(general)g(technique)f(of)i Fk(pr)n(o\256le-based)d
(optimization)p Fm(.)30 b(W)o(ith)1020 721 y(pro\256le-based)5
b(optimization,)i(programs)e(are)i(e)o(x)o(ecuted)e(with)i(training)f(sets)
1020 763 y(of)h(test)f(data)g(and)f(beha)o(vioral)g(aspects)g(of)h(the)g
(programs)g(are)g(recorded.)11 b(Af-)1020 804 y(ter)e(these)f(training)h
(sessions,)e(a)h(DSA)h(implementation)f(is)h(generated)e(that)1020
846 y(optimizes)i(the)g(DSA)g(algorithm)g(for)h(the)f(observ)o(ed)f(program)h
(beha)o(vior)n(.)1076 900 y(In)k(this)g(paper)e(we)i(describe)e(a)h(system)g
(of)g(pro\256le-based)f(optimiza-)1020 941 y(tion)h(that)h(accurately)d
(predicts)i(the)g(objects)f(that)h(will)h(be)f(short-li)o(v)o(ed)g(at)1020
983 y(the)h(time)g(the)o(y)g(are)g(allocated)f(and)g(se)o(gre)o(gates)f
(these)h(objects)g(from)i(the)1020 1024 y(longer)o(-li)o(v)o(ed)g(ones.)24
b(In)14 b(related)f(work,)h(Hanson)d(describes)h(the)h(adv)o(an-)1020
1066 y(tages)e(of)h(se)o(gre)o(gating)f(short-li)o(v)o(ed)h(objects,)g(in)g
(his)g(case)e(by)i(ha)o(ving)f(the)1020 1107 y(programmer)e(e)o(xplicitly)h
(specify)e(what)h(is)g(short-li)o(v)o(ed)h([10].)1076 1161
y(Our)e(work)e(automates)g(Hanson')n(s)f(algorithm)j(by)f(using)f(the)h
(allocation)1020 1203 y(site)i(\(an)f(abstraction)g(of)h(the)g(call-stack\))f
(and)g(object)g(size)g(to)h(identify)g(and)1020 1244 y(se)o(gre)o(gate)14
b(short-li)o(v)o(ed)i(objects.)32 b(Using)14 b(\256v)o(e)h(signi\256cant,)i
(allocation-)1020 1286 y(intensi)o(v)o(e)c(C)h(programs,)h(we)f(sho)o(w)e
(that)j(a)e(great)h(fraction)g(of)g(all)g(bytes)1020 1327 y(allocated)e(are)g
(short-li)o(v)o(ed.)25 b(Furthermore,)13 b(we)g(describe)e(an)h(algorithm)
1020 1369 y(for)f(lifetime)h(prediction)e(that)g(accurately)f(predicts)h(the)
g(lifetimes)h(of)f(42\261)1020 1410 y(99\045)f(of)g(all)h(objects)e
(allocated.)1076 1464 y(W)m(e)16 b(also)g(describe)e(an)i(algorithm)g(that)h
(uses)d(this)j(information)f(to)1020 1506 y(increase)d(the)i(performance)e
(of)i(dynamic)f(storage)g(allocation.)30 b(In)15 b(our)1020
1547 y(algorithm,)g(objects)d(that)h(are)g(predicted)f(to)h(be)f(short-li)o
(v)o(ed)i(are)e(rapidly)1020 1589 y(allocated)7 b(in)h(small)g(spaces)e(by)h
(incrementing)h(a)f(pointer)h(and)f(deallocated)1020 1630 y(together)13
b(when)g(the)o(y)h(are)f(all)h(dead.)26 b(W)o(ith)14 b(this)g(algorithm,)h
(CPU)f(per)o(-)1020 1672 y(formance)g(may)h(be)f(impro)o(v)o(ed)h(because)e
(allocation)h(is)h(cheap)f(and)g(the)1020 1713 y(deallocations)e(are)i(done)f
(in)h(batches.)26 b(Memory)13 b(fragmentation)h(is)g(re-)1020
1755 y(duced)8 b(because)e(the)k(man)o(y)e(small)i(short-li)o(v)o(ed)g
(objects)e(are)h(not)g(polluting)1020 1796 y(the)g(address)e(space)g
(occupied)g(by)h(long-li)o(v)o(ed)h(objects.)k(Finally)n(,)c(program)1020
1838 y(reference)14 b(locality)h(is)g(increased)e(because)f(the)j(short-li)o
(v)o(ed)g(objects)f(\(a)1020 1879 y(lar)o(ge)9 b(fraction)h(of)f(the)g(total)
h(objects)e(allocated\))h(are)g(allocated)f(in)h(a)g(small)1020
1921 y(part)14 b(of)h(the)e(heap,)i(less)e(than)g(100)h(kilobytes)f(in)h(all)
h(the)e(programs)h(we)1020 1962 y(measured.)1020 2071 y Fn(1.1)41
b(Related)14 b(W)o(o)o(rk)1020 2150 y Fm(Our)7 b(research)e(combines)t(two)h
(acti)o(v)o(e)g(\256elds)g(of)g(research)f(in)i(programming)1020
2192 y(languages:)k(dynamic)d(storage)h(allocation)f(and)h(pro\256le-based)e
(optimiza-)1020 2233 y(tion.)19 b(Other)11 b(researchers)e(ha)o(v)o(e)h
(designed)e(memory)j(allocation)f(systems)1020 2275 y(based)j(upon)h(v)o
(arious)h(characteristics)f(of)h(object)f(allocation)h(beha)o(vior)n(.)1020
2316 y(F)o(or)g(e)o(xample,)g(generational)e(garbage)g(collectors)g(e)o
(xploit)i(the)f(general)1020 2358 y(observ)o(ation)e(that)i(objects)e(tend)h
(to)h(be)f(short-li)o(v)o(ed)h([15)o(,)g(18,)g(16)o(].)27 b(Our)1020
2399 y(approach)11 b(can)g(impro)o(v)o(e)i(the)g(performance)e(of)i
(generational)e(collectors)1020 2441 y(by)e(predicting)g(object)f(lifetimes)i
(when)f(the)o(y)g(are)g(born.)1076 2495 y(Object)i(size)g(information)h(has)e
(also)g(been)g(used)g(to)i(impro)o(v)o(e)g(alloca-)1020 2536
y(tor)f(performance.)17 b(The)10 b(conserv)o(ati)o(v)o(e)g(garbage)e
(collector)j(described)e(by)1020 2578 y(Boehm)i(and)f(W)m(eiser)i([2])g(uses)
e(size)g(to)i(se)o(gre)o(gate)e(objects)h(b)o(ut)g(does)g(not)1020
2619 y(attempt)j(to)f(predict)g(object)g(lifetimes.)27 b(The)o(y)13
b(mention,)h(ho)o(we)o(v)o(er)o(,)f(that)p eop
%%Page: 2 2
2 1 bop -76 -34 a Fm(memory)13 b(o)o(v)o(erhead)e(would)h(be)g(impro)o(v)o
(ed)i(if)f(li)o(ving)g(objects)f(were)h(se)o(g-)-76 7 y(re)o(gated)d(from)i
(dead)d(objects.)18 b(In)11 b(later)g(related)g(work,)g(Demers)f
Fk(et)h(al)g Fm([4])-76 49 y(use)c(an)g(object')n(s)g(allocation)g(site)g
(\(based)g(on)g(the)g(current)h(stack)e(pointer\))i(to)-76
90 y(predict)f(object)g(lifetimes.)14 b(Our)7 b(work)g(e)o(xpands)e(upon)h
(theirs)h(and)f(presents)-76 132 y(detailed)g(measurements)t(of)g(the)g(ef)o
(fecti)o(v)o(eness)f(of)h(the)g(lifetime)i(prediction)-76 173
y(approach.)-20 227 y(In)13 b(work)f(that)g(is)h(closely)e(related)h(to)h
(ours,)g(Hanson)e([10)o(])i(describes)-76 269 y(ho)o(w)f(se)o(gre)o(gating)f
(objects)g(by)h(lifetime)i(impro)o(v)o(es)e(the)g(performance)f(of)-76
310 y(DSA)c(algorithms.)12 b(His)7 b(results)f(sho)o(w)g(that)h(se)o(gre)o
(gation)e(can)h(dramatically)-76 352 y(reduce)g(the)i(cost)f(of)g(allocation)
g(and)g(deallocation)f(of)i(short-li)o(v)o(ed)g(objects.)-76
393 y(His)i(work)g(dif)o(fers)g(from)h(ours)f(because)d(he)i(requires)h(the)g
(programmer)f(to)-76 435 y(indicate)k(ho)o(w)g(long)g(objects)f(will)j(li)o
(v)o(e,)g(while)f(we)f(predict)g(object)g(life-)-76 476 y(times)d
(automatically)n(.)15 b(W)m(e)10 b(enhance)d(Hanson')n(s)h(algorithm)i(by)g
(using)f(the)-76 518 y(beha)o(vior)f(of)h(pre)o(vious)f(program)h(e)o(x)o
(ecutions)e(to)i(automatically)g(generate)-76 559 y(an)g(allocator)g
(customized)e(for)j(short-li)o(v)o(ed)g(objects.)-20 613 y(Our)15
b(work)f(uses)f(the)h(state)g(of)h(the)f(dynamic)f(call-stack)h(to)h(predict)
-76 655 y(object)e(lifetimes.)28 b(Other)14 b(researchers)e(ha)o(v)o(e)h
(used)f(the)i(call-stack)f(as)g(a)-76 696 y(predictor)g(as)g(well.)26
b(In)13 b(particular)o(,)i(Hayes)c([11])j(and)e(W)o(ilson)h([21])h(use)-76
738 y(stack)d(deallocation)f(e)o(v)o(ents)h(to)g(detect)g(clustering)g(of)h
(object)f(deaths)f(and)-76 779 y(trigger)15 b(garbage)d(collections.)26
b(Their)14 b(work)f(uses)g(the)g(heuristic)h(that)g(a)-76 821
y(small)f(call-stack)f(predicts)g(there)g(will)i(be)e(more)g(garbage)f(a)o(v)
o(ailable)h(for)-76 862 y(collection)j(and)g(hence)f(collection)h(algorithms)
g(should)f(be)h(in)o(v)o(oked)f(if)-76 904 y(possible)e(when)g(the)h(stack)f
(is)h(lo)o(w)n(.)26 b(Like)12 b(Hayes)g(and)g(W)o(ilson,)i(we)f(use)-76
945 y(program)g(measurements)e(to)i(deri)o(v)o(e)g(useful)g(heuristics.)24
b(Ho)o(we)o(v)o(er)o(,)14 b(we)-76 987 y(use)8 b(the)h(contents)f(of)i(the)f
(stack)f(and)g(not)h(just)g(the)g(size.)-20 1041 y(There)j(has)g(also)h(been)
f(a)g(recent)h(\257urry)g(of)g(research)f(in)h(the)g(area)f(of)-76
1082 y(pro\256le-based)t(optimization.)h(W)m(all)7 b(has)e(in)o(v)o
(estigated)g(the)h(problem)f(of)i(de-)-76 1124 y(termining)j(ho)o(w)e(well)h
(e)o(x)o(ecution)g(pro\256les)f(predict)h(actual)f(beha)o(vior)g([20].)-76
1165 y(He)h(concludes)d(that)j(pro\256le-based)f(optimization)h(is)g(more)g
(accurate)e(than)-76 1207 y(static)k(attempts)g(to)g(determine)f(where)h
(programs)f(spend)f(time)j(and)e(what)-76 1248 y(global)k(v)o(ariables)f(are)
h(used)f(most)h(often.)29 b(Most)14 b(recently)n(,)h(Fisher)e(and)-76
1290 y(Freudenber)o(ger)e(report)h(considerable)f(success)e(in)k(using)e(pre)
o(vious)g(runs)-76 1331 y(of)e(a)f(program)g(to)g(perform)h
(branch-prediction)e(optimizations)h(in)g(lar)o(ge)h(C)-76
1373 y(and)f(F)o(ortran)i(programs)f([7].)-20 1427 y(Grunwald)i(and)h(Zorn)f
([9])i(describe)e(a)g(tool)i(called)e(C)p Fh(UST)o(O)p Fm(M)p
Fh(ALLOC)-76 1468 y Fm(that)k(performs)f(pro\256le-based)e(optimization)j(of)
f(DSA)g(algorithms.)29 b(In)-76 1510 y(their)15 b(work,)h(information)g
(collected)d(from)j(pre)o(vious)e(program)g(e)o(x)o(ecu-)-76
1551 y(tions)e(is)f(used)g(to)g(automatically)g(generate)g(high-speed)e(e)o
(xplicit)k(alloca-)-76 1593 y(tors.)22 b(Ho)o(we)o(v)o(er)o(,)13
b(no)e(optimization)h(based)f(upon)f(predicted)i(lifetimes)h(is)-76
1634 y(performed)c(in)h(their)f(work.)-20 1688 y(This)d(paper)f(has)h(the)g
(follo)o(wing)g(or)o(ganization.)12 b(First,)c(we)e(describe)f(the)-76
1730 y(goals)10 b(of)h(our)f(approach,)g(de\256ne)f(the)h(important)h(terms,)
g(and)f(discuss)f(the)-76 1771 y(methods)e(used)g(to)i(perform)f(our)h
(measurements.)i(Ne)o(xt)d(we)g(present)g(mea-)-76 1813 y(surements)i(that)i
(sho)o(w)f(lifetime)h(prediction)g(can)e(be)h(used)f(to)i(accurately)-76
1854 y(predict)e(the)g(lifetimes)h(of)g(short-li)o(v)o(ed)g(objects.)k
(Finally)n(,)c(we)f(present)f(the)-76 1896 y(results)d(of)h(simulating)f(DSA)
g(algorithms)g(both)g(with)h(and)f(without)g(lifetime)-76 1937
y(prediction.)-76 2049 y Fn(2)41 b(Predicto)o(rs)-76 2141 y
Fm(Our)15 b(goal)f(is)g(to)h(implement)f(high-performance)f(dynamic)h
(storage)f(al-)-76 2183 y(location)e(algorithms)f(by)h(successfully)d
(predicting)j(an)f(object')n(s)g(lifetime)-76 2224 y(when)g(it)i(is)g
(allocated.)18 b(The)10 b(success)f(of)i(our)g(approach)e(depends)g(on)i(the)
-76 2266 y(follo)o(wing)f(hypotheses:)-29 2348 y(1.)19 b(One)9
b(e)o(x)o(ecution)h(of)g(a)g(program)g(will)h(pro)o(vide)f(useful)g
(information)18 2390 y(about)e(other)h(runs)g(of)g(that)h(program.)-29
2457 y(2.)19 b(Information)12 b(a)o(v)o(ailable)e(at)i(the)f(time)h(of)f
(object)g(birth)h(can)f(predict)18 2499 y(that)e(object')n(s)g(lifetime.)-20
2581 y(While)j(the)f(\256rst)h(hypothesis)d(is)j(generally)e(accepted)f(in)j
(the)f(domain)-76 2622 y(of)k(of)f(e)o(x)o(ecution)g(pro\256les,)h(it)g(has)e
(yet)h(to)h(be)f(thoroughly)f(in)o(v)o(estigated)1020 -34 y(with)c(respect)e
(to)h(other)g(aspects)e(of)j(program)e(beha)o(vior)n(.)13 b(In)8
b(this)g(paper)o(,)g(we)1020 7 y(present)j(e)o(vidence)f(that)i(supports)f
(the)h(\256rst)g(hypothesis)e(with)i(respect)f(to)1020 49 y(program)c
(allocation)f(beha)o(vior)g(and)g(we)g(illustrate)i(ho)o(w)e(such)g
(information)1020 90 y(can)i(be)h(used)f(to)h(optimize)g(allocator)g
(implementations.)1076 144 y(Speci\256cally)n(,)k(we)h(use)e(the)h
Fk(allocation)h(site)f Fm(and)g(the)g Fk(object)g(size)g Fm(to)1020
186 y(predict)i(object)g(lifetimes.)32 b(The)14 b(allocation)h(site)g
(speci\256es)e(where)i(the)1020 227 y(object)10 b(was)g(created)f(in)i(the)g
(control)f(sequence)e(of)j(the)g(program)f(and)g(the)1020 269
y(size)f(speci\256es)f(ho)o(w)h(much)g(memory)h(is)g(required)f(by)h(that)g
(object.)15 b(When)1020 310 y(a)o(v)o(ailable,)10 b(the)g(object')n(s)g(type)
g(or)g(class)g(can)f(also)h(be)f(used)g([5,)i(6],)g(b)o(ut)g(we)1020
352 y(chose)g(to)h(only)g(use)f(the)h(allocation)g(site)h(and)e(size)h
(because)d(the)j(type)g(of)1020 393 y(an)e(object)h(is)g(not)f(directly)i(a)o
(v)o(ailable)e(at)h(C)g(birth)g(e)o(v)o(ents.)18 b(Extensions)9
b(of)1020 435 y(lifetime)k(prediction)f(algorithms)g(that)g(use)e(type)i
(information,)h(which)e(is)1020 476 y(a)o(v)o(ailable)f(in)g(languages)e
(such)h(as)h(C++,)h(Modula-2,)g(and)e(Modula-3,)i(are)1020
518 y(the)e(subject)f(of)i(future)f(research.)1020 631 y Fn(3)41
b(Metho)q(ds)1020 723 y(3.1)g(Sam)o(ple)12 b(Program)o(s)1020
802 y Fm(Since)g(our)h(system)e(makes)g(use)h(of)h(a)g(heuristic)f(and)g(a)g
(hypothesis)f(con-)1020 844 y(cerning)k(empirical)h(program)f(beha)o(vior)o
(,)h(our)g(e)o(v)o(aluation)e(is)i(based)e(on)1020 885 y(measurements)f(of)h
(actual)g(programs.)29 b(W)m(e)15 b(selected)e(a)h(representati)o(v)o(e)1020
927 y(sample)f(of)g(programs,)h(observ)o(ed)e(their)i(memory)g(allocation)e
(beha)o(vior)o(,)1020 968 y(and)f(designed)f(a)i(system)f(to)i(e)o(xploit)f
(that)h(beha)o(vior)n(.)21 b(T)m(o)12 b(sho)o(w)f(that)i(the)1020
1010 y(technique)f(is)h(widely)g(applicable,)g(we)g(selected)e(programs)i
(from)h(a)f(v)o(a-)1020 1051 y(riety)j(of)f(application)f(areas)g(that)i
(require)f(intensi)o(v)o(e)f(dynamic)g(storage)1020 1093 y(allocation.)1076
1147 y(Our)k(measurements)e(are)i(based)e(on)i(\256v)o(e)g(application)f
(programs:)1020 1188 y(C)p Fh(FRA)o(C)p Fm(,)10 b(which)h(factors)f(lar)o(ge)
h(inte)o(gers;)h(E)p Fh(SPRESSO)p Fm(,)d(a)i(PLA)f(logic)h(opti-)1020
1230 y(mizer;)e(G)p Fh(A)m(WK)p Fm(,)g(the)f(GNU)h(implementation)f(of)g(the)
h(A)m(WK)f(programming)1020 1271 y(language;)h(G)p Fh(HOST)h
Fm(or)g(GhostScript,)h(a)f(publically)g(a)o(v)o(ailable)g(PostScript)1020
1313 y(interpreter;)g(and)e(P)p Fh(ERL)p Fm(,)i(a)e(report)h(e)o(xtraction)g
(language)e(commonly)h(used)1020 1354 y(in)i(UNIX)g(systems.)j(W)m(e)c
(measured)f(the)h(allocation)g(beha)o(vior)f(of)i(each)e(of)1020
1396 y(these)j(programs)h(by)f(instrumenting)h(them)g(with)h(Larus')f(A)p
Fh(E)g Fm(trace)g(gen-)1020 1438 y(eration)g(tool)h([14].)24
b(T)m(able)12 b(1)g(describes)f(the)h(programs)g(and)f(their)j(input)1020
1479 y(sets)d(and)f(T)m(able)h(2)h(summarizes)e(the)h(e)o(x)o(ecution)g(beha)
o(vior)g(of)h(these)e(pro-)1020 1521 y(grams.)26 b(Multiple)15
b(input)e(datasets)f(were)i(measured;)g(the)g(performance)1020
1562 y(results)9 b(presented)e(apply)i(to)g(the)g(lar)o(gest)g(of)h(the)f
(input)g(sets)f(in)i(all)g(cases.)1020 1671 y Fn(3.2)41 b(Lifetimes)11
b(and)i(the)h(Allo)q(cation)h(Site)1020 1750 y Fm(W)m(e)10
b(seek)f(to)h(\256nd)f(a)h(correlation)g(between)e(the)i Fk(lifetime)h
Fm(of)g(an)e(object)g(and)1020 1791 y(the)14 b Fk(allocation)g(site)h
Fm(and/or)f Fk(size)f Fm(of)i(that)f(object.)29 b(T)m(o)14
b(understand)f(the)1020 1833 y(measurement)c(results,)h(the)g(follo)o(wing)h
(terms)f(must)g(be)g(de\256ned)e(in)j(more)1020 1874 y(detail.)1076
1928 y(W)m(e)j(de\256ne)f Fk(object)g(lifetime)j Fm(to)e(be)f(the)h(total)h
(number)e(of)i(bytes)e(al-)1020 1970 y(located)i(between)f(the)i(time)g(the)f
(object)h(is)f(allocated)g(and)g(when)g(it)h(is)1020 2011 y(deallocated.)22
b(While)13 b(bytes)e(allocated)g(may)h(seem)g(an)g(odd)f(measure)g(of)1020
2053 y(time,)g(it)h(is)e(completely)f(appropriate.)16 b(T)o(ime)10
b(can)f(be)h(measured)e(in)j(man)o(y)1020 2094 y(ways)h(b)o(ut)h(one)g(of)g
(the)g(most)g(natural)g(measures,)g(CPU)g(instructions,)h(is)1020
2136 y(not)d(particularly)g(suitable)f(for)h(our)f(purposes.)16
b(T)m(o)11 b(understand)d(why)i(this)1020 2177 y(is)j(true,)h(consider)e(the)
g(point)h(of)g(vie)o(w)g(of)g(the)f(memory)h(allocation)f(sys-)1020
2219 y(tem.)26 b(T)m(o)13 b(it,)i(the)e(only)g(interesting)g(e)o(v)o(ents)f
(are)h(object)f(allocations)g(and)1020 2260 y(deallocations.)k(The)9
b(demands)f(placed)h(upon)h(the)g(allocator)g(are)g(directly)1020
2302 y(proportional)c(to)g(the)g(rate)g(of)g(these)g(e)o(v)o(ents)g(rather)g
(than)g(elapsed)g(time.)k(T)m(wo)1020 2343 y(time)j(measurements)e(based)g
(on)h(allocations)f(are)i(easily)f(a)o(v)o(ailable:)20 b(the)1020
2385 y(number)9 b(of)i(allocation)e(e)o(v)o(ents)h(or)g(the)g(number)f(of)i
(bytes)e(allocated)g([11].)1020 2426 y(W)m(e)k(chose)e(the)i(latter)h
(because)d(it)j(more)f(closely)f(re\257ects)g(the)g(demands)1020
2468 y(placed)c(upon)g(the)h(memory)g(system.)1076 2522 y(The)15
b Fk(call-c)o(hain)h Fm(of)h(an)e(e)o(v)o(ent)h(corresponds)d(to)k(an)e
(abstraction)g(of)1020 2563 y(the)g(program')n(s)f(call-stack)g(at)h(the)g
(time)g(that)g(the)g(e)o(v)o(ent)f(occurred.)29 b(In)1020 2605
y(particular)o(,)8 b(we)e(de\256ne)f(the)i(call-chain)f(to)h(be)g(the)f
(ordered)g(list)i(of)f(functions)p eop
%%Page: 3 3
3 2 bop 101 278 1739 2 v 100 361 2 84 v 123 307 a Fm(C)p Fh(FRA)o(C)p
294 361 V 91 w Fm(Cfrac)7 b(is)g(a)g(program)f(that)h(factors)f(lar)o(ge)h
(inte)o(gers)g(using)f(the)h(continued)e(fraction)i(method.)12
b(The)6 b(inputs)h(included)317 349 y(20\26140)h(digit)i(numbers)e(that)h
(were)g(the)g(product)g(of)g(two)g(primes.)p 1839 361 V 101
363 1739 2 v 100 446 2 84 v 123 392 a(E)p Fh(SPRESSO)p 294
446 V 43 w Fm(Espresso,)e(v)o(ersion)h(2.3,)g(is)g(a)g(logic)g(optimization)h
(program.)k(The)7 b(inputs)h(used)e(were)i(e)o(xamples)f(pro)o(vided)h(with)
317 433 y(the)h(release)f(code.)p 1839 446 V 101 448 1739 2
v 100 655 2 208 v 123 477 a(G)p Fh(HOST)p 294 655 V 88 w Fm(GhostScript,)13
b(v)o(ersion)e(2.1,)h(is)g(a)f(publicly-a)o(v)o(ailable)g(interpreter)i(for)f
(the)g(PostScript)f(page-description)f(lan-)317 518 y(guage.)24
b(The)12 b(inputs)g(used)g(include)g(a)h(lar)o(ge)g(reference)f(manual)g(and)
g(a)h(masters)f(thesis.)24 b(These)12 b(e)o(x)o(ecutions)317
560 y(of)g(GhostScript)f(did)h(not)f(run)h(as)f(interacti)o(v)o(e)h
(applications)e(as)h(it)h(is)g(often)g(used,)f(b)o(ut)h(instead)e(were)i(e)o
(x)o(ecuted)317 601 y(with)e(the)e(NODISPLA)l(Y)h(option)g(that)g(simply)g
(forces)f(the)h(interpretation)g(of)g(the)g(PostScript)f(program)h(without)
317 643 y(displaying)f(the)h(results.)p 1839 655 V 101 657
1739 2 v 100 781 2 125 v 123 686 a(G)p Fh(A)m(WK)p 294 781
V 98 w Fm(GNU)16 b(A)m(WK,)g(v)o(ersion)f(2.11,)i(is)f(a)g(publicly-a)o(v)o
(ailable)f(interpreter)h(for)g(the)g(A)m(WK)g(report)g(and)e(e)o(xtraction)
317 727 y(language.)26 b(The)13 b(inputs)g(used)g(an)g(A)m(WK)h(script)g(to)g
(format)h(the)e(words)g(of)i(se)o(v)o(eral)e(dictionaries)g(into)h(\256lled)
317 769 y(paragraphs.)p 1839 781 V 101 783 1739 2 v 100 907
2 125 v 123 812 a(P)p Fh(ERL)p 294 907 V 117 w Fm(Perl)e(4.10,)g(is)f(a)h
(publicly-a)o(v)o(ailable)e(report)i(e)o(xtraction)f(and)g(printing)h
(language)d(commonly)i(used)f(on)h(UNIX)317 853 y(systems.)19
b(The)10 b(input)h(scripts)g(sorted)g(the)g(contents)f(of)h(a)g(\256le)h(and)
e(formated)h(the)g(words)g(in)g(a)g(dictionary)g(into)317 895
y(\256lled)e(paragraphs.)p 1839 907 V 101 909 1739 2 v 567
980 a(T)m(able)f(1:)14 b(General)9 b(information)g(about)g(the)g(test)g
(programs.)p 182 1728 1577 2 v 181 1769 2 42 v 375 1769 V 398
1757 a(Source)p 524 1769 V 44 w(Instructions)p 745 1769 V 44
w(Function)p 923 1769 V 59 w(T)m(otal)p 1074 1769 V 79 w(T)m(otal)p
1233 1769 V 64 w(Maximum)p 1433 1769 V 45 w(Maximum)p 1634
1769 V 44 w(Heap)p 1758 1769 V 181 1811 V 215 1798 a(Program)p
375 1811 V 65 w(Lines)p 524 1811 V 73 w(Ex)o(ecuted)p 745 1811
V 90 w(Calls)p 923 1811 V 84 w(Bytes)p 1074 1811 V 54 w(Objects)p
1233 1811 V 80 w(Bytes)p 1433 1811 V 100 w(Objects)p 1634 1811
V 69 w(Refs)p 1758 1811 V 181 1856 2 46 v 375 1856 V 417 1843
a(of)h(C)p 524 1856 V 99 w(\()p Fg(\002)p Fm(10)662 1827 y
Ff(6)676 1843 y Fm(\))p 745 1856 V 93 w(\()p Fg(\002)p Fm(10)861
1827 y Ff(6)875 1843 y Fm(\))p 923 1856 V 59 w(\()p Fg(\002)p
Fm(10)1026 1827 y Ff(6)1040 1843 y Fm(\))p 1074 1856 V 49 w(\()p
Fg(\002)p Fm(10)1181 1827 y Ff(6)1195 1843 y Fm(\))p 1233 1856
V 74 w(\()p Fg(\002)p Fm(10)1361 1827 y Ff(3)1375 1843 y Fm(\))p
1433 1856 V 1634 1856 V 282 w(\(\045\))p 1758 1856 V 182 1857
1577 2 v 181 1899 2 42 v 204 1886 a(C)p Fh(FRA)o(C)p 375 1899
V 106 w Fm(6000)p 524 1899 V 109 w(1490)p 745 1899 V 128 w(18.4)p
923 1899 V 98 w(65.0)p 1074 1899 V 99 w(3.8)p 1233 1899 V 137
w(83)p 1433 1899 V 144 w(5236)p 1634 1899 V 105 w(79)p 1758
1899 V 181 1940 V 204 1928 a(E)p Fh(SPRESSO)p 375 1940 V 48
w Fm(15500)p 524 1940 V 100 w(2419)p 745 1940 V 128 w(9.55)p
923 1940 V 103 w(105)p 1074 1940 V 103 w(1.7)p 1233 1940 V
128 w(254)p 1433 1940 V 134 w(4387)p 1634 1940 V 105 w(80)p
1758 1940 V 181 1982 V 204 1969 a(G)p Fh(A)m(WK)p 375 1982
V 113 w Fm(8500)p 524 1982 V 109 w(2072)p 745 1982 V 128 w(28.7)p
923 1982 V 103 w(167)p 1074 1982 V 103 w(4.3)p 1233 1982 V
137 w(35)p 1433 1982 V 144 w(1384)p 1634 1982 V 105 w(47)p
1758 1982 V 181 2023 V 204 2011 a(G)p Fh(HOST)p 375 2023 V
93 w Fm(29500)p 524 2023 V 100 w(1035)p 745 2023 V 128 w(1.21)p
923 2023 V 98 w(89.7)p 1074 2023 V 99 w(0.9)p 1233 2023 V 119
w(2113)p 1433 2023 V 115 w(26467)p 1634 2023 V 95 w(69)p 1758
2023 V 181 2065 V 204 2052 a(P)p Fh(ERL)p 375 2065 V 122 w
Fm(34500)p 524 2065 V 109 w(894)p 745 2065 V 138 w(23.4)p 923
2065 V 98 w(33.5)p 1074 2065 V 99 w(1.5)p 1233 2065 V 137 w(62)p
1433 2065 V 144 w(1826)p 1634 2065 V 105 w(48)p 1758 2065 V
182 2067 1577 2 v -76 2137 a(T)m(able)g(2:)15 b(Performance)9
b(information)i(about)e(the)h(memory)g(allocation)f(beha)o(vior)h(for)h(each)
d(of)j(the)f(test)g(programs.)15 b(T)m(otal)c(Bytes)e(and)g(T)m(otal)h
(Objects)g(refer)-76 2179 y(to)g(the)g(total)h(bytes)e(and)g(objects)g
(allocated)g(by)g(each)g(program.)15 b(Maximum)10 b(Bytes)f(and)g(Maximum)h
(Objects)f(sho)o(w)h(the)f(maximum)h(number)f(of)h(bytes)f(and)-76
2220 y(objects,)i(respecti)o(v)o(ely)n(,)f(that)h(were)f(allocated)g(by)g
(each)f(program)i(at)f(an)o(y)h(one)e(time.)19 b(Heap)10 b(Refs)g(sho)o(ws)f
(the)i(percentage)d(of)j(all)h(memory)e(references)f(that)-76
2262 y(were)g(made)f(to)i(objects)e(in)h(the)g(heap)f(\(on)h(a)g(SP)m(ARC)g
(architecture\).)p eop
%%Page: 4 4
4 3 bop -76 -34 a Fm(present)11 b(on)g(the)g(runtime)h(stack)e(at)i(an)o(y)f
(particular)h(program)f(e)o(v)o(ent)g(with)-76 7 y(c)o(ycles)d(of)i(recursi)o
(v)o(e)f(function)f(in)o(v)o(ocations)g(remo)o(v)o(ed.)-20
61 y(W)m(e)i(chose)f(the)h(entire)g(call-chain)g(because)d(it)k(contains)e(a)
h(signi\256cant)-76 103 y(amount)e(of)h(state)f(information)h(about)e(the)i
(dynamic)e(conte)o(xt)h(of)h(an)f(e)o(v)o(ent.)-76 144 y(As)g(an)f(alternati)
o(v)o(e,)i(we)e(could)g(ha)o(v)o(e)g(simply)h(used)e(the)i(last)g(element)f
(of)h(the)-76 186 y(call-chain)f(\(e.g.,)i(the)e(function)g(calling)h
Fk(malloc)p Fm(\))g(b)o(ut)f(we)h(felt)g(that)g(a)f(single)-76
227 y(caller)g(does)e(not)h(pro)o(vide)h(enough)t(information.)14
b(Because)t(recursi)o(v)o(e)6 b(calls)-76 269 y(add)k(no)g(additional)g
(information,)h(we)g(chose)d(to)j(prune)f(out)g(all)h(recursi)o(v)o(e)-76
310 y(loops)6 b(in)g(the)h(de\256nition)f(of)g(the)h(call-chain.)12
b(Users)5 b(of)i(the)f Fk(gpr)n(of)g Fm(e)o(x)o(ecution)-76
352 y(pro\256ler)11 b(will)h(be)f(familiar)h(with)f(this)h(approach)d(of)i
(collapsing)e(c)o(ycles)h(in)-76 393 y(the)f(dynamic)f(call)h(graph)g([8].)
-20 447 y(In)e(our)g(studies,)f(we)g(consider)g(the)g(entire)h(call-chain)f
(to)h(see)e(ho)o(w)h(much)-76 489 y(information)k(would)e(be)h(a)o(v)o
(ailable)f(in)h(the)g(ideal)g(case,)f(and)g(sub-chains)f(of)-76
530 y(the)k(complete)f(call-chain)h(as)f(well.)20 b(In)11 b(practice,)h(the)e
(sequence)f(of)i(calls)-76 572 y(in)h(the)f(call-chain)f(may)h(be)g(v)o(ery)g
(deep.)18 b(Thus,)11 b(we)g(de\256ne)f(the)h Fk(length-N)-76
613 y(sub-c)o(hain)g Fm(to)h(be)g(the)g(last)g(N)g(callers)f(in)i(the)e
(complete)h(call-chain.)21 b(F)o(or)-76 655 y(e)o(xample,)8
b(the)h(length-1)f(sub-chain)f(of)i(a)f(particular)h(complete)f(call-chain)
-76 696 y(is)h(another)g(way)f(to)h(describe)f(the)h(function)g(that)g
(directly)h(calls)f Fk(malloc)p Fm(.)-20 750 y(W)m(e)e(distinguish)f(between)
f(two)h(types)g(of)h(call-chains:)k(one)6 b(consisting)-76
792 y(of)13 b(the)f(chain)g(of)h(functions)e(and)h(the)g(other)h(consisting)e
(of)h(the)h(chain)e(of)-76 833 y(return)16 b(addresses.)29
b(Our)16 b(tools)f(made)g(it)h(easy)e(to)h(use)g(the)g(former)o(,)i(so)-76
875 y(we)12 b(don')o(t)g(distinguish)g(between)e(two)i(calls)g(within)h(the)f
(same)f(function,)-76 916 y(although)d(we)h(will)i(in)e(future)h(work.)-20
970 y(W)m(e)e(de\256ne)e(the)h Fk(allocation)g(site)h Fm(\(or)g(simply)f
(site\))h(to)g(be)f(the)g(call-chain)-76 1012 y(to)h(the)g(allocation)g
(routine)f(at)i(each)d(object)h(birth)i(e)o(v)o(ent.)k(Because)6
b(the)h(size)-76 1053 y(is)14 b(always)e(a)o(v)o(ailable)h(at)g(the)h(time)g
(of)g(allocation,)h(we)e(assume)f(that)i(the)-76 1095 y(object)8
b(size)f(is)h(part)g(of)h(the)f(allocation)f(site)h(unless)f(mentioned)g
(otherwise.)-76 1136 y(Thus,)15 b(the)f(same)f(call-chain)h(allocating)f(8)h
(bytes)f(at)i(one)e(time)i(and)e(16)-76 1178 y(bytes)8 b(another)h
(corresponds)e(to)i(2)g(distinct)g(allocation)g(sites.)-76
1291 y Fn(4)41 b(The)14 b(E\013ectiveness)g(of)f(Lifetime)e(Prediction)-76
1383 y Fm(In)h(this)g(section,)g(we)g(describe)f(the)g(methods)g(used)g(to)h
(perform)g(lifetime)-76 1425 y(prediction)g(and)g(present)g(measures)f(of)h
(the)h(ef)o(fecti)o(v)o(eness)e(of)i(this)g(tech-)-76 1466
y(nique.)-76 1575 y Fn(4.1)41 b(Lifetime)11 b(Quantile)k(Histogram)o(s)-76
1654 y Fm(Our)c(goal)f(is)g(to)g(determine)g(ho)o(w)g(well)h(the)f
(allocation)g(site)g(and)g(size)f(pre-)-76 1696 y(dict)16 b(the)f(lifetime)h
(of)g(the)f(objects)f(created.)31 b(A)16 b(gi)o(v)o(en)f(allocation)g(site)
-76 1737 y(creates)9 b(man)o(y)h(objects)f(of)h(v)o(arying)f(lifetimes.)17
b(W)m(e)10 b(measure)f(the)h(associ-)-76 1779 y(ated)c(lifetime)i(distrib)o
(ution)g(of)e(each)g(allocation)g(site)g(using)g(Jain')n(s)g(quantile)-76
1820 y(histogram)j(algorithm)h([12],)g(which)f(generates)e(approximations)h
(of)i(a)f(set)-76 1862 y(of)j(quantiles)e(for)i(a)f(distrib)o(ution.)20
b(W)m(e)11 b(use)f(Jain')n(s)h(algorithm)g(because)e(it)-76
1903 y(allo)o(ws)j(us)g(to)g(compute)f(the)h(quantiles)f(with)i(minimal)g
(storage)e(require-)-76 1945 y(ments.)-20 1999 y(T)m(o)i(collect)h(the)f
(quantile)g(histograms)g(at)h(each)e(allocation)h(site,)i(we)-76
2040 y(instrument)9 b(each)f(program)h(with)h(A)p Fh(E)p Fm(,)g(which)f(allo)
o(ws)g(us)f(to)i(maintain)f(the)-76 2082 y(current)g(call-chain)g(and)f
(associate)g(each)f(object)i(with)h(its)f(allocation)g(site.)-76
2123 y(When)j(an)h(object)f(is)h(allocated,)g(we)g(enter)f(the)h(object)f
(and)g(its)h(site)g(into)-76 2165 y(a)h(database.)26 b(When)13
b(the)h(object)g(is)g(later)g(freed,)i(we)e(add)f(its)h(observ)o(ed)-76
2206 y(lifetime)9 b(to)f(the)g(quantile)f(histogram)h(associated)d(with)k
(its)f(allocation)f(site.)-76 2248 y(When)f(the)g(instrumented)f(program)h
(\256nishes,)f(we)h(are)g(left)h(with)g(a)f(mapping)-76 2289
y(of)k(allocation)f(sites)g(to)h(quantile)f(histograms)g(for)h(each)f
(allocation)g(site)g(in)-76 2331 y(the)g(program.)-20 2385
y(T)m(able)i(3)h(illustrates)h(the)f(quartiles)g(of)g(the)g(object)f
(lifetime)j(distrib)o(u-)-76 2426 y(tions)f(in)g(each)e(of)i(the)f(\256v)o(e)
g(applications.)23 b(The)12 b(table)h(sho)o(ws)e(that)i(most)-76
2468 y(objects)8 b(in)g(all)h(of)g(the)g(applications)e(are)h(v)o(ery)h
(short-li)o(v)o(ed,)g(with)g(o)o(v)o(er)g(half)-76 2509 y(of)j(the)g(objects)
f(in)h(each)f(program)h(li)o(ving)g(less)f(than)h(10,000)f(bytes.)21
b(W)m(e)-76 2551 y(also)9 b(see)f(in)i(the)f(table)g(that)h(the)f(oldest)g
(objects)f(in)i(a)f(program)g(li)o(v)o(e)h(orders)-76 2592
y(of)j(magnitude)f(longer)g(than)g(the)g(median)g(age.)23 b(T)m(able)12
b(3)h(illustrates)g(the)1020 -34 y(kind)d(of)g(data)g(we)f(collect)h(for)h
(each)e(allocation)g(site)h(in)h(the)e(programs)h(we)1020 7
y(measured.)1076 61 y(F)o(or)h(the)f(purpose)e(of)j(impro)o(ving)f(a)g
(memory)g(allocation)g(system,)g(we)1020 103 y(would)i(like)h(to)h(group)e
(objects)h(with)g(similar)i(lifetimes)f(together)n(.)25 b(One)1020
144 y(method)6 b(is)h(to)f(\256nd)g(especially)f(short-li)o(v)o(ed)j(objects)
d(and)h(place)f(them)i(into)g(a)1020 186 y(se)o(gre)o(gated)f(area)h(of)h
(memory)f(or)h Fk(ar)o(ena)d Fm(\(after)k(Hanson)c([10]\).)14
b(T)m(o)8 b(predict)1020 227 y(that)i(a)f(particular)h(allocation)f(site)h
(will)h(allocate)e(short-li)o(v)o(ed)h(objects,)f(we)1020 269
y(look)g(at)g(the)h(quantile)e(histogram)h(for)h(that)g(site.)k(If)c(a)f(lar)
o(ge)h(percentage)d(of)1020 310 y(the)g(objects)f(allocated)h(at)g(that)g
(site)h(are)f(short-li)o(v)o(ed,)h(we)f(consider)f(that)h(site)1020
352 y(to)12 b(be)g(an)f(e)o(xcellent)h(predictor)g(of)g(short-li)o(v)o(ed)h
(objects.)21 b(If)13 b(a)f(collection)1020 393 y(of)e(such)f(sites)h
(predicts)f(the)h(lifetimes)h(of)g(a)f(lar)o(ge)g(fraction)g(of)h(all)f
(objects)1020 435 y(allocated,)f(we)g(say)f(that)h(the)g(predictor)g(is)g
(successful.)1076 489 y(Ho)o(w)h(short)g(is)g(short-li)o(v)o(ed?)15
b(The)9 b(answer)g(to)h(this)g(question)f(depends)1020 530
y(on)d(se)o(v)o(eral)h(factors.)12 b(First,)c(we)f(must)g(realize)f(that)h
(the)g(longer)f(we)h(consider)1020 572 y(\252short-li)o(v)o(ed\272)k(to)h
(be,)f(the)g(more)g(objects)g(we)g(will)h(be)f(able)g(to)g(predict)g(as)1020
613 y(short-li)o(v)o(ed)j(\(consider)e(the)h(de)o(generate)e(case)h(of)h(the)
g(maximum)g(object)1020 655 y(lifetime\).)32 b(On)15 b(the)f(other)h(hand,)g
(the)g(shorter)g(we)f(predict)h(short-li)o(v)o(ed)1020 696
y(objects)10 b(to)i(li)o(v)o(e,)h(the)e(smaller)g(the)g(re)o(gion)g(of)h
(memory)f(\(arena\))g(we)g(need)1020 738 y(to)g(set)f(aside)f(to)h(store)h
(them.)17 b(Making)9 b(this)i(re)o(gion)f(as)g(small)g(as)g(possible)1020
779 y(has)e(two)g(adv)o(antages.)j(First,)f(it)g(decreases)c(the)i(total)i
(heap)d(size,)i(reducing)1020 821 y(the)k(memory)h(o)o(v)o(erhead)e(of)i
(storage)f(allocation.)26 b(Second,)13 b(it)i(localizes)1020
862 y(the)c(references)g(to)h(short-li)o(v)o(ed)g(objects,)f(reducing)g(the)g
(cache)f(and)h(page)1020 904 y(miss)g(rates.)20 b(In)12 b(addition)f(to)g
(balancing)f(these)h(concerns,)f(we)h(must)g(also)1020 945
y(consider)5 b(that)i(each)e(program)h(will)h(ha)o(v)o(e)f(dif)o(ferent)h
(lifetime)h(distrib)o(utions.)1076 999 y(F)o(or)i(the)f(rest)h(of)g(this)f
(paper)o(,)g(we)g(choose)f(\252short-li)o(v)o(ed\272)h(to)h(mean)e(less)1020
1041 y(than)14 b(32)f(kilobytes.)28 b(W)m(e)14 b(felt)h(this)f(size)f(does)g
(not)h(adv)o(ersely)f(increase)1020 1082 y(the)h(heap)e(size)h(and)g(at)h
(the)g(same)f(time)h(\(as)g(we)f(will)j(see\))d(it)h(allo)o(ws)g(us)1020
1124 y(to)i(ef)o(fecti)o(v)o(ely)h(predict)f(a)f(lar)o(ge)h(fraction)h(of)f
(objects)f(as)g(being)g(short-)1020 1165 y(li)o(v)o(ed.)27
b(W)m(e)14 b(ha)o(v)o(e)f(in)o(v)o(estigated)f(other)h(v)o(alues)f(for)j
(this)e(parameter)o(,)h(and)1020 1207 y(the)h(correct)g(choice)e(of)i(v)o
(alue)g(is)g(clearly)f(application)h(dependent.)28 b(In)1020
1248 y(general,)11 b(this)g(v)o(alue)g(would)f(be)h(determined)f
(automatically)h(by)f(the)h(tool)1020 1290 y(that)k(analyses)e(the)i(program)
f(beha)o(vior)n(.)30 b(Our)15 b(arbitrary)h(choice)e(of)h(32)1020
1331 y(kilobytes)d(simpli\256es)g(the)g(descriptions)g(in)h(this)f(paper)g
(and)g(also)g(sho)o(ws)1020 1373 y(good)c(performance)g(in)i(our)f
(particular)g(applications.)1076 1427 y(Another)f(point)f(relating)i(to)f
(lifetime)h(quantile)e(histograms)g(must)h(also)1020 1468 y(be)j(considered.)
17 b(Earlier)o(,)c(we)e(said)f(that)h(we)g(chose)f(allocation)h(sites)f(that)
1020 1510 y(allocate)15 b(a)g(\252lar)o(ge)g(percentage\272)e(of)j(short-li)o
(v)o(ed)g(objects.)32 b(Ho)o(w)15 b(lar)o(ge)1020 1551 y(should)7
b(this)i(percentage)d(be?)13 b(The)7 b(answer)h(to)g(this)h(question)e(is)i
(related)f(to)1020 1593 y(the)h(cost)f(of)h(incorrect)f(prediction:)13
b(the)c(cheaper)e(incorrect)i(prediction)f(is,)1020 1634 y(the)g(more)f
(sites)h(that)g(allocate)f(non-short-li)o(v)o(ed)h(objects)f(we)g(can)g(allo)
o(w)n(.)13 b(In)1020 1676 y(our)e(case,)f(the)h(algorithm)g(that)g(takes)f
(adv)o(antage)e(of)k(lifetime)g(prediction)1020 1717 y(will)d(not)f(work)f
(well)h(if)h(incorrect)e(prediction)g(is)h(frequent.)13 b(Therefore,)8
b(we)1020 1759 y(only)j(consider)e(allocation)i(sites)g(in)g(which)f
Fk(all)i Fm(of)g(the)e(objects)g(allocated)1020 1800 y(li)o(v)o(ed)g(less)f
(than)g(32)g(kilobytes.)14 b(That)9 b(is,)h(our)f(algorithm)h(predicts)f
(that)h(an)1020 1842 y(allocation)c(site)g(will)g(allocate)g(short-li)o(v)o
(ed)g(objects)g(if)g(all)g(objects)g(allocated)1020 1883 y(at)j(that)h(site)f
(in)g(the)g(training)h(inputs)f(were)g(short-li)o(v)o(ed)g(objects.)1076
1937 y(T)m(able)j(4)h(sho)o(ws)e(the)i(fraction)g(of)h(total)f(bytes)f
(allocated)g(in)h(the)g(\256v)o(e)1020 1979 y(test)e(programs)g(that)g(were)g
(predicted)g(as)f(short-li)o(v)o(ed)i(based)d(on)i(their)h(al-)1020
2020 y(location)e(sites.)17 b(This)10 b(table)g(sho)o(ws)f(what)h(is)h
(possible)e(based)f(entirely)j(on)1020 2062 y(e)o(xamining)f(allocation)h
(sites)f(and)h(does)e(not)i(present)f(a)h(measurement)e(of)1020
2103 y(an)i(actual)g(simulation.)20 b(In)12 b(a)f(later)h(section,)f(we)g
(present)g(simulation)g(re-)1020 2145 y(sults.)17 b(Throughout)9
b(this)i(paper)e(we)h(distinguish)g(between)f Fk(self)16 b
Fm(and)9 b Fk(true)1020 2187 y Fm(prediction.)26 b(By)13 b
Fk(self)h(pr)o(ediction)p Fm(,)f(we)g(mean)g(prediction)g(in)h(which)f(the)
1020 2228 y(same)g(input)g(is)h(used)e(for)i(both)g(the)f(training)h(and)f
(test)g(e)o(x)o(ecutions)g(of)h(a)1020 2270 y(program.)20 b
Fk(T)n(rue)10 b(pr)o(ediction)f Fm(implies)j(that)f(dif)o(ferent)h(inputs)f
(are)g(used)f(in)1020 2311 y(the)f(training)h(and)e(test)h(e)o(x)o(ecutions.)
1076 2365 y(T)m(o)k(perform)h(true)g(prediction,)g(we)f(must)g(map)g(the)g
(allocation)g(sites)1020 2407 y(from)g(the)e(training)h(inputs)f(into)h
(allocation)f(sites)h(in)g(the)f(test)h(e)o(x)o(ecution.)1020
2448 y(W)m(e)d(found)e(that)i(requiring)g(an)f(e)o(xact)g(mapping)f(of)i
(allocation)f(sites)g(some-)1020 2490 y(times)15 b(pre)o(v)o(ented)f
(corresponding)f(sites)h(from)i(correctly)f(mapping)f(be-)1020
2531 y(tween)8 b(runs.)13 b(By)8 b(rounding)g(the)g(object)g(size)f(to)i(a)f
(multiple)i(of)e(four)h(bytes,)1020 2573 y(we)15 b(found)f(the)h
(corresponding)e(sites)i(were)g(more)g(likely)g(to)g(map)g(cor)o(-)p
eop
%%Page: 5 5
5 4 bop 461 280 1019 2 v 460 322 2 42 v 654 322 V 872 309 a
Fm(Object)9 b(Lifetime)h(Quantiles)p 1479 322 V 655 323 825
2 v 460 363 2 42 v 493 351 a(Program)p 654 363 V 72 w(0\045)p
782 363 V 64 w(25\045)p 901 363 V 81 w(50\045)p 1081 363 V
104 w(75\045)p 1247 363 V 120 w(100\045)p 1479 363 V 460 405
V 654 405 V 677 392 a(\(min\))p 782 405 V 901 405 V 166 w(\(median\))p
1081 405 V 1247 405 V 259 w(\(max\))p 1479 405 V 461 406 1019
2 v 460 448 2 42 v 483 436 a(C)p Fh(FRA)o(C)p 654 448 V 114
w Fm(10)p 782 448 V 86 w(32)p 901 448 V 111 w(48)p 1081 448
V 126 w(849)p 1247 448 V 86 w(64,994,593)p 1479 448 V 460 489
V 483 477 a(E)p Fh(SPRESSO)p 654 489 V 75 w Fm(4)p 782 489
V 86 w(196)p 901 489 V 79 w(2,379)p 1081 489 V 79 w(25,530)p
1247 489 V 52 w(104,881,499)p 1479 489 V 460 531 V 483 519
a(G)p Fh(A)m(WK)p 654 531 V 130 w Fm(2)p 782 531 V 96 w(29)p
901 531 V 102 w(257)p 1081 531 V 107 w(1192)p 1247 531 V 66
w(167,322,377)p 1479 531 V 460 573 V 483 560 a(G)p Fh(HOST)p
654 573 V 111 w Fm(16)p 782 573 V 67 w(4330)p 901 573 V 69
w(8,052)p 1081 573 V 69 w(393,531)p 1247 573 V 53 w(89,669,104)p
1479 573 V 460 614 V 483 602 a(P)p Fh(ERL)p 654 614 V 149 w
Fm(1)p 782 614 V 96 w(64)p 901 614 V 102 w(887)p 1081 614 V
107 w(1306)p 1247 614 V 76 w(33,528,692)p 1479 614 V 461 616
1019 2 v -76 686 a(T)m(able)e(3:)13 b(Quantile)8 b(histogram)f(of)i(object)e
(lifetimes)i(in)g(\256v)o(e)f(programs.)k(The)c(table)g(presents)e(quartiles)
i(of)h(the)f(distrib)o(utions)g(of)g(object)g(lifetimes)h(\(in)g(bytes\))-76
728 y(in)g(each)f(program,)h(illustrating)h(ho)o(w)e(object)h(lifetimes)g
(are)g(distrib)o(uted.)14 b(T)m(o)8 b(read)h(the)f(table,)h(each)f(column)g
(gi)o(v)o(es)g(the)h(lifetime)h(for)g(which)e(that)i(percentage)-76
770 y(of)h(bytes)f(is)h(ali)o(v)o(e.)19 b(F)o(or)11 b(e)o(xample,)g(75\045)f
(of)h(the)g(bytes)e(allocated)h(in)h(G)p Fh(A)m(WK)g Fm(li)o(v)o(e)g(less)f
(than)h(1192)e(bytes.)18 b(Note)10 b(that)h(the)g(quantile)f(histograms)g
(presented)-76 811 y(here)f(are)h(approximations)e(of)j(the)e(true)h
(quantiles.)15 b(F)o(or)10 b(e)o(xample,)g(actual)f(measurements)f(sho)o(w)g
(that)i(the)g(true)g(75\045)g(quantile)f(for)h(G)p Fh(HOST)f
Fm(should)g(be)g(less)-76 853 y(than)g(32,000,)f(b)o(ut)i(the)f(quantile)f
(histogram)h(approximates)f(this)h(v)o(alue)f(as)h(393,531.)p
770 1604 927 2 v 769 1644 2 42 v 890 1632 a(Self)h(Prediction)p
1232 1644 V 235 w(T)o(rue)e(Prediction)p 1695 1644 V 244 1646
1453 2 v 243 1688 2 42 v 437 1688 V 461 1675 a(T)m(otal)p 558
1688 V 78 w(Actual)p 769 1688 V 891 1688 V 212 w(Predicted)p
1103 1688 V 60 w(Error)p 1232 1688 V 1354 1688 V 183 w(Predicted)p
1566 1688 V 60 w(Error)p 1695 1688 V 243 1729 V 277 1717 a(Program)p
437 1729 V 56 w(Sites)p 558 1729 V 46 w(Short-li)o(v)o(ed)p
769 1729 V 48 w(Sites)p 891 1729 V 46 w(Short-li)o(v)o(ed)p
1103 1729 V 46 w(Bytes)p 1232 1729 V 46 w(Sites)p 1354 1729
V 46 w(Short-li)o(v)o(ed)p 1566 1729 V 46 w(Bytes)p 1695 1729
V 243 1771 V 437 1771 V 558 1771 V 589 1758 a(Bytes)h(\(\045\))p
769 1771 V 54 w(Used)p 891 1771 V 51 w(Bytes)g(\(\045\))p 1103
1771 V 68 w(\(\045\))p 1232 1771 V 61 w(Used)p 1354 1771 V
51 w(Bytes)g(\(\045\))p 1566 1771 V 68 w(\(\045\))p 1695 1771
V 244 1772 1453 2 v 243 1814 2 42 v 267 1801 a(C)p Fh(FRA)o(C)p
437 1814 V 100 w Fm(134)p 558 1814 V 110 w(100)p 769 1814 V
109 w(110)p 891 1814 V 105 w(79.0)p 1103 1814 V 105 w(0.00)p
1232 1814 V 73 w(77)p 1354 1814 V 115 w(47.3)p 1566 1814 V
105 w(3.65)p 1695 1814 V 243 1855 V 267 1843 a(E)p Fh(SPRESSO)p
437 1855 V 43 w Fm(2854)p 558 1855 V 109 w(91)p 769 1855 V
110 w(2291)p 891 1855 V 95 w(41.8)p 1103 1855 V 105 w(0.00)p
1232 1855 V 64 w(855)p 1354 1855 V 105 w(18.1)p 1566 1855 V
105 w(0.06)p 1695 1855 V 243 1897 V 267 1884 a(G)p Fh(A)m(WK)p
437 1897 V 107 w Fm(171)p 558 1897 V 119 w(98)p 769 1897 V
128 w(93)p 891 1897 V 115 w(99.3)p 1103 1897 V 105 w(0.00)p
1232 1897 V 73 w(91)p 1354 1897 V 115 w(99.3)p 1566 1897 V
105 w(0.00)p 1695 1897 V 243 1938 V 267 1926 a(G)p Fh(HOST)p
437 1938 V 97 w Fm(634)p 558 1938 V 119 w(97)p 769 1938 V 119
w(256)p 891 1938 V 105 w(80.9)p 1103 1938 V 105 w(0.00)p 1232
1938 V 64 w(211)p 1354 1938 V 105 w(71.8)p 1566 1938 V 105
w(0.00)p 1695 1938 V 243 1980 V 267 1967 a(P)p Fh(ERL)p 437
1980 V 126 w Fm(305)p 558 1980 V 119 w(99)p 769 1980 V 128
w(74)p 891 1980 V 115 w(91.4)p 1103 1980 V 105 w(0.00)p 1232
1980 V 73 w(29)p 1354 1980 V 115 w(20.4)p 1566 1980 V 105 w(1.11)p
1695 1980 V 244 1981 1453 2 v -76 2052 a(T)m(able)e(4:)12 b(Fraction)7
b(of)g(total)h(bytes)e(predicted)h(as)f(being)h(short-li)o(v)o(ed)g(based)f
(upon)g(allocation)h(site)g(and)f(size)h(in)g(each)f(of)h(\256v)o(e)g
(programs.)12 b(T)m(otal)7 b(Sites)g(indicates)-76 2094 y(the)k(total)h
(allocation)f(sites)h(in)f(the)g(program)h(while)f(the)h(Actual)f(column)g
(sho)o(ws)f(the)h(true)h(percentage)d(of)j(short-li)o(v)o(ed)g(bytes.)19
b(The)11 b(Sites)g(Used)g(columns)-76 2135 y(indicate)d(ho)o(w)h(man)o(y)f
(distinct)h(allocation)f(sites)g(were)h(used)e(to)i(identify)g(the)g
(short-li)o(v)o(ed)g(objects.)k(The)8 b(Predicted)g(Bytes)g(columns)f(sho)o
(w)h(what)h(percentage)-76 2177 y(of)g(total)h(bytes)e(allocated)g(are)g
(correctly)h(predicted)f(as)g(short-li)o(v)o(ed)i(based)d(upon)h(their)h
(allocation)f(site)h(and)f(size.)13 b(Objects)8 b(are)h(considered)e
(\252short-li)o(v)o(ed\272)h(if)-76 2218 y(the)o(y)i(are)f(deallocated)f
(\(die\))j(before)e(32)g(kilobytes)g(of)h(ne)o(w)g(data)f(are)g(allocated.)15
b(The)9 b(Error)h(Bytes)f(columns)g(indicate)g(what)h(fraction)g(of)g(total)g
(bytes)f(were)-76 2260 y(predicted)g(as)f(short-li)o(v)o(ed)i(by)e(the)h
(predictor)h(b)o(ut)f(were)g(actually)f(long-li)o(v)o(ed.)p
eop
%%Page: 6 6
6 5 bop -76 -34 a Fm(rectly)n(.)19 b(Rounding)9 b(to)j(a)e(lar)o(ger)i
(multiple)g(of)f(two)g(reduced)e(the)i(mapping)-76 7 y(ef)o(fecti)o(v)o
(eness)d(because)f(too)i(much)f(size)h(information)g(was)f(eliminated.)-20
61 y(In)17 b(understanding)d(the)i(results)f(using)h(true)g(prediction,)i(it)
f(is)f(also)-76 103 y(important)6 b(to)g(kno)o(w)g(ho)o(w)g(the)g(inputs)g(u)
o(sed)f(for)h(training)g(and)f(mea)o(sureme)o(nt)-76 144 y(dif)o(fered.)20
b(T)m(able)10 b(4)h(illustrates)h(some)e(of)h(the)g(important)h(aspects)d(of)
i(ho)o(w)-76 186 y(the)e(input)h(sets)e(dif)o(fered)i(in)g(the)f(programs)f
(measured.)13 b(F)o(or)d(e)o(xample,)f(the)-76 227 y(two)14
b(P)p Fh(ERL)g Fm(inputs)f(represent)f(two)i(distinct)f(P)p
Fh(ERL)h Fm(programs)f(operating)-76 269 y(on)h(distinct)g(inputs.)27
b(As)13 b(such,)h(we)g(e)o(xpect)f(to)h(see)f(less)g(ef)o(fecti)o(v)o(e)h
(true)-76 310 y(prediction)8 b(in)h(P)p Fh(ERL)p Fm(.)k(By)8
b(contrast,)g(the)h(two)f(G)p Fh(A)m(WK)g Fm(inputs)f(use)h(the)g(same)-76
352 y(ga)o(wk)f(program)g(and)f(only)h(dif)o(fer)h(in)g(what)f(data)f(the)i
(ga)o(wk)e(program)h(is)g(fed.)-76 393 y(In)j(this)f(case,)f(we)h(e)o(xpect)f
(to)i(see)e(v)o(ery)h(ef)o(fecti)o(v)o(e)g(true)h(prediction.)-20
447 y(W)m(e)j(see)f(in)i(T)m(able)e(4)h(that)g(the)g(generational)f
(hypothesis)f(\(most)j(ob-)-76 489 y(jects)f(die)h(young\))e(used)h(in)g
(garbage)f(collection)h(was)g(v)o(alid)g(for)i(all)f(our)-76
530 y(programs.)i(Short-li)o(v)o(ed)11 b(objects)f(accounted)e(for)j(more)f
(than)g(90\045)g(of)g(all)-76 572 y(bytes)g(allocated)f(in)i(e)o(v)o(ery)f
(program.)18 b(Furthermore,)11 b(in)g(most)f(cases,)g(the)-76
613 y(allocation)g(sites)g(identi\256ed)f(man)o(y)h(of)g(the)g(short-li)o(v)o
(ed)h(objects.)k(This)10 b(re-)-76 655 y(sult)j(suggests)e(that)i(lifetime)h
(prediction)e(based)f(on)h(allocation)h(site)f(and)-76 696
y(size)d(is)g(possible)f(and)g(potentially)h(v)o(ery)g(ef)o(fecti)o(v)o(e.)
-20 750 y(T)m(able)h(4)h(also)f(sho)o(ws)g(that)h(the)g(training)g(sets)f(do)
g(not)h(always)e(e)o(xhibit)-76 792 y(the)h(same)e(beha)o(vior)h(as)g(the)g
(test)h(inputs.)k(That)9 b(is,)h(sometimes)f(predictors)-76
833 y(will)i(incorrectly)f(identify)h(long-li)o(v)o(ed)f(objects)f(as)g
(being)h(short-li)o(v)o(ed.)16 b(In)-76 875 y(the)d(case)e(of)i(self)g
(prediction,)h(errors)f(do)g(not)g(occur)f(because)e(sites)i(that)-76
916 y(only)d(allocate)g(short-li)o(v)o(ed)h(objects)e(are)h(selected.)j(W)o
(ith)e(true)g(prediction,)-76 958 y(those)f(same)f(sites)h(may)g
(occasionally)e(allocate)i(long-li)o(v)o(ed)h(objects.)j(The)-76
999 y(table)g(sho)o(ws)f(that)i(incorrect)f(prediction)g(is)h(usually)e(a)h
(v)o(ery)h(small)f(per)o(-)-76 1041 y(centage)d(and)g(only)h(potentially)h(a)
f(problem)g(with)h(the)f(C)p Fh(FRA)o(C)g Fm(and)f(P)p Fh(ERL)-76
1082 y Fm(applications.)-20 1136 y(After)j(sho)o(wing)f(that)g(prediction)g
(is)g(possible,)g(we)g(sought)g(to)g(deter)o(-)-76 1178 y(mine)h(if)h(the)e
(size)h(and)f(complete)g(allocation)g(site)h(are)g(both)f(needed)f(for)-76
1219 y(ef)o(fecti)o(v)o(e)f(prediction.)k(W)m(e)c(\256rst)g(e)o(xamined)e
(the)h(ef)o(fect)h(of)g(using)f(only)g(the)-76 1261 y(size)i(to)h(predict)g
(the)g(lifetime)h(as)e(sho)o(wn)g(in)h(T)m(able)f(5.)21 b(The)11
b(table)h(sho)o(ws)-76 1302 y(that,)c(while)g(in)g(some)e(cases)f(size)i(can)
f(be)h(slightly)h(ef)o(fecti)o(v)o(e,)g(in)g(e)o(v)o(ery)f(case)-76
1344 y(the)13 b(ef)o(fecti)o(v)o(eness)f(is)i(much)e(less)h(than)f(that)i(of)
f(using)g(both)g(the)g(alloca-)-76 1385 y(tion)e(site)f(and)f(size.)16
b(This)10 b(result)g(con\256rms)g(a)g(similar)h(observ)o(ation)e(made)-76
1427 y(by)h(Ungar)g(and)f(Jackson)f(about)h(the)h(correlation)g(of)h(size)e
(and)h(lifetime)h(in)-76 1468 y(Smalltalk)f(programs)e([19].)-20
1522 y(Another)i(way)g(to)h(reduce)e(the)i(cost)f(of)h(lifetime)h(prediction)
e(is)h(to)g(use)-76 1564 y(less)d(than)g(the)h(complete)f(call-chain)g(to)h
(predict)g(lifetimes.)15 b(T)m(o)8 b(determine)-76 1605 y(the)16
b(ef)o(fect)f(of)h(reduced)e(information,)k(we)d(e)o(xamined)g(what)g
(happened)-76 1647 y(to)e(the)g(predictions)f(if)h(the)g(complete)f
(call-chain)g(in)h(the)f(allocation)h(site)-76 1688 y(length)i(was)e
(restricted)i(to)g(a)g(length-N)f(sub-chain.)29 b(T)m(able)14
b(6)h(presents)-76 1730 y(the)c(relationship)f(between)f(call-chain)h(length)
g(and)g(the)g(ef)o(fecti)o(v)o(eness)f(of)-76 1771 y(lifetime)i(prediction.)j
(The)9 b(table)g(sho)o(ws)f(that)i(as)e(site)i(length)f(increases,)f(a)-76
1813 y(lar)o(ger)j(percentage)d(of)j(short-li)o(v)o(ed)g(objects)e(is)h
(identi\256ed.)16 b(Furthermore,)-76 1854 y(for)f(each)e(application)g(there)
h(was)e(a)i(length)g(at)g(which)f(this)i(percentage)-76 1896
y(abruptly)10 b(increases.)15 b(W)m(e)10 b(see)f(from)i(the)f(table)g(that)h
(this)f(abrupt)g(increase)-76 1937 y(occurs)i(at)h(a)h(relati)o(v)o(ely)g
(short)f(length,)h(always)d(length-4)i(or)h(less)e(in)i(the)-76
1979 y(programs)g(measured.)29 b(The)14 b(intuiti)o(v)o(e)i(e)o(xplanation)e
(for)h(this)g(beha)o(vior)-76 2020 y(is)g(that)h(programs)e(use)g(a)h
(layered)g(design.)30 b(Until)16 b(enough)d(layers)i(are)-76
2062 y(resolv)o(ed,)8 b(the)g(dif)o(ferent)g(actual)g(allocators)f(of)h
(objects)f(are)h(indistinguish-)-76 2103 y(able.)13 b(F)o(or)c(e)o(xample,)f
(man)o(y)g(programmers)f(perform)i(memory)f(allocation)-76
2145 y(by)g(calling)f(a)h(function)g Fk(xmalloc)f Fm(which)h(then)f(calls)h
Fk(malloc)p Fm(.)13 b(The)7 b Fk(xmalloc)-76 2187 y Fm(layer)j(pro)o(vides)g
(greater)g(security)f(by)h(checking)e(that)j(the)f(v)o(alue)f(returned)-76
2228 y(from)h Fk(malloc)f Fm(is)g(not)f(NULL.)h(In)h(such)d(a)i(design,)f
(the)h(length-1)f(call-chain)-76 2270 y(information)i(would)e(be)h(an)f(inef)
o(fecti)o(v)o(e)i(predictor)n(.)-20 2323 y(T)m(able)h(6)h(also)f(suggests)e
(ho)o(w)i(ef)o(fecti)o(v)o(e)h(lifetime)h(prediction)f(can)e(be)-76
2365 y(at)15 b(impro)o(ving)h(the)f(reference)f(locality)i(of)f(programs.)31
b(The)15 b(Ne)o(w)f(Ref)-76 2407 y(column)e(for)h(each)f(application)g(sho)o
(ws)f(the)h(predicted)g(fraction)h(of)g(total)-76 2448 y(heap)6
b(references)g(that)i(are)f(made)f(to)i(short-li)o(v)o(ed)g(objects)e
(\(i.e.,)j(the)f(objects)-76 2490 y(that)15 b(will)i(be)d(highly-localized)g
(using)g(lifetime)i(prediction\).)32 b(W)m(e)15 b(see)-76 2531
y(from)d(that)g(table)f(that)g(heap)f(references)g(to)i(short-li)o(v)o(ed)g
(objects)e(account)-76 2573 y(for)g(8\26170\045)e(of)i(all)f(references,)g
(typically)g(accounting)e(for)j(around)e(40\045.)1076 -34 y(From)14
b(T)m(able)f(6,)i(we)f(see)f(that)h(the)f(length-4)h(call-chain)f(ef)o(fecti)
o(v)o(ely)1020 7 y(predicts)c(a)g(lar)o(ge)g(fraction)g(\()p
Fl(>)h Fm(90\045\))f(of)h(the)e(short-li)o(v)o(ed)i(bytes)e(predicted)1020
49 y(by)e(the)g(complete)g(call)g(chain.)k(W)m(e)c(conclude)g(from)g(this)g
(measureme)o(nt)g(that)1020 90 y(in)11 b(practice,)f(length-4)g(call)h
(chains)e(can)g(be)h(v)o(ery)g(ef)o(fecti)o(v)o(e)h(at)g(predicting)1020
132 y(short-li)o(v)o(ed)f(object)e(lifetimes.)1020 245 y Fn(5)41
b(Simulation)11 b(Results)1020 337 y Fm(Measurements)i(in)j(the)f(pre)o
(vious)f(section)g(sho)o(w)g(that)h(allocation)g(sites)1020
379 y(ef)o(fecti)o(v)o(ely)i(predict)f(the)g(allocation)g(of)h(short-li)o(v)o
(ed)g(objects.)34 b(In)16 b(this)1020 420 y(section)11 b(we)h(e)o(xplore)f
(the)h(performance)f(bene\256ts)f(and)h(costs)g(of)h(lifetime)1020
462 y(prediction.)18 b(In)11 b(particular)o(,)g(we)g(describe)e(an)h
(algorithm)h(that)g(se)o(gre)o(gates)1020 503 y(short-li)o(v)o(ed)c(objects)f
(and)g(we)g(sho)o(w)n(,)h(through)f(simulation,)h(that)g(all)g(aspects)1020
545 y(of)12 b(performance)f(of)h(this)g(algorithm)g(may)f(be)g(impro)o(v)o
(ed)h(when)f(lifetime)1020 586 y(prediction)e(is)g(employed.)1020
695 y Fn(5.1)41 b(The)14 b(Algo)o(rithm)1020 774 y Fm(Using)h(the)g
(techniques)e(described)g(in)j(the)f(pre)o(vious)f(section,)i(training)1020
816 y(e)o(x)o(ecutions)6 b(of)i(a)f(program)g(are)g(used)f(to)i(generate)e(a)
h(set)g(of)h(allocation)f(sites)1020 857 y(that)j(predict)g(only)g(short-li)o
(v)o(ed)g(objects.)15 b(This)10 b(set)f(of)i(sites)e(is)h(stored)g(in)g(a)
1020 899 y(database)e(that)j(is)g(incorporated)f(into)h(an)f(allocation)g
(system)f(that)i(is)g(then)1020 940 y(linked)f(to)h(the)f(program.)18
b(When)10 b(an)g(object)g(is)g(allocated,)h(the)f(allocation)1020
982 y(system)i(uses)g(this)h(database)e(of)i(allocation)g(sites)f(to)i
(select)e(one)g(of)i(two)1020 1023 y(strate)o(gies:)25 b(one)14
b(speci\256c)g(to)h(the)g(short-li)o(v)o(ed)h(allocation)e(sites,)j(and)d(a)
1020 1065 y(general)8 b(one)h(for)h(all)f(others.)1076 1119
y(The)k(short-li)o(v)o(ed)h(objects)e(are)h(allocated)f(using)h(an)g
(algorithm)g(v)o(ery)1020 1160 y(similar)8 b(to)f(Hanson')n(s)e([10].)13
b(Each)6 b(short-li)o(v)o(ed)h(arena)f(has)g(a)g(\256x)o(ed)g(size)g(that)
1020 1202 y(is)h(relati)o(v)o(ely)h(small)f(\(8\26132)g(kilobytes\))1532
1186 y Ff(1)1546 1202 y Fm(.)13 b(In)7 b(addition)g(to)g(the)g(objects,)g
(each)1020 1243 y(arena)k(contains)g(one)g(pointer)g(\(alloc\))i(and)e(a)h
(count)f(\256eld)g(that)h(identi\256es)1020 1285 y(ho)o(w)f(man)o(y)h
(objects)e(in)i(the)g(arena)e(are)i(currently)f(ali)o(v)o(e.)22
b(Objects)11 b(in)h(the)1020 1326 y(arena)i(ha)o(v)o(e)g(no)h(per)o(-object)g
(o)o(v)o(erhead)f(for)h(tags,)h(sizes,)g(allocated/free)1020
1368 y(bits,)h(etc.)30 b(Allocation)14 b(in)h(a)g(short-li)o(v)o(ed)g(arena)f
(proceeds)f(as)h(follo)o(ws.)1020 1409 y(When)f(a)h(ne)o(w)g(arena)f(is)h
(selected,)g(the)f(count)h(\256eld)f(is)h(set)g(to)g(zero)f(and)1020
1451 y(the)i(alloc)h(pointer)f(is)h(set)f(to)h(the)f(base)f(of)i(the)g
(arena.)32 b(Each)14 b(time)i(an)1020 1492 y(object)f(is)h(allocated,)h(the)f
(follo)o(wing)g(e)o(v)o(ents)f(occur)n(.)33 b(First,)19 b(the)d(alloc)1020
1534 y(pointer)9 b(is)g(checked)d(to)k(see)e(if)i(the)f(arena)f(contains)f
(enough)h(space)f(for)j(the)1020 1575 y(request.)15 b(If)c(it)g(does,)e(the)h
(count)f(\256eld)h(is)g(incremented,)f(the)h(alloc)f(pointer)1020
1617 y(is)h(incremented,)e(and)h(the)g(associated)e(space)h(is)h(returned.)14
b(If)d(there)e(is)h(not)1020 1658 y(enough)d(space,)g(the)h(algorithm)h
(scans)d(all)j(short-li)o(v)o(ed)g(arenas)e(attempting)1020
1700 y(to)12 b(\256nd)f(one)g(with)h(a)g(zero)f(count)g(\256eld)g
(\(indicating)h(no)f(li)o(v)o(e)i(objects\).)20 b(If)1020 1741
y(one)10 b(is)h(found,)g(its)g(alloc)g(pointer)g(to)g(reset)f(to)i(the)e
(base)g(of)h(the)f(arena)g(and)1020 1783 y(allocation)f(proceeds.)j(If)f(one)
d(cannot)g(be)h(found,)g(the)g(object)g(is)g(allocated)1020
1824 y(as)i(if)i(it)g(were)f(long-li)o(v)o(ed.)22 b(T)m(o)12
b(perform)g(a)g(free,)h(this)f(algorithm)h(simply)1020 1866
y(decrements)8 b(the)h(count)f(\256eld)h(in)g(the)g(object')n(s)g(arena.)1076
1920 y(The)e(algorithm)h(requires)f(that)h(we)f(distinguish)g(allocations)g
(and)g(deal-)1020 1961 y(locations)14 b(of)h(arena)g(objects)f(and)g(objects)
g(in)h(the)g(general)f(heap.)30 b(F)o(or)1020 2003 y(deallocations,)9
b(the)g(address)f(of)i(the)g(object)f(gi)o(v)o(es)h(this)g(information)g
(\(and)1020 2044 y(which)d(arena\))g(because)e(arenas)h(are)i(contiguous)e
(and)g(not)i(part)g(of)g(the)f(gen-)1020 2086 y(eral)j(allocation)e(heap.)13
b(F)o(or)d(allocations,)f(the)g(presence)e(of)j(the)f(allocation)1020
2127 y(site)14 b(in)f(the)h(short-li)o(v)o(ed)g(site)f(database)f(indicates)g
(an)h(arena)g(allocation.)1020 2169 y(Because)h(the)h(number)g(of)i(short-li)
o(v)o(ed)f(allocation)f(sites)h(is)g(small,)i(the)1020 2210
y(database)9 b(may)h(be)g(maintained)g(as)g(a)g(small)h(hash-table.)17
b(The)10 b(allocation)1020 2252 y(site)d(is)h(encoded)d(as)i(an)f(inte)o(ger)
i(that)g(is)f(used)f(to)i(inde)o(x)f(into)g(the)g(hash-table.)1076
2306 y(W)m(e)j(propose)f(two)h(alternati)o(v)o(es)g(to)g(determining)g(the)g
(allocation)g(site.)1020 2347 y(The)d(measurements)f(in)i(T)m(able)f(6)g
(suggest)g(that)h(e)o(xclusi)o(v)o(e-ORing)f(the)g(size)1020
2389 y(with)k(the)e(last)i(four)f(return)g(addresses)e(should)g(yield)i
(results)g(comparable)1020 2430 y(to)i(using)f(the)g(entire)h(call-chain.)21
b(As)11 b(an)g(alternati)o(v)o(e)h(to)g(calculating)f(the)1020
2472 y(callers)6 b(at)g(each)g(allocation,)f(Carter)h([3)q(])g(suggests)g
(the)g(follo)o(wing)g(approach)p 1020 2552 399 2 v 1060 2577
a Fj(1)1072 2589 y Fi(Objects)h(lar)o(ger)g(than)f(a)h(speci\256c)g(size)h
(are)f(allocated)f(by)g(the)h(general)f(purpose)f(allocator)n(.)p
eop
%%Page: 7 7
7 6 bop 577 592 787 2 v 576 633 2 42 v 770 633 V 827 621 a
Fm(Actual)p 982 633 V 91 w(Predicted)p 1193 633 V 82 w(Sites)p
1363 633 V 576 675 V 610 662 a(Program)p 770 675 V 54 w(Short-li)o(v)o(ed)p
982 675 V 46 w(Short-li)o(v)o(ed)p 1193 675 V 45 w(Used)8 b(T)m(o)p
1363 675 V 576 716 V 770 716 V 802 704 a(Bytes)g(\(\045\))p
982 716 V 62 w(Bytes)g(\(\045\))p 1193 716 V 64 w(Predict)p
1363 716 V 577 718 787 2 v 576 759 2 42 v 600 747 a(C)p Fh(FRA)o(C)p
770 759 V 146 w Fm(100)p 982 759 V 173 w(0)p 1193 759 V 171
w(5)p 1363 759 V 576 801 V 600 789 a(E)p Fh(SPRESSO)p 770 801
V 107 w Fm(91)p 982 801 V 174 w(19)p 1193 801 V 143 w(177)p
1363 801 V 576 842 V 600 830 a(G)p Fh(A)m(WK)p 770 842 V 162
w Fm(98)p 982 842 V 183 w(5)p 1193 842 V 162 w(64)p 1363 842
V 576 884 V 600 872 a(G)p Fh(HOST)p 770 884 V 152 w Fm(97)p
982 884 V 174 w(36)p 1193 884 V 143 w(106)p 1363 884 V 576
926 V 600 913 a(P)p Fh(ERL)p 770 926 V 181 w Fm(99)p 982 926
V 174 w(29)p 1193 926 V 152 w(26)p 1363 926 V 577 927 787 2
v -76 999 a(T)m(able)i(5:)15 b(Fraction)10 b(of)h(total)g(bytes)e(predicted)g
(as)h(being)f(short-li)o(v)o(ed)i(based)e(only)h(upon)f(object)g(size)h(in)g
(each)f(of)i(\256v)o(e)f(programs.)16 b(Self)11 b(prediction)e(is)i(used)-76
1040 y(in)g(this)g(table.)19 b(The)10 b(Actual,)h(Predicted,)g(and)f(Sites)h
(columns)f(are)g(as)g(in)i(T)m(able)e(4.)18 b(As)11 b(the)f(table)h(sho)o
(ws,)f(size)h(information)g(alone)f(predicts)g(only)h(a)f(small)-76
1082 y(fraction)g(of)f(the)g(objects)f(as)h(being)f(short-li)o(v)o(ed.)p
178 1208 1585 2 v 177 1250 2 42 v 222 1237 a(Call)p 328 1250
V 137 w(C)p Fh(FRA)o(C)p 615 1250 V 160 w Fm(E)p Fh(SPRESSO)p
901 1250 V 163 w Fm(G)p Fh(A)m(WK)p 1188 1250 V 186 w Fm(G)p
Fh(HOST)p 1475 1250 V 195 w Fm(P)p Fh(ERL)p 1762 1250 V 329
1251 1434 2 v 177 1291 2 42 v 209 1279 a Fm(Chain)p 328 1291
V 52 w(Pred.)p 450 1291 V 70 w(Ne)o(w)p 615 1291 V 69 w(Pred.)p
737 1291 V 69 w(Ne)o(w)p 901 1291 V 70 w(Pred.)p 1024 1291
V 69 w(Ne)o(w)p 1188 1291 V 69 w(Pred.)p 1311 1291 V 70 w(Ne)o(w)p
1475 1291 V 69 w(Pred.)p 1598 1291 V 70 w(Ne)o(w)p 1762 1291
V 177 1333 V 200 1320 a(Length)p 328 1333 V 55 w(\(\045\))p
450 1333 V 57 w(Ref.\(\045\))p 615 1333 V 57 w(\(\045\))p 737
1333 V 56 w(Ref.\(\045\))p 901 1333 V 58 w(\(\045\))p 1024
1333 V 56 w(Ref.\(\045\))p 1188 1333 V 57 w(\(\045\))p 1311
1333 V 57 w(Ref.\(\045\))p 1475 1333 V 57 w(\(\045\))p 1598
1333 V 57 w(Ref.\(\045\))p 1762 1333 V 178 1335 1585 2 v 177
1376 2 42 v 200 1364 a(1)p 328 1376 V 152 w(48)p 450 1376 V
106 w(52)p 615 1376 V 93 w(\(41\))p 737 1376 V 103 w(7)p 901
1376 V 115 w(72)p 1024 1376 V 105 w(26)p 1188 1376 V 106 w(40)p
1311 1376 V 105 w(13)p 1475 1376 V 105 w(31)p 1598 1376 V 106
w(23)p 1762 1376 V 177 1418 V 200 1405 a(2)p 328 1418 V 140
w(\(76\))p 450 1418 V 94 w(66)p 615 1418 V 105 w(41)p 737 1418
V 115 w(7)p 901 1418 V 115 w(78)p 1024 1418 V 105 w(29)p 1188
1418 V 106 w(40)p 1311 1418 V 105 w(13)p 1475 1418 V 105 w(63)p
1598 1418 V 106 w(33)p 1762 1418 V 177 1459 V 200 1447 a(3)p
328 1459 V 152 w(82)p 450 1459 V 106 w(70)p 615 1459 V 105
w(41)p 737 1459 V 115 w(8)p 901 1459 V 102 w(\(99\))p 1024
1459 V 94 w(43)p 1188 1459 V 106 w(47)p 1311 1459 V 105 w(14)p
1475 1459 V 105 w(63)p 1598 1459 V 106 w(33)p 1762 1459 V 177
1501 V 200 1488 a(4)p 328 1501 V 152 w(82)p 450 1501 V 106
w(70)p 615 1501 V 105 w(42)p 737 1501 V 115 w(8)p 901 1501
V 115 w(99)p 1024 1501 V 105 w(43)p 1188 1501 V 93 w(\(75\))p
1311 1501 V 94 w(31)p 1475 1501 V 93 w(\(91\))p 1598 1501 V
94 w(44)p 1762 1501 V 177 1542 V 200 1530 a(5)p 328 1542 V
152 w(82)p 450 1542 V 106 w(70)p 615 1542 V 105 w(42)p 737
1542 V 115 w(8)p 901 1542 V 115 w(99)p 1024 1542 V 105 w(43)p
1188 1542 V 106 w(80)p 1311 1542 V 105 w(37)p 1475 1542 V 105
w(94)p 1598 1542 V 106 w(45)p 1762 1542 V 177 1584 V 200 1571
a(6)p 328 1584 V 152 w(82)p 450 1584 V 106 w(70)p 615 1584
V 105 w(43)p 737 1584 V 115 w(9)p 901 1584 V 115 w(99)p 1024
1584 V 105 w(43)p 1188 1584 V 106 w(80)p 1311 1584 V 105 w(37)p
1475 1584 V 105 w(94)p 1598 1584 V 106 w(45)p 1762 1584 V 177
1625 V 200 1613 a(7)p 328 1625 V 152 w(82)p 450 1625 V 106
w(70)p 615 1625 V 105 w(44)p 737 1625 V 115 w(9)p 901 1625
V 115 w(99)p 1024 1625 V 105 w(43)p 1188 1625 V 106 w(81)p
1311 1625 V 105 w(38)p 1475 1625 V 105 w(95)p 1598 1625 V 106
w(45)p 1762 1625 V 178 1627 1585 2 v 177 1668 2 42 v 200 1656
a Fg(1)p 328 1668 V 133 w Fm(82)p 450 1668 V 106 w(70)p 615
1668 V 105 w(42)p 737 1668 V 115 w(8)p 901 1668 V 115 w(99)p
1024 1668 V 105 w(43)p 1188 1668 V 106 w(81)p 1311 1668 V 105
w(38)p 1475 1668 V 105 w(92)p 1598 1668 V 106 w(44)p 1762 1668
V 178 1670 1585 2 v -76 1741 a(T)m(able)k(6:)20 b(Ef)o(fect)13
b(of)g(call-chain)e(length)h(on)g(short-li)o(v)o(ed)h(object)f(prediction.)23
b(This)12 b(table)h(sho)o(ws)e(ho)o(w)h(the)g(fraction)h(of)f(total)i(bytes)d
(predicted)h(as)f(being)-76 1782 y(short-li)o(v)o(ed)d(changes)t(as)f(more)g
(callers)g(in)g(the)g(call-chain)g(are)g(considered.)k(Self)c(prediction)g
(is)g(used)f(in)h(this)g(table.)13 b(The)7 b(predicti)o(v)o(e)g(ability)h(of)
f(the)g(call-chain)-76 1824 y(increases)g(with)i(the)f(number)g(of)g
(callers.)13 b(The)8 b(numbers)f(in)i(parentheses)d(indicate)i(the)g(length)g
(at)g(which)g(an)g(abrupt)g(impro)o(v)o(ement)h(in)f(prediction)g(occurred.)
-76 1865 y(The)i(Ne)o(w)h(Ref)g(columns)f(indicate)g(the)h(predicted)f
(fraction)i(of)f(total)g(heap)f(references)g(to)h(the)g(short-li)o(v)o(ed)g
(objects.)18 b(The)11 b Fg(1)g Fm(case)e(corresponds)g(to)i(using)-76
1907 y(the)e(complete)g(call-chain.)k(Note)c(that)h(in)g(some)e(cases,)g(the)
h Fg(1)h Fm(case)d(predicts)i(less)g(than)g(the)g(length-7)g(chain)f(\(e.g.,)
i(E)p Fh(SPRESSO)p Fm(\).)j(This)c(occurs)f(because)f(we)-76
1948 y(perform)j(recursi)o(v)o(e)f(loop)f(elimination)i(in)f(the)g(complete)g
(site)g(case)e(and)i(not)g(in)g(the)g(length-N)g(case.)p eop
%%Page: 8 8
8 7 bop -76 -34 a Fm(that)9 b(we)g(call)g Fk(call-c)o(hain)h(encryption)p
Fm(.)h(F)o(or)f(each)e(function)g(in)i(a)f(program,)-76 7 y(assign)j(a)h
(16-bit)h(id)193 -9 y Ff(2)207 7 y Fm(.)26 b(At)14 b(each)e(function)h(call,)
i(create)d(an)h(ne)o(w)g(ke)o(y)f(by)-76 49 y(XORing)g(the)h(current)f
(function')n(s)g(id)h(with)g(the)f(ke)o(y)g(of)g(the)h(caller)n(.)23
b(The)-76 90 y(function)15 b(ids)h(should)e(be)h(selected)f(so)h(that)g(the)h
(resulting)f(ke)o(ys)f(being)-76 132 y(generated)d(by)h(call-chains)f(are)h
(likely)h(to)f(be)g(unique;)i(static)e(call-graph)-76 173 y(analysis)6
b(may)g(be)h(used)e(to)i(determine)g(the)g(best)f(ids.)13 b(The)6
b(o)o(v)o(erhead)g(of)h(this)-76 215 y(approach)g(is)i(distrib)o(uted)h(o)o
(v)o(er)f(all)h(function)f(calls,)g(b)o(ut)g(would)f(result)i(in)f(a)-76
256 y(small)f(number)f(of)h(additional)f(instructions)g(per)h(function)f
(call)h(\(load)g(from)-76 298 y(caller')n(s)13 b(stack,)f(XOR)g(with)h(the)f
(function')n(s)g(id,)i(and)e(store)g(into)g(callee')n(s)-76
339 y(stack\).)-20 393 y(W)m(e)7 b(modeled)e(the)h(CPU)h(cost)f(of)h(each)e
(of)h(these)g(methods)f(by)h(multiply-)-76 435 y(ing)j(the)g(instruction)h
(count)e(for)i(each)e(by)h(the)g(number)g(of)g(allocations)f(and)-76
476 y(function)j(calls)h(respecti)o(v)o(ely)n(.)19 b(On)12
b(a)f(RISC-style)h(architecture,)g(such)e(as)-76 518 y(SP)m(ARC,)g(we)g
(estimate)g(that)h(the)f(length-4)h(call-chain)f(can)f(be)h(computed)-76
559 y(in)i(10)e(instructions.)19 b(T)m(wo)11 b(assumptions)e(are)i(necessary)
d(to)k(achie)o(v)o(e)d(this)-76 601 y(count.)18 b(First,)12
b(we)e(assume)f(that)i(a)g(pointer)f(to)h(the)g(pre)o(vious)f(stack)f(frame)
-76 642 y(is)15 b(stored)f(in)h(e)o(v)o(ery)f(frame.)30 b(Compiler)15
b(optimizations)g(that)f(eliminate)-76 684 y(this)8 b(frame-pointer)h(will)g
(increase)d(the)i(cost)f(of)i(determining)e(a)h(function')n(s)-76
725 y(callers.)24 b(F)o(ortunately)n(,)14 b(the)f(SP)m(ARC)f(architecture,)h
(with)h(b)o(uilt-in)g(re)o(gis-)-76 767 y(ter)e(windo)o(ws,)e(eliminates)h
(this)g(problem.)19 b(The)10 b(second)f(assumption)g(we)-76
808 y(make)f(is)h(that)g(the)g(C)g Fe(crt0)h Fm(routine)f(pushes)e(three)i
(dummy)f(stack)g(frames)-76 850 y(on)i(the)g(stack)f(so)h(that)h(the)f(last)g
(four)h(callers)f(are)g(always)f(a)o(v)o(ailable.)16 b(This)-76
891 y(optimization)9 b(eliminates)g(checks)e(for)j(the)f(bottom)g(of)h(the)f
(stack.)-20 945 y(W)m(e)i(further)h(estimate)f(that)g(the)g(determination)g
(of)g(whether)f(an)h(allo-)-76 987 y(cation)e(is)g(short-li)o(v)o(ed)h(takes)
d(approximately)i(18)f(instructions,)h(including)-76 1028 y(the)g(10)g(to)g
(determine)g(the)g(length-4)g(call-chain.)-20 1082 y(In)h(contrast,)f(to)g
(compute)f(the)i(per)o(-allocation)f(cost)f(of)i(call-chain)f(en-)-76
1124 y(cryption,)k(we)f(take)f(the)g(total)i(number)e(of)i(function)e(calls)h
(in)g(a)g(program)-76 1165 y(e)o(x)o(ecution)e(and)f(multiply)i(by)e(the)h
(cost)g(per)g(call)g(\(we)g(estimate)g(3)g(instruc-)-76 1207
y(tions\))e(and)e(then)h(di)o(vide)h(by)f(the)g(total)h(number)f(of)g
(allocations.)13 b(While)7 b(this)-76 1248 y(cost)k(is)g(program)g
(dependent,)e(we)i(observ)o(e)f(it)i(to)f(range)f(from)i(9)f(instruc-)-76
1290 y(tions)i(to)g(94)g(instructions)g(per)g(allocation)f(in)i(the)f
(programs)f(measured.)-76 1331 y(A)g(complete)f(comparison)f(of)i(the)f(CPU)g
(o)o(v)o(erhead)g(of)h(this)f(algorithm)i(is)-76 1373 y(presented)8
b(in)h(T)m(able)f(9.)-76 1481 y Fn(5.2)41 b(The)14 b(Simulation)-76
1561 y Fm(W)m(e)7 b(measured)f(the)g(performance)g(of)i(the)e(test)h
(programs)g(with)g(the)g(lifetime)-76 1602 y(prediction)h(algorithm)h(using)e
(trace-dri)o(v)o(en)i(simulation.)k(T)m(o)8 b(measure)f(the)-76
1644 y(performance)f(of)g(a)g(program,)g(we)g(fed)g(a)g(trace)g(of)g(the)g
(program')n(s)g(allocation)-76 1685 y(e)o(v)o(ents)g(and)g(a)h(list)g(of)g
(short-li)o(v)o(ed)h(sites)e(into)h(a)g(simulator)g(of)g(the)g(prediction)-76
1727 y(algorithm.)17 b(The)10 b(allocation)g(e)o(v)o(ent)f(included)g(the)i
(lifetime,)h(size,)e(and)f(an)-76 1768 y(identi\256er)h(corresponding)e(to)i
(the)f(complete)g(call-chain)g(and)g(size)g(of)h(that)-76 1810
y(allocation.)32 b(The)15 b(output)h(of)f(the)h(simulator)g(gi)o(v)o(es)f
(operation)g(counts,)-76 1851 y(information)h(about)f(the)g(fraction)h(of)g
(objects)f(and)f(bytes)h(allocated)f(in)-76 1893 y(arenas,)8
b(heap)g(size,)h(and)f(fragmentation)h(measurements.)-20 1947
y(In)i(our)g(e)o(xperiments,)f(we)h(compare)e(the)h(performance)g(of)h(a)f
(lifetime)-76 1988 y(predicting)d(arena-allocator)f(with)i(a)f(relati)o(v)o
(ely)h(simple)f(\256rst-\256t)h(algorithm)-76 2030 y(with)h(enhancements)c
(described)i(by)h(Knuth)g([13)o(].)14 b(W)m(e)9 b(chose)d(to)j(compare)-76
2071 y(the)e(arena)g(allocator)g(with)h(the)g(\256rst-\256t)g(algorithm)g
(for)g(two)f(reasons.)12 b(First,)-76 2113 y(the)g(\256rst-\256t)i(allocator)
e(often)h(has)e(relati)o(v)o(ely)i(good)f(memory)g(utilization)-76
2154 y(characteristics,)e(and)f(as)g(such)g(serv)o(es)g(as)g(a)h(fair)g
(baseline)f(for)i(comparing)-76 2196 y(the)f(memory)f(usage)e(of)j(the)g
(arena)e(allocator)n(.)15 b(Second,)8 b(the)h(\256rst-\256t)i(algo-)-76
2237 y(rithm)i(is)e(used)f(by)h(the)g(arena)f(allocator)h(for)h(non-arena)e
(objects.)19 b(In)11 b(this)-76 2279 y(way)n(,)d(the)g(\256rst-\256t)h
(algorithm)g(becomes)d(the)i(de)o(generate)f(case)g(of)i(an)f(arena)-76
2320 y(allocator)i(that)g(allocates)f(no)h(objects)f(in)h(arenas.)15
b(In)10 b(all)h(simulations,)f(we)-76 2362 y(present)e(the)h(results)g(of)h
(true)f(prediction.)-20 2416 y(T)m(able)j(7)h(sho)o(ws)e(ho)o(w)h(ef)o(fecti)
o(v)o(ely)h(the)g(algorithm)g(was)e(able)h(to)h(rec-)-76 2457
y(ognize)d(short-li)o(v)o(ed)i(objects.)19 b(In)12 b(all)g(cases,)e(the)h
(total)h(space)d(de)o(v)o(oted)h(to)p -76 2538 399 2 v -36
2562 a Fj(2)-24 2575 y Fi(W)n(e)c(use)f(16-bit)s(ids)g(because)t(existing)t
(hardware,)t(such)t(as)h(the)t(MIPS)f(R3000)t(architecture,)-76
2608 y(supports)h(16-bit)g(immediate)g(constants.)1020 -34
y Fm(arenas)k(was)g(64)h(kilobytes,)h(twice)f(the)h(age)e(of)i(the)f(objects)
g(predicted)f(as)1020 7 y(short-li)o(v)o(ed)j(by)g(the)g(predictor)n(.)24
b(This)13 b(size)f(was)g(chosen)f(with)i(the)g(intu-)1020 49
y(ition)i(that)f(by)f(the)h(time)h(the)e(last)i(half)f(of)g(the)g(64)f
(kilobytes)g(are)h(\256lled,)1020 90 y(we)c(are)g(con\256dent)e(that)i
(objects)f(in)h(the)g(\256rst)g(half)h(of)f(the)g(arena)f(are)g(dead,)1020
132 y(and)j(thus)h(the)g(space)e(in)i(the)g(\256rst)h(half)f(can)f(be)h
(re-used.)24 b(Furthermore,)1020 173 y(the)12 b(64-kilobyte)f(arena)g(area)g
(was)f(di)o(vided)h(into)i(16)e(distinct)h(4-kilobyte)1020
215 y(arenas.)j(This)9 b(blocking)g(reduces)f(the)i(space)e(consumed)f(by)j
(erroneously)1020 256 y(predicted)j(long-li)o(v)o(ed)g(objects)g(that)h(tie)g
(up)f(the)g(entire)h(arena)e(in)i(which)1020 298 y(the)o(y)9
b(are)g(allocated.)1076 352 y(T)m(able)j(7)g(should)g(be)g(compared)f
(directly)h(with)i(T)m(able)d(4.)24 b(The)12 b(frac-)1020 393
y(tion)f(of)f(bytes)g(allocated)f(in)h(arenas)f(corresponds)f(v)o(ery)i
(closely)g(with)h(the)1020 435 y(predicted)h(short-li)o(v)o(ed)i(bytes)e(sho)
o(wn)g(in)h(T)m(able)f(4.)25 b(There)13 b(are)g(two)g(no-)1020
476 y(table)g(e)o(xceptions,)h(namely)e(G)p Fh(HOST)h Fm(and)g(C)p
Fh(FRA)o(C)p Fm(.)25 b(In)14 b(G)p Fh(HOST)p Fm(,)g(we)g(see)1020
518 y(that)d(while)g(the)g(fraction)g(of)g(arena)f(objects)g(is)h(high)f
(\(80\045\),)i(the)f(fraction)1020 559 y(of)i(arena)e(bytes)h(is)g(much)g
(smaller)g(\(only)h(38\045\).)23 b(This)12 b(occurs)f(because)1020
601 y(G)p Fh(HOST)f Fm(allocates)g(about)g(5000)f(6-kilobyte)i(short-li)o(v)o
(ed)g(objects.)18 b(These)1020 642 y(objects)5 b(cannot)g(be)h(allocated)f
(in)h(the)g(4-kilobyte)g(arenas)t(and)g(are)f(allocated)1020
684 y(in)k(the)g(general)g(heap)f(instead.)1076 738 y(C)p Fh(FRA)o(C)g
Fm(sho)o(ws)f(what)i(happens)e(to)i(this)g(algorithm)g(if)h(too)f(man)o(y)f
(long-)1020 779 y(li)o(v)o(ed)14 b(objects)f(are)h(erroneously)f(predicted)g
(to)h(be)f(short-li)o(v)o(ed.)29 b(Recall)1020 821 y(that)13
b(3.65\045)f(of)g(the)h(objects)e(in)i(C)p Fh(FRA)o(C)e Fm(were)h
(incorrectly)h(predicted)e(as)1020 862 y(short-li)o(v)o(ed.)16
b(Furthermore,)10 b(empirical)g(measurements)e(of)i(C)p Fh(FRA)o(C)e
Fm(sho)o(w)1020 904 y(that)16 b(the)g(object)g(lifetime)i(distrib)o(ution)e
(is)h(v)o(ery)f(highly)g(ske)o(wed)e([23].)1020 945 y(That)d(is,)g(while)h
(the)e(v)o(ast)h(majority)g(of)g(objects)f(allocated)g(by)h(C)p
Fh(FRA)o(C)f Fm(are)1020 987 y(v)o(ery)e(short-li)o(v)o(ed,)i(some)d(objects)
h(it)h(allocates)e(are)h(e)o(xtremely)h(long-li)o(v)o(ed.)1020
1028 y(Therefore,)f(objects)f(incorrectly)i(predicted)e(as)h(short-li)o(v)o
(ed)g(may)g(actually)1020 1070 y(be)k(v)o(ery)g(long-li)o(v)o(ed.)24
b(These)11 b(objects)g(then)h(tie)h(up)f(all)h(the)f(arenas)f(\()p
Fk(pol-)1020 1111 y(luting)k Fm(the)f(arenas\),)h(forcing)f(the)g(arena)f
(allocator)h(to)h(de)o(generate)d(to)j(a)1020 1153 y(general-purpose)7
b(allocator)n(.)14 b(W)m(e)9 b(speculate)e(that)j(this)f(is)g(what)g
(happened)1020 1194 y(in)i(C)p Fh(FRA)o(C)p Fm(,)g(although)f(its)i(poor)f
(performance)f(requires)g(more)h(in)o(v)o(estiga-)1020 1236
y(tion.)j(High)9 b(error)g(rates)g(de)o(grade)e(performance)h(dramatically)h
(and)e(it)j(will)1020 1277 y(be)d(important)h(to)f(identify)h(programs)e
(that)i(e)o(xhibit)g(them,)g(such)e(as)g(C)p Fh(FRA)o(C)p Fm(,)1020
1319 y(during)j(training.)14 b(Lifespan)9 b(prediction)g(may)f(be)h
(inappropriate)g(for)h(such)1020 1360 y(programs.)1076 1414
y(T)m(able)d(8)g(sho)o(ws)f(the)h(ef)o(fect)h(of)g(arena)e(allocation)h(upon)
g(the)g(total)h(mem-)1020 1456 y(ory)g(consumed)d(by)i(each)f(program.)13
b(F)o(or)8 b(programs)f(that)h(use)f(only)g(a)g(small)1020
1497 y(amount)g(of)h(memory)n(,)g(the)g(arena)f(algorithm)h(consumed)e(more)i
(space.)j(F)o(or)1020 1539 y(G)p Fh(HOST)p Fm(,)d(which)g(uses)g(much)f(more)
i(memory)f(than)g(the)h(other)f(programs,)h(a)1020 1580 y(sa)o(vings)g(of)h
(28\26148\045)f(was)g(realized.)15 b(T)m(able)10 b(8)g(also)f(compares)f(the)
i(ef)o(fec-)1020 1622 y(ti)o(v)o(eness)f(of)h(true)g(prediction)g(with)g
(self)g(prediction.)15 b(In)10 b(most)g(cases,)e(true)1020
1663 y(prediction)k(results)g(in)g(the)g(same)f(heap)f(size)i(as)f(self)h
(prediction.)22 b(In)13 b(the)1020 1705 y(G)p Fh(HOST)c Fm(program)h(ho)o(we)
o(v)o(er)o(,)g(true)g(prediction)g(increased)f(heap)f(size)i(rela-)1020
1746 y(ti)o(v)o(e)h(to)g(self)g(prediction,)g(b)o(ut)g(still)h(reduced)d
(heap)h(size)g(by)g(28\045)g(o)o(v)o(er)i(the)1020 1788 y(standard)7
b(\256rst-\256t)h(algorithm.)14 b(W)m(e)8 b(feel)g(con\256dent)e(that)i(in)g
(programs)f(with)1020 1830 y(lar)o(ge)13 b(heaps,)e(lifetime)j(prediction)e
(will)h(be)f(v)o(ery)g(ef)o(fecti)o(v)o(e)h(in)g(reducing)1020
1871 y(total)d(heap)e(size.)1076 1925 y(T)m(able)13 b(9)g(sho)o(ws)f(the)h(a)
o(v)o(erage)f(number)h(of)h(instructions)f(to)g(allocate)1020
1967 y(and)g(free)h(objects)f(in)h(four)h(allocation)e(algorithms.)28
b(The)13 b(numbers)g(for)1020 2008 y(the)d(\256rst)h(two)f(algorithms)g(\()p
Fh(BSD)g Fm(and)f(First-\256t\))j(were)e(computed)f(directly)1020
2050 y(from)i(actual)f(implementations)f(using)g(the)h(Q)p
Fh(P)g Fm([1)q(])g(instruction)h(pro\256ling)1020 2091 y(tool.)17
b(The)10 b(numbers)f(for)i(the)f(Arena)g(algorithms)g(were)h(computed)d
(using)1020 2133 y(operation)h(counts)f(\(e.g.,)i(allocations,)f(frees,)h
(etc\),)g(multiplying)g(them)f(by)1020 2174 y(the)i(estimated)g(cost)g(per)h
(operation.)19 b(In)12 b(general,)g(e)o(v)o(en)f(though)f(an)h(esti-)1020
2216 y(mated)g(18)f(instructions)h(are)g(e)o(xpended)d(to)k(predict)f(object)
f(lifetime,)j(this)1020 2257 y(o)o(v)o(erhead)8 b(is)h(a)g(relati)o(v)o(ely)g
(small)h(fraction)f(of)g(the)g(total)g(cost)g(of)g(allocation)1020
2299 y(plus)g(deallocation)f(in)h(the)g(B)p Fh(SD)f Fm(and)h(First-\256t)h
(allocators.)1076 2353 y(W)m(e)c(see)g(from)g(the)g(table)g(that)g(the)g(ef)o
(fecti)o(v)o(eness)g(o)o(f)g(lifetime)g(prediction)1020 2394
y(translates)k(directly)h(into)g(increased)e(CPU)i(performance.)18
b(F)o(or)11 b(e)o(xample,)1020 2436 y(G)p Fh(A)m(WK)p Fm(,)h(in)g(which)f
(lifetime)i(prediction)e(was)g(highly)g(successful,)f(sho)o(ws)1020
2477 y(v)o(ery)j(lo)o(w)g(CPU)f(o)o(v)o(erheads.)23 b(C)p Fh(FRA)o(C)p
Fm(,)12 b(on)g(the)h(other)f(hand,)h(which)f(suf-)1020 2519
y(fers)f(from)h(signi\256cant)d(prediction)i(errors)g(resulting)g(in)g(arena)
f(pollution,)1020 2560 y(sho)o(ws)e(the)h(poorest)g(CPU)g(performance.)14
b(It)c(is)f(clear)h(from)g(the)f(table)g(that)1020 2602 y(lifetime)j
(prediction)d(has)g(a)h(mix)o(ed)g(ef)o(fect)h(on)f(CPU)f(performance;)h(it)h
(can)p eop
%%Page: 9 9
9 8 bop 553 353 1029 2 v 552 393 2 42 v 951 380 a Fm(T)o(rue)9
b(Prediction)p 1581 393 V 359 394 1223 2 v 358 436 2 42 v 392
423 a(Program)p 552 436 V 79 w(T)m(otal)p 722 436 V 72 w(Arena)p
864 436 V 47 w(Non-arena)p 1066 436 V 71 w(T)m(otal)p 1242
436 V 72 w(Arena)p 1378 436 V 44 w(Non-arena)p 1581 436 V 358
477 V 552 477 V 589 465 a(Allocs)p 722 477 V 58 w(Allocs)p
864 477 V 74 w(Allocs)p 1066 477 V 97 w(Bytes)p 1242 477 V
70 w(Bytes)p 1378 477 V 84 w(Bytes)p 1581 477 V 358 519 V 552
519 V 575 506 a(\(1000')n(s\))p 722 519 V 66 w(\(\045\))p 864
519 V 117 w(\(\045\))p 1066 519 V 97 w(\(Kbytes\))p 1242 519
V 62 w(\(\045\))p 1378 519 V 114 w(\(\045\))p 1581 519 V 359
520 1223 2 v 358 562 2 42 v 382 549 a(C)p Fh(FRA)o(C)p 552
562 V 101 w Fm(3809.2)p 722 562 V 80 w(2.6)p 864 562 V 116
w(97.4)p 1066 562 V 109 w(63472)p 1242 562 V 84 w(1.8)p 1378
562 V 113 w(98.2)p 1581 562 V 358 603 V 382 591 a(E)p Fh(SPRESSO)p
552 603 V 53 w Fm(1654.2)p 722 603 V 71 w(19.1)p 864 603 V
106 w(80.9)p 1066 603 V 100 w(102423)p 1242 603 V 65 w(18.2)p
1378 603 V 103 w(81.8)p 1581 603 V 358 645 V 382 633 a(G)p
Fh(A)m(WK)p 552 645 V 108 w Fm(4273.0)p 722 645 V 71 w(98.2)p
864 645 V 116 w(1.8)p 1066 645 V 109 w(163401)p 1242 645 V
65 w(99.3)p 1378 645 V 113 w(0.7)p 1581 645 V 358 686 V 382
674 a(G)p Fh(HOST)p 552 686 V 108 w Fm(924.1)p 722 686 V 80
w(81.3)p 864 686 V 106 w(18.7)p 1066 686 V 109 w(87567)p 1242
686 V 75 w(37.7)p 1378 686 V 103 w(62.3)p 1581 686 V 358 728
V 382 716 a(P)p Fh(ERL)p 552 728 V 127 w Fm(1466.8)p 722 728
V 71 w(18.0)p 864 728 V 106 w(82.0)p 1066 728 V 109 w(32743)p
1242 728 V 75 w(20.5)p 1378 728 V 103 w(79.5)p 1581 728 V 359
730 1223 2 v -75 800 a(T)m(able)f(7:)14 b(Fraction)9 b(of)g(total)h(objects)e
(and)g(bytes)h(allocated)f(in)h(the)g(arena)f(and)h(the)g(non-arena)e(part)j
(of)f(the)g(heap)f(in)i(a)f(lifetime)h(predicting)f(arena)f(allocator)n(.)p
698 921 914 2 v 697 961 2 42 v 815 948 a(Self)h(Prediction)p
1154 961 V 229 w(T)o(rue)g(Prediction)p 1611 961 V 329 962
1284 2 v 328 1004 2 42 v 522 1004 V 554 991 a(First-\256t)p
697 1004 V 55 w(Arena)g(Alloc)p 926 1004 V 45 w(Arena)g(Alloc)p
1154 1004 V 44 w(Arena)g(Alloc)p 1383 1004 V 45 w(Arena)f(Alloc)p
1611 1004 V 328 1045 V 361 1033 a(Program)p 522 1045 V 81 w(Heap)p
697 1045 V 122 w(Heap)p 926 1045 V 143 w(Heap/)p 1154 1045
V 144 w(Heap)p 1383 1045 V 143 w(Heap/)p 1611 1045 V 328 1087
V 522 1087 V 578 1074 a(Size)p 697 1087 V 137 w(Size)p 926
1087 V 140 w(First-\256t)p 1154 1087 V 141 w(Size)p 1383 1087
V 140 w(First-\256t)p 1611 1087 V 328 1128 V 522 1128 V 545
1116 a(\(Kbytes\))p 697 1128 V 71 w(\(Kbytes\))p 926 1128 V
91 w(Heap)g(\(\045\))p 1154 1128 V 92 w(\(Kbytes\))p 1383 1128
V 91 w(Heap)g(\(\045\))p 1611 1128 V 329 1130 1284 2 v 328
1172 2 42 v 351 1159 a(C)p Fh(FRA)o(C)p 522 1172 V 166 w Fm(144)p
697 1172 V 107 w(208)p 926 1172 V 158 w(144.4)p 1154 1172 V
157 w(208)p 1383 1172 V 158 w(144.4)p 1611 1172 V 328 1213
V 351 1201 a(E)p Fh(SPRESSO)p 522 1213 V 118 w Fm(280)p 697
1213 V 107 w(344)p 926 1213 V 158 w(122.9)p 1154 1213 V 157
w(344)p 1383 1213 V 158 w(122.9)p 1611 1213 V 328 1255 V 351
1242 a(G)p Fh(A)m(WK)p 522 1255 V 191 w Fm(56)p 697 1255 V
108 w(112)p 926 1255 V 158 w(200.0)p 1154 1255 V 157 w(112)p
1383 1255 V 158 w(200.0)p 1611 1255 V 328 1296 V 351 1284 a(G)p
Fh(HOST)p 522 1296 V 144 w Fm(5584)p 697 1296 V 98 w(2896)p
926 1296 V 157 w(51.9)p 1154 1296 V 158 w(4048)p 1383 1296
V 157 w(72.5)p 1611 1296 V 328 1338 V 351 1325 a(P)p Fh(ERL)p
522 1338 V 210 w Fm(80)p 697 1338 V 108 w(144)p 926 1338 V
158 w(180.0)p 1154 1338 V 157 w(144)p 1383 1338 V 158 w(180.0)p
1611 1338 V 329 1339 1284 2 v -76 1410 a(T)m(able)j(8:)19 b(Maximum)11
b(heap)g(sizes)f(allocated)h(by)g(a)h(\256rst-\256t)h(allocator)e(and)g(a)h
(lifetime)h(predicting)e(arena)g(allocator)n(.)21 b(The)11
b(arena)g(heap)f(sizes)h(include)g(the)-76 1452 y(64-kilobyte)e(arena)f(area)
h(in)g(the)g(total.)p 1064 1572 643 2 v 1063 1612 2 42 v 1269
1599 a(T)o(rue)g(Prediction)p 1706 1612 V 234 1613 1473 2 v
233 1655 2 42 v 427 1655 V 554 1642 a(B)p Fh(SD)p 742 1655
V 230 w Fm(First-\256t)p 1063 1655 V 165 w(Arena)f(\(len-4\))p
1385 1655 V 133 w(Arena)h(\(cce\))p 1706 1655 V 233 1696 V
427 1696 V 511 1684 a(\(instr)h(per\))p 742 1696 V 170 w(\(instr)h(per\))p
1063 1696 V 173 w(\(instr)f(per\))p 1385 1696 V 173 w(\(instr)g(per\))p
1706 1696 V 234 1698 1473 2 v 233 1740 2 42 v 266 1727 a(Program)p
427 1740 V 55 w(alloc)p 544 1740 V 45 w(free)p 647 1740 V 44
w(a+f)p 742 1740 V 45 w(alloc)p 860 1740 V 45 w(free)p 963
1740 V 48 w(a+f)p 1063 1740 V 48 w(alloc)p 1181 1740 V 44 w(free)p
1284 1740 V 48 w(a+f)p 1385 1740 V 48 w(alloc)p 1502 1740 V
44 w(free)p 1605 1740 V 48 w(a+f)p 1706 1740 V 234 1741 1473
2 v 233 1783 2 42 v 256 1770 a(C)p Fh(FRA)o(C)p 427 1783 V
126 w Fm(52)p 544 1783 V 65 w(17)p 647 1783 V 57 w(69)p 742
1783 V 80 w(66)p 860 1783 V 65 w(64)p 963 1783 V 44 w(130)p
1063 1783 V 60 w(134)p 1181 1783 V 65 w(62)p 1284 1783 V 44
w(196)p 1385 1783 V 60 w(140)p 1502 1783 V 65 w(62)p 1605 1783
V 44 w(202)p 1706 1783 V 233 1824 V 256 1812 a(E)p Fh(SPRESSO)p
427 1824 V 78 w Fm(55)p 544 1824 V 65 w(17)p 647 1824 V 57
w(72)p 742 1824 V 80 w(65)p 860 1824 V 65 w(65)p 963 1824 V
44 w(130)p 1063 1824 V 79 w(76)p 1181 1824 V 65 w(55)p 1284
1824 V 44 w(130)p 1385 1824 V 79 w(84)p 1502 1824 V 65 w(55)p
1605 1824 V 44 w(139)p 1706 1824 V 233 1866 V 256 1853 a(G)p
Fh(A)m(WK)p 427 1866 V 133 w Fm(54)p 544 1866 V 65 w(17)p 647
1866 V 57 w(71)p 742 1866 V 80 w(56)p 860 1866 V 65 w(64)p
963 1866 V 44 w(120)p 1063 1866 V 79 w(29)p 1181 1866 V 65
w(11)p 1284 1866 V 63 w(40)p 1385 1866 V 79 w(29)p 1502 1866
V 65 w(11)p 1605 1866 V 63 w(39)p 1706 1866 V 233 1907 V 256
1895 a(G)p Fh(HOST)p 427 1907 V 123 w Fm(61)p 544 1907 V 65
w(17)p 647 1907 V 57 w(78)p 742 1907 V 61 w(165)p 860 1907
V 65 w(57)p 963 1907 V 44 w(222)p 1063 1907 V 79 w(58)p 1181
1907 V 65 w(18)p 1284 1907 V 63 w(76)p 1385 1907 V 60 w(142)p
1502 1907 V 65 w(18)p 1605 1907 V 44 w(160)p 1706 1907 V 233
1949 V 256 1936 a(P)p Fh(ERL)p 427 1949 V 152 w Fm(51)p 544
1949 V 65 w(17)p 647 1949 V 57 w(68)p 742 1949 V 80 w(70)p
860 1949 V 65 w(65)p 963 1949 V 44 w(136)p 1063 1949 V 79 w(82)p
1181 1949 V 65 w(55)p 1284 1949 V 44 w(137)p 1385 1949 V 60
w(120)p 1502 1949 V 65 w(55)p 1605 1949 V 44 w(175)p 1706 1949
V 234 1950 1473 2 v -76 2021 a(T)m(able)f(9:)14 b(A)m(v)o(erage)9
b(number)g(of)h(instructions)f(for)h(calls)f(to)h(allocate)f(and)g(free)h(in)
f(the)h(application)e(programs)h(using)g(dif)o(ferent)h(allocation)f
(algorithms.)15 b(The)-76 2063 y(numbers)9 b(for)j(B)p Fh(SD)d
Fm(and)h(First-\256t)i(were)e(measured)e(counting)i(instructions)g(in)g
(actual)g(implementations)g(with)h(the)f(Q)p Fh(P)g Fm(tool.)18
b(Arena)10 b(\(len-4\))h(indicates)f(the)-76 2104 y(cost)f(of)i(lifetime)g
(prediction)e(using)g(the)h(last)g(4)g(callers.)15 b(The)10
b(determination)f(of)h(the)g(length-4)g(caller)g(costs)e(10)i(instructions)f
(per)h(allocation.)15 b(Arena)10 b(\(cce\))-76 2146 y(indicates)f(the)h(per)f
(allocation)h(o)o(v)o(erhead)e(using)h(call-chain)h(encryption)e(and)h
(factoring)h(the)f(per)o(-call)i(call-chain)e(encryption)g(as)g(a)h(per)o
(-allocation)f(cost.)15 b(In)-76 2187 y(this)9 b(case,)f(the)h(encryption)g
(ke)o(y)f(costs)g(from)i(9)f(to)g(94)g(instructions)g(per)g(allocation)g(in)g
(the)g(programs)f(measured.)p eop
%%Page: 10 10
10 9 bop -76 -34 a Fm(impro)o(v)o(e)12 b(CPU)f(performance)f(signi\256cantly)
g(and)g(it)i(can)e(also)h(de)o(grade)f(it)-76 7 y(signi\256cantly)n(.)23
b(Based)11 b(on)i(these)e(results,)j(we)f(conclude)d(that)j(impro)o(v)o(ed)
-76 49 y(CPU)c(performance)f(is)i(not)f(the)g(primary)g(adv)o(antage)e(of)j
(this)f(approach.)-20 103 y(In)14 b(comparing)e(the)i(dif)o(ferent)g
(call-chain)f(identi\256cation)g(strate)o(gies,)-76 144 y(we)c(see)f(that)h
(the)g(length-4)g(arena)f(algorithm)h(was)f(usually)g(slightly)i(faster)-76
186 y(than)f(the)f(call-chain)h(encryption)f(arena)g(strate)o(gy)n(,)h(and)f
(in)h(one)f(case)g(twice)-76 227 y(as)i(fast.)18 b(This)11
b(suggests)d(that)j(a)g(space-speed)c(tradeof)o(f)k(may)g(be)f(possible)-76
269 y(by)f(selecting)g(one)g(or)h(another)f(of)h(the)f(algorithms)h
(depending)d(upon)i(ho)o(w)-76 310 y(ef)o(fecti)o(v)o(e)e(the)f(length-4)g
(algorithm)h(was)e(in)i(\256nding)e(short-li)o(v)o(ed)i(allocation)-76
352 y(sites.)-76 461 y Fn(6)41 b(Conclusions)-76 554 y Fm(Our)12
b(goal)e(is)i(to)f(impro)o(v)o(e)h(all)g(aspects)d(of)j(the)f(performance)f
(of)i(dynamic)-76 596 y(storage)d(allocation.)17 b(In)10 b(this)g(paper)o(,)g
(we)g(ha)o(v)o(e)f(in)o(v)o(estigated)g(using)g(infor)o(-)-76
637 y(mation)h(present)f(at)i(the)f(allocation)f(of)i(an)e(object)h(to)g
(predict)g(its)h(lifetime.)-76 679 y(W)m(e)e(ha)o(v)o(e)g(measured)e(\256v)o
(e)i(signi\256cant)f(allocation-intensi)o(v)o(e)g(C)h(programs)-76
720 y(to)h(determine)e(the)h(ef)o(fecti)o(v)o(eness)f(of)i(this)f(approach.)
-20 774 y(Our)16 b(results)f(sho)o(w)f(that)i(se)o(gre)o(gation)e(of)i
(short-li)o(v)o(ed)g(objects)e(into)-76 816 y(small)8 b(contiguous)f(areas)g
(of)h(memory)g(can)f(impro)o(v)o(e)h(the)g(reference)f(local-)-76
857 y(ity)13 b(and)e(total)i(memory)e(requirements)g(of)i(memory)e
(allocation.)22 b(In)12 b(one)-76 899 y(program,)h(where)f(lifetime)h
(prediction)f(was)f(particularly)i(ef)o(fecti)o(v)o(e,)h(the)-76
940 y(CPU)9 b(o)o(v)o(erhead)e(of)i(storage)f(allocation)g(was)g(also)g
(signi\256cantly)g(reduced.)-76 982 y(W)m(e)j(ha)o(v)o(e)f(seen)f(that)i(the)
g(allocation)f(site)h(\(intuiti)o(v)o(ely)n(,)h(an)f(abstraction)e(of)-76
1023 y(the)f(call-stack)f(at)i(the)f(point)g(of)g(allocation\))g(reliably)h
(predicts)e(short-li)o(v)o(ed)-76 1065 y(objects)j(for)h(a)g(broad)f(range)g
(of)h(programs;)g(40\261100\045)e(of)i(all)g(bytes)f(allo-)-76
1106 y(cated)e(by)g(a)g(program)h(are)f(predicted)g(to)h(be)f(short-li)o(v)o
(ed)h(by)g(the)f(allocation)-76 1148 y(site.)-20 1202 y(By)i(allocating)g
(short-li)o(v)o(ed)h(objects,)f(which)g(represent)f(a)h(lar)o(ge)h(frac-)-76
1243 y(tion)d(of)g(the)f(total)i(bytes)d(allocated,)i(in)f(a)h(small)f(arena)
g(area)g(\(64)h(kilobytes\),)-76 1285 y(reference)h(locality)g(is)h(impro)o
(v)o(ed.)15 b(Because)7 b(these)h(objects)h(are)g(not)h(com-)-76
1326 y(peting)d(for)i(space)d(in)h(the)h(heap,)f(heap)f(fragmentation)i(and)f
(size)f(is)i(reduced)-76 1368 y(for)j(programs)f(with)g(lar)o(ge)h(heaps.)k
(Lifetime)c(prediction)f(does)e(not)j(come)-76 1409 y(without)h(cost;)h(on)e
(the)g(SP)m(ARC)g(architecture,)h(we)g(estimate)f(18)g(instruc-)-76
1451 y(tions)e(per)g(allocation)f(are)h(required)g(to)g(attempt)g(to)h
(predict)f(if)h(an)e(object)h(is)-76 1492 y(short-li)o(v)o(ed.)23
b(Our)12 b(measurements)e(sho)o(w)h(that)h(the)g(CPU)g(o)o(v)o(erhead)f(of)h
(a)-76 1534 y(lifetime)e(predicting)e(allocator)h(is)f(often)h(comparable)e
(to)i(that)g(of)f(a)h(\256rst-\256t)-76 1575 y(allocator)n(.)-20
1629 y(This)k(paper)g(has)g(e)o(xplored)g(the)g(possibility)h(of)g(lifetime)h
(prediction)-76 1671 y(and)8 b(simulated)f(the)h(performance)g(of)g(one)f
(algorithm)i(based)e(on)g(this)i(idea.)-76 1712 y(Further)k(e)o(xploration)g
(of)g(algorithms)g(based)e(on)h(this)h(idea)f(are)h(required)-76
1754 y(to)g(fully)f(understand)f(its)h(performance)f(implications.)23
b(In)12 b(future)h(work,)-76 1795 y(we)g(will)i(b)o(uild)f(a)f(prototype)g
(implementation)g(of)h(the)g(most)f(promising)-76 1837 y(algorithms)e(and)e
(measure)g(the)i(performance)e(of)i(lifetime)h(predicting)e(al-)-76
1878 y(locators)f(directly)n(.)-76 1988 y Fn(7)41 b(Ackno)o(wledgements)-76
2081 y Fm(W)m(e)15 b(would)e(like)h(to)h(thank)f(John)f(Ellis,)k(Kinson)c
(Ho,)j(Dirk)f(Grunwald,)-76 2122 y(Rod)d(Oldehoeft,)i(and)e(the)h(anon)o
(ymous)e(re)o(vie)o(wers)h(for)i(their)f(insightful)-76 2164
y(comments.)30 b(This)15 b(material)h(is)f(based)e(upon)h(work)h(supported)e
(by)i(the)-76 2205 y(National)c(Science)e(F)o(oundation)h(under)g(Grant)h
(No.)18 b(CCR-9121269)9 b(and)-76 2247 y(by)g(a)g(Digital)h(Equipment)e
(Corporation)h(External)g(Research)e(Grant.)-76 2350 y Fn(References)-59
2427 y Fd([1])18 b(Thomas)12 b(Ball)h(and)f(James)g(R.)h(Larus.)25
b(Optimally)12 b(pro\256ling)g(and)g(tracing)-2 2464 y(programs.)j(In)9
b Fc(Confer)o(ence)f(Recor)o(d)g(of)h(the)h(Nineteenth)e(A)o(CM)i(Symposium)
-2 2501 y(on)5 b(Principles)g(of)g(Pr)o(ogramming)g(Langu)o(a)o(ges)o
Fd(,)t(pages)g(59\26170,)s(January)g(1992.)-59 2548 y([2])18
b(H.)13 b(Boehm)e(and)h(M.)g(W)m(eiser)n(.)24 b(Garbage)11
b(collection)g(in)i(an)f(uncooperati)o(ve)-2 2585 y(en)o(vironment.)24
b Fc(Softwar)o(e\320Practice)11 b(and)h(Experience)p Fd(,)i(pages)e
(807\261820,)-2 2622 y(September)c(1988.)1037 -34 y([3])18
b(Larry)9 b(Carter)n(.)16 b(Discussion)8 b(of)h(ef)o(\256cient)g(encoding)f
(of)h(call-chain)f(informa-)1094 3 y(tion.)k(Personal)c(communication,)e
(September)h(1992.)1037 57 y([4])18 b(Alan)10 b(Demers,)h(Mark)f(W)m(eiser)o
(,)h(Barry)f(Hayes,)h(Hans)f(Boehm,)g(Daniel)h(Bo-)1094 94
y(bro)o(w)n(,)h(and)e(Scott)i(Shenker)n(.)20 b(Combining)10
b(generational)f(and)i(conserv)o(ati)o(ve)1094 132 y(garbage)d(collection:)13
b(Frame)o(work)c(and)f(implementations.)14 b(In)9 b Fc(Confer)o(ence)1094
169 y(Recor)o(d)c(of)i(the)f(Seventeenth)s(A)o(CM)h(Symposium)e(on)g
(Principles)h(of)h(Pr)o(ogram-)1094 206 y(ming)h(Languages)p
Fd(,)d(pages)i(261\261269,)f(January)h(1990.)1037 260 y([5])18
b(John)10 b(DeT)o(re)o(ville.)20 b(Experience)9 b(with)i(concurrent)e
(garbage)g(collectors)i(for)1094 298 y(modula-2+.)d(T)n(echnical)d(Report)h
(64,)h(Digital)g(Equipment)e(Corporation)g(Sys-)1094 335 y(tem)j(Research)f
(Center)o(,)h(Palo)g(Alto,)g(CA,)h(November)d(1990.)1037 389
y([6])18 b(A.)12 b(Diwan,)g(E.)g(Moss,)f(and)g(R.)h(Hudson.)19
b(Compiler)11 b(support)f(for)h(garbage)1094 426 y(collection)e(in)g(a)g
(statically)h(typed)e(language.)13 b(In)d Fc(Pr)o(oceedings)d(of)i(the)g(A)o
(CM)1094 464 y(SIGPLAN)15 b('92)f(Confer)o(ence)e(on)h(Pr)o(ogramming)f
(Language)f(Design)j(and)1094 501 y(Implementation)p Fd(,)7
b(v)o(olume)f(27,)i(pages)e(273\261282,)f(San)j(Francisco,)f(CA,)h(June)1094
539 y(1992.)1037 592 y([7])18 b(Joseph)7 b(A.)h(Fisher)g(and)f(Stefan)h
(M.Freudenber)o(ger)n(.)i(Predicting)e(conditional)1094 630
y(branch)i(directions)g(from)h(pre)o(vious)f(runs)g(of)h(a)g(program.)19
b(In)11 b Fc(Pr)o(oceedings)1094 667 y(of)j(the)g(F)o(ifth)g(International)f
(Confer)o(ence)f(on)h(Ar)o(chitectural)f(Support)h(for)1094
705 y(Pr)o(ogramming)5 b(Languages)g(and)i(Operating)f(Systems)i
(\(ASPLOS-V\))p Fd(,)h(pages)1094 742 y(85\26195,)e(Boston,)g(MA,)i(October)e
(1992.)1037 796 y([8])18 b(Susan)10 b(L.)g(Graham,)g(Peter)h(B.)f(K)o(essler)
o(,)h(and)e(Marshall)g(K.)i(McKusick.)k(An)1094 833 y(execution)7
b(pro\256ler)j(for)g(modular)f(programs.)16 b Fc(Softwar)o(e)9
b(Practice)g(and)g(Ex-)1094 871 y(perience)p Fd(,)e(13:671\261685,)e(1983.)
1037 925 y([9])18 b(Dirk)6 b(Grunwald)f(and)g(Benjamin)g(Zorn.)j(C)p
Fb(USTO)p Fd(M)p Fb(ALLOC)p Fd(:)j(Ef)o(\256cient)c(synthe-)1094
962 y(sized)j(memory)g(allocators.)18 b(T)n(echnical)10 b(Report)g
(CU-CS-602-92,)h(Depart-)1094 999 y(ment)c(of)f(Computer)g(Science,)h(Uni)o
(versity)f(of)h(Colorado,)f(Boulder)o(,)g(Boulder)o(,)1094
1037 y(CO,)j(July)e(1992.)1020 1091 y([10])18 b(Da)o(vid)9
b(R.)h(Hanson.)k(Fast)9 b(allocation)g(and)f(deallcoation)g(of)h(memory)g
(based)1094 1128 y(on)g(object)f(lifetimes.)15 b Fc(Softwar)o(e\320Practice)7
b(and)h(Experience)p Fd(,)g(20\(1\):5\26112,)1094 1165 y(January)f(1990.)1020
1219 y([11])18 b(Barry)12 b(Hayes.)22 b(Using)11 b(key)g(object)g
(opportunism)f(to)i(collect)g(old)g(objects.)1094 1257 y(In)d
Fc(OOPSLA)o('91)g(Confer)o(ence)e(Pr)o(oceedings)p Fd(,)h(pages)g(33\26146,)g
(Phoenix,)h(AZ,)1094 1294 y(November)d(1991.)1020 1348 y([12])18
b(Raj)8 b(Jain)f(and)g(Imrich)g(Chlamtac.)k(The)c(P)p Fa(\303)p
Fd(2)h(algorithm)f(for)g(dynamic)f(calcu-)1094 1385 y(lation)h(of)g
(quantiles)g(and)f(histograms)g(without)h(storing)g(observ)o(ations.)i
Fc(Com-)1094 1423 y(munications)e(of)h(the)g(A)o(CM)p Fd(,)g
(28\(10\):1076\26110)o(85,)d(October)j(1985.)1020 1477 y([13])18
b(Donald)9 b(E.)i(Knuth.)17 b Fc(Fundamental)8 b(Algorithms)p
Fd(,)j(v)o(olume)e(1)h(of)g Fc(The)g(Art)g(of)1094 1514 y(Computer)d(Pr)o
(ogramming)p Fd(,)e(chapter)i(2,)h(pages)e(435\261451.)j(Addison)e(W)m(esley)
n(,)1094 1551 y(Reading,)g(MA,)h(2nd)g(edition,)f(1973.)1020
1605 y([14])18 b(James)8 b(R.)i(Larus.)j(Abstract)c(execution:)i(A)e
(technique)e(for)i(ef)o(\256ciently)f(trac-)1094 1643 y(ing)g(programs.)j
Fc(Softwar)o(e)c(Practice)g(and)h(Experience)p Fd(,)f(20\(12\):1241\2611)o
(25)o(8,)1094 1680 y(December)g(1990.)1020 1734 y([15])18 b(Henry)5
b(Lieberman)t(and)g(Carl)g(He)o(witt.)j(A)e(real-time)f(garbage)t(collector)g
(based)1094 1771 y(on)j(the)h(lifetimes)g(of)g(objects.)k Fc(Communications)7
b(of)i(the)f(A)o(CM)p Fd(,)i(26\(6\):419\261)1094 1809 y(429,)d(June)h(1983.)
1020 1863 y([16])18 b(Da)o(vid)9 b(A.)h(Moon.)k(Garbage)9 b(collection)f(in)i
(a)f(lar)o(ge)h(Lisp)f(system.)16 b(In)9 b Fc(Con-)1094 1900
y(fer)o(ence)e(Recor)o(d)g(of)h(the)g(1984)e(A)o(CM)j(Symposium)d(on)i(LISP)g
(and)g(Functional)1094 1937 y(Pr)o(ogramming)p Fd(,)e(pages)h(235\261246,)e
(Austin,)k(T)n(exas,)e(August)g(1984.)1020 1991 y([17])18 b(Bjarne)d
(Stroustrup.)30 b Fc(The)15 b(C++)h(Pr)o(ogramming)d(Language)p
Fd(.)28 b(Addison-)1094 2029 y(W)m(esley)9 b(Series)h(in)f(Computer)g
(Science.)g(Addison-W)m(esley)n(,)f(Reading,)h(MA,)1094 2066
y(2nd)e(edition,)h(1991.)1020 2120 y([18])18 b(Da)o(vid)9 b(Ungar)n(.)16
b(Generation)8 b(sca)o(venging:)13 b(A)d(non-disrupti)o(ve)d(high)i(perfor)o
(-)1094 2157 y(mance)g(storage)g(reclamation)h(algorithm.)17
b(In)10 b Fc(SIGSOFT/SIGPLAN)h(Prac-)1094 2195 y(tical)g(Pr)o(ogramming)d(En)
o(vir)o(onments)h(Confer)o(ence)p Fd(,)g(pages)h(157\261167,)f(April)1094
2232 y(1984.)1020 2286 y([19])18 b(Da)o(vid)7 b(Ungar)f(and)h(Frank)g
(Jackson.)h(An)f(adapti)o(ve)f(tenuring)g(policy)g(for)h(gen-)1094
2323 y(eration)j(sca)o(vengers.)17 b Fc(A)o(CM)12 b(T)n(ransactions)d(on)h
(Pr)o(ogramming)e(Languages)1094 2361 y(and)f(Systems)p Fd(,)h
(14\(1\):1\26127,)e(January)h(1992.)1020 2415 y([20])18 b(Da)o(vid)9
b(W)m(.)i(W)m(all.)17 b(Predicting)9 b(program)f(beha)o(vior)g(using)h(real)h
(or)f(estimated)1094 2452 y(pro\256les.)g(In)c Fc(Pr)o(oceedings)t(of)h(the)g
(A)o(CM)h(SIGPLAN)g('91)e(Confer)o(ence)t(on)h(Pr)o(o-)1094
2490 y(gramming)j(Language)f(Design)i(and)g(Implementation)p
Fd(,)g(v)o(olume)g(26,)h(pages)1094 2527 y(59\26170,)c(T)m(oronto,)h
(Ontario,)g(Canada,)f(June)g(1991.)1020 2581 y([21])18 b(Paul)8
b(R.)g(W)o(ilson.)j(Opportunistic)c(garbage)f(collection.)11
b Fc(SIGPLAN)d(Notices)p Fd(,)1094 2618 y(23\(12\):98\261102)o(,)e(December)h
(1988.)p eop
%%Page: 11 11
11 10 bop -76 -34 a Fd([22])18 b(Benjamin)5 b(Zorn.)j(The)e(measured)t(cost)g
(of)f(conserv)o(ati)o(ve)t(garbage)t(collection.)-2 3 y Fc(Softwar)o
(e\320Practice)h(and)h(Experience)p Fd(,)g(1993.)k(T)m(o)d(appear)n(.)-76
57 y([23])18 b(Benjamin)10 b(Zorn)g(and)f(Dirk)i(Grunwald.)16
b(Empirical)11 b(measurements)d(of)j(six)-2 94 y(allocation-intensi)o(ve)g(C)
h(programs.)23 b Fc(SIGPLAN)14 b(Notices)p Fd(,)f(27\(12\):71\26180,)-2
132 y(December)7 b(1992.)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
