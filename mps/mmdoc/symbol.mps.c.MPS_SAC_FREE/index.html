<?xml version="1.0" encoding="UTF-8"?>



<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">



 <html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>

  <head>

   <title>MPS C Interface: function mps_sac_free</title>

  </head>

  <body bgcolor='#FFFFFF' text='#000000' link='#000099' vlink='#660066' alink='#FF0000'>

   <div align='center'>

    <h1>MPS C Interface: function mps_sac_free</h1>

    <p>draft</p>

    <address>pekka, 1999-03-04</address>

   </div>

   <h2>

    <a id='section-name' name='section-name'>Name</a>

   </h2>

   <p>

    mps_sac_free

    <br />

   </p>

   <h2>

    <a id='section-summary' name='section-summary'>Summary</a>

   </h2>

   <p>

    This function frees an object using the segregated allocation cache given.

    <br />

   </p>

   <h2>

    <a id='section-associated-protocols' name='section-associated-protocols'>Associated Protocols</a>

   </h2>

   <p>

    Allocation cache

    <br />

   </p>

   <h2>

    <a id='section-type' name='section-type'>Type</a>

   </h2>

   <p>void mps_sac_free(mps_sac_t sac, mps_addr_t p, size_t size);</p>

   <h2>

    <a id='section-arguments' name='section-arguments'>Arguments</a>

   </h2>

   <p>sac                      the segregated allocation cache</p>

   <p>

    p                        a pointer to the block

     being freed

   </p>

   <p>size                     the size of the block being freed</p>

   <h2>

    <a id='section-returned-values' name='section-returned-values'>Returned Values</a>

   </h2>

   <p>None.</p>

   <h2>

    <a id='section-resources' name='section-resources'>Resources</a>

   </h2>

   <p>mps.h</p>

   <h2>

    <a id='section-description' name='section-description'>Description</a>

   </h2>

   <p>

    This function frees an object using the cache given.  If the cache would become too full, some blocks are returned to the associated pool.  

    <code>size</code>

     should be the size that was specified when the object was allocated (the cache knows what the real size of the block is).  The object must have been allocated through a segregated allocation cache with the same class structure,

     attached to the same pool.

   </p>

   <p>The client is responsible for synchronising the access to the cache, but if the cache decides to access the pool, the MPS will properly synchronize with any other threads that might be accessing the same pool.</p>

   <h2>

    <a id='section-example' name='section-example'>Example</a>

   </h2>

   <p>

    <pre>  void *p;

  Foo *foo;

  res = mps_sac_alloc(&amp;p, sac, FooSIZE, is_in_panic);

  if (res != MPS_RES_OK) {

    printf("Failed to alloc foo!\n"); exit(1);

  }

  foo = p;

  /* use foo */

  mps_sac_free(sac, p, FooSIZE);</pre>

   </p>

   <h2>

    <a id='section-see-also' name='section-see-also'>See Also</a>

   </h2>

   <p>

    <pre>MPS_SAC_FREE_FAST, mps_sac_alloc, MPS_SAC_ALLOC_FAST, mps_sac_t</pre>

    <br />

   </p>

   <h2>

    <a id='section-notes' name='section-notes'>Notes</a>

   </h2>

   <p>Usually, you'd use the same cache to allocate and deallocate an object.</p>

   <p>

    There's also a macro called 

    <code>MPS_SAC_FREE_FAST</code>

    , that does the same thing.

      The macro is faster, but generates more code and does no checking.

   </p>

   <p>

    Note that 

    <code>mps_sac_free</code>

     does very little checking; it's optimized for speed.  Double frees and other mistakes will only be detected when the cache is flushed (which can happen by demand through mps_sac_flush or automatically), unless intervening operations have obscured symptom.

   </p>

   <h2>

    <a id='section-A' name='section-A'>A. References</a>

   </h2>

   <h2>

    <a id='section-B' name='section-B'>B. Document History</a>

   </h2>

   <table>

    <tr valign='top'>

     <td>1999-03-04 13:37:04 +00</td>

     <td>pekka</td>

     <td>New document saved</td>

    </tr>

    <tr valign='top'>

     <td>1999-03-22 18:23:53 +00</td>

     <td>pekka</td>

     <td>more explicit doc; add example</td>

    </tr>

    <tr valign='top'>

     <td>1999-03-25 14:49:41 +00</td>

     <td>pekka</td>

     <td>small fix</td>

    </tr>

    <tr valign='top'>

     <td>2000-08-16 13:31:25 +01</td>

     <td>pekka</td>

     <td>note no checks</td>

    </tr>

    <tr valign='top'>

     <td>2001-09-26</td>

     <td>

      <a href='mailto:ndl@ravenbrook.com'>NDL</a>

     </td>

     <td>Converted from xml to html (second pass).</td>

    </tr>

   </table>

   <hr />

   <p>

    <small>Copyright &copy; 2001 Ravenbrook Limited.  This document is provided "as is", without any express or implied warranty.  In no event will the authors be held liable for any damages arising from the use of this document.  You may not duplicate or reproduce this document in any form without the express permission of the copyright holder.</small>

   </p>

   <div align='center'>

    <p>

     <code>$Id$</code>

    </p>

   </div>

  </body>

 </html>

