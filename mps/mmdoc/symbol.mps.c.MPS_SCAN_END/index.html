<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">

 <html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>
  <head>
   <title>MPS C Interface: macro MPS_SCAN_END</title>
  </head>
  <body bgcolor='#FFFFFF' text='#000000' link='#000099' vlink='#660066' alink='#FF0000'>
   <div align='center'>
    <h1>MPS C Interface: macro MPS_SCAN_END</h1>
    <p>draft</p>
    <address>pekka, 1998-01-27</address>
   </div>
   <h2>
    <a id='section-name' name='section-name'>Name</a>
   </h2>
   <p>
    MPS_SCAN_END
    <br />
   </p>
   <h2>
    <a id='section-summary' name='section-summary'>Summary</a>
   </h2>
   <p>
    The macro 
    <code>MPS_SCAN_END</code>
     is part of the scanning protocol; it terminates a block started by 
    <code>MPS_SCAN_BEGIN</code>
    .
   </p>
   <h2>
    <a id='section-associated-protocols' name='section-associated-protocols'>Associated Protocols</a>
   </h2>
   <p>Scanning.</p>
   <h2>
    <a id='section-syntax' name='section-syntax'>Syntax</a>
   </h2>
   <p>MPS_SCAN_END(ss);</p>
   <h2>
    <a id='section-arguments' name='section-arguments'>Arguments</a>
   </h2>
   <p>ss    the scan state argument that was passed to the scanning function</p>
   <h2>
    <a id='section-resources' name='section-resources'>Resources</a>
   </h2>
   <p>mps.h</p>
   <h2>
    <a id='section-description' name='section-description'>Description</a>
   </h2>
   <p>
    This macro is used in the scanning protocol.  Together with 
    <code>MPS_SCAN_BEGIN</code>
    , it sets up local information used by the fast 
    <code>MPS_FIX*</code>
     macros.  
    Note that 
    <code>MPS_SCAN_END</code>
     completes the scanning, so 
    successful termination of the scanning must invoke it (error branches can return without passing through).
    <br />
   </p>
   <h2>
    <a id='section-example' name='section-example'>Example</a>
   </h2>
   <p>
    mps_res_t scan_array(mps_ss_t ss, mps_addr_t object, size_t length)
{
    <br />
      size_t i;
   </p>
   <p>  mps_res_t res;</p>
   <p>  mps_addr_t *array = (mps_addr_t *)object;</p>
   <p>  MPS_SCAN_BEGIN(ss)</p>
   <p>    for(i = 0; i &lt; length; ++i) {</p>
   <p>      res = MPS_FIX12(ss, &amp;array[i]);</p>
   <p>      if(res != MPS_RES_OK) return res;</p>
   <p>    }</p>
   <p>  MPS_SCAN_END(ss);</p>
   <p>
      return res;
    <br />
    }
   </p>
   <h2>
    <a id='section-see-also' name='section-see-also'>See Also</a>
   </h2>
   <p>
    MPS_SCAN_BEGIN, MPS_FIX1
    2, MPS_FIX1
    , MPS_FIX2, MPS_FIX_CALL
    <br />
   </p>
   <h2>
    <a id='section-notes' name='section-notes'>Notes</a>
   </h2>
   <p>Between MPS_SCAN_BEGIN and MPS_SCAN_END, you may not call another scanning function directly, because the scan state parameter is in a strange state, so you shouldn't pass it as an argument to a function.  However, you can pass the scan state using MPS_FIX_CALL.</p>
   <h2>
    <a id='section-A' name='section-A'>A. References</a>
   </h2>
   <h2>
    <a id='section-B' name='section-B'>B. Document History</a>
   </h2>
   <table>
    <tr valign='top'>
     <td>1998-01-27 19:39:41 +00</td>
     <td>pekka</td>
     <td>New document saved</td>
    </tr>
    <tr valign='top'>
     <td>2000-06-06 15:51:16 +01</td>
     <td>pekka</td>
     <td>clean up; MPS_FIX12</td>
    </tr>
    <tr valign='top'>
     <td>2001-09-26</td>
     <td>
      <a href='mailto:ndl@ravenbrook.com'>NDL</a>
     </td>
     <td>Converted from xml to html (second pass).</td>
    </tr>
   </table>
   <hr />
   <p>
    <small>Copyright &copy; 2001 Ravenbrook Limited.  This document is provided "as is", without any express or implied warranty.  In no event will the authors be held liable for any damages arising from the use of this document.  You may not duplicate or reproduce this document in any form without the express permission of the copyright holder.</small>
   </p>
   <div align='center'>
    <p>
     <code>$Id$</code>
    </p>
   </div>
  </body>
 </html>
