<?xml version="1.0" encoding="UTF-8"?>



<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">



 <html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>

  <head>

   <title>MPS C Interface: type mps_sac_classes_s</title>

  </head>

  <body bgcolor='#FFFFFF' text='#000000' link='#000099' vlink='#660066' alink='#FF0000'>

   <div align='center'>

    <h1>MPS C Interface: type mps_sac_classes_s</h1>

    <p>draft</p>

    <address>pekka, 1999-03-05</address>

   </div>

   <h2>

    <a id='section-name' name='section-name'>Name</a>

   </h2>

   <p>mps_sac_classes_s</p>

   <h2>

    <a id='section-summary' name='section-summary'>Summary</a>

   </h2>

   <p>

    A structure 

    describing a size class to be passed as an 

    argument to 

    mps_sac_create

    .

   </p>

   <h2>

    <a id='section-associated-protocols' name='section-associated-protocols'>Associated Protocols</a>

   </h2>

   <p>Allocation cache</p>

   <h2>

    <a id='section-type' name='section-type'>Type</a>

   </h2>

   <p>

    <pre>typedef struct mps_sac_classes_s {

  size_t mps_block_size;

  size_t mps_cached_count;</pre>

   </p>

   <p>

    <pre>  unsigned mps_frequency;

} mps_sac_classes_s;</pre>

    <br />

   </p>

   <h2>

    <a id='section-resources' name='section-resources'>Resources</a>

   </h2>

   <p>mps.h</p>

   <h2>

    <a id='section-description' name='section-description'>Description</a>

   </h2>

   <p>

    <code>mps_sac_classes_s</code>

     is the element t

    ype of the array passed to 

    <code>mps_sac_create</code>

     to describ

    e the size classes.  Each element of this array describes one class

     by specifying 

    <code>block_size</code>

    , the maximum size (in bytes) in this class; 

    <code>cached_count</code>

    , the number of objects of this class to cache

    ; and 

    <code>frequency</code>

    , a number that describes the frequency of requests (allocation and deallocation

     combined

    ) in this class

     relative

     to all the other classes.  The classes should be given in the order of ascending size.

   </p>

   <p>

    <code>block_size</code>

    s have to be aligned to the pool alignment.  All sizes must be different, and the smallest size must be large enough to hold a 

    <pre>void *</pre>

    .

   </p>

   <p>

    <code>cached_count</code>

     is

     advice to the MPS on how many blocks to cache, not an absolute limit.  The cache policy tries to accommodate fluctuations in the population and minimize the cost of responding to client requests; the purpose of this parameter is to limit how much memory the client is willing to set aside for this purpose.  However, a 

    <code>cached_count</code>

     of zero prevents any caching of blocks falling into that class.

   </p>

   <p>

    The MPS automatically provides an "overlarge" class

     for arbitrarily large objects

     above the largest class described.  Allocations falling into the overlarge class are not cached.

   </p>

   <h2>

    <a id='section-example' name='section-example'>Example</a>

   </h2>

   <p>

    <pre>  mps_sac_t sac;

  mps_sac_classes_s classes[3] = { {8, 38, 1}, {136, 19, 3}, {512, 4, 1} };

  res = mps_sac_create(&amp;sac, pool, 3, classes);

  if (res != MPS_RES_OK) {

    printf("Failed to create the allocation cache!"); exit(1);

  }</pre>

   </p>

   <h2>

    <a id='section-see-also' name='section-see-also'>See Also</a>

   </h2>

   <p>symbol.mps.c.mps_sac_create</p>

   <h2>

    <a id='section-notes' name='section-notes'>Notes</a>

   </h2>

   <p>Any blocks whose size falls between two classes are allocated from the larger class.</p>

   <h2>

    <a id='section-A' name='section-A'>A. References</a>

   </h2>

   <h2>

    <a id='section-B' name='section-B'>B. Document History</a>

   </h2>

   <table>

    <tr valign='top'>

     <td>1999-03-05 16:04:59 +00</td>

     <td>pekka</td>

     <td>New document saved</td>

    </tr>

    <tr valign='top'>

     <td>1999-03-11 20:50:19 +00</td>

     <td>pekka</td>

     <td>New structure</td>

    </tr>

    <tr valign='top'>

     <td>1999-03-17 14:00:55 +00</td>

     <td>pekka</td>

     <td>add order</td>

    </tr>

    <tr valign='top'>

     <td>1999-03-18 16:56:19 +00</td>

     <td>pekka</td>

     <td>Change it to a structure</td>

    </tr>

    <tr valign='top'>

     <td>1999-03-22 20:39:47 +00</td>

     <td>pekka</td>

     <td>more about cached_count</td>

    </tr>

    <tr valign='top'>

     <td>1999-03-23 13:36:20 +00</td>

     <td>pekka</td>

     <td>Change field names; clarify sizes</td>

    </tr>

    <tr valign='top'>

     <td>1999-04-01 16:32:55 +01</td>

     <td>pekka</td>

     <td>Note void * req</td>

    </tr>

    <tr valign='top'>

     <td>2001-09-26</td>

     <td>

      <a href='mailto:ndl@ravenbrook.com'>NDL</a>

     </td>

     <td>Converted from xml to html (second pass).</td>

    </tr>

   </table>

   <hr />

   <p>

    <small>Copyright &copy; 2001 Ravenbrook Limited.  This document is provided "as is", without any express or implied warranty.  In no event will the authors be held liable for any damages arising from the use of this document.  You may not duplicate or reproduce this document in any form without the express permission of the copyright holder.</small>

   </p>

   <div align='center'>

    <p>

     <code>$Id$</code>

    </p>

   </div>

  </body>

 </html>

