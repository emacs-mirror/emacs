<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">

 <html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>
  <head>
   <title>MPS C Interface: function mps_class_epvm</title>
  </head>
  <body bgcolor='#FFFFFF' text='#000000' link='#000099' vlink='#660066' alink='#FF0000'>
   <div align='center'>
    <h1>MPS C Interface: function mps_class_epvm</h1>
    <p>incomplete</p>
    <address>pekka, 1998-01-22</address>
   </div>
   <h2>
    <a id='section-name' name='section-name'>Name</a>
   </h2>
   <p>mps_class_epvm</p>
   <h2>
    <a id='section-summary' name='section-summary'>Summary</a>
   </h2>
   <p>
    "
    mps_class_epvm
    " returns the EPVM pool class.
   </p>
   <h2>
    <a id='section-associated-protocols' name='section-associated-protocols'>Associated Protocols</a>
   </h2>
   <p>Allocation point.</p>
   <h2>
    <a id='section-syntax' name='section-syntax'>Syntax</a>
   </h2>
   <p>
    mps_class_t mps_class_epvm(void);
    <br />
   </p>
   <h2>
    <a id='section-arguments' name='section-arguments'>Arguments</a>
   </h2>
   <p>None.</p>
   <h2>
    <a id='section-returned-values' name='section-returned-values'>Returned Values</a>
   </h2>
   <h2>
    <a id='section-r' name='section-r'>R</a>
   </h2>
   <p>eturns the EPVM pool class.</p>
   <h2>
    <a id='section-resources' name='section-resources'>Resources</a>
   </h2>
   <p>mpscepvm.h.</p>
   <h2>
    <a id='section-description' name='section-description'>Description</a>
   </h2>
   <p>This function is used to get hold of the EPVM pool class, for the purpose of passing it to "mps_pool_create".</p>
   <p>The EPVM pool class allows the creation of formatted, collected pools with various additional special properties, including a stack-oriented manual free (save and restore).</p>
   <h2>
    <a id='section-example' name='section-example'>Example</a>
   </h2>
   <p>if(mps_pool_create(&amp;pool, arena, mps_class_epvm(), fmt, maxSAVE, 0)</p>
   <p>   != MPS_RES_OK) {</p>
   <p>  printf("Error creating pool!"); exit(2);</p>
   <p>
    }
    <br />
   </p>
   <h2>
    <a id='section-error-handling' name='section-error-handling'>Error Handling</a>
   </h2>
   <p>Never fails.</p>
   <h2>
    <a id='section-see-also' name='section-see-also'>See Also</a>
   </h2>
   <p>
    mps_pool_create
    , mps_epvm_save_level_t, 
    mps_fmt_t, mps_epvm_save, mps_epvm_restore, mps_epvm_check
   </p>
   <h2>
    <a id='section-notes' name='section-notes'>Notes</a>
   </h2>
   <p>Creation</p>
   <p>
    <br />
    This pool class has three extra parameters to mps_pool_create:
    <br />
      mps_res_t mps_pool_create(mps_pool_t * pool, mps_arena_t arena,
                            mps_class_t epvm_class, mps_fmt_t format,
    <br />
                                mps_epvm_save_level_t max_save,
                            mps_epvm_save_level_t init_save);
    <br />
    "format" is the format used for the objects in this pool, "max_save" is the maximum save level and "init_save" the initial save level.  The only format methods that are used are Align, Skip and Scan.  The alignment must be a power of two.
   </p>
   <p>Objects</p>
   <p>
    There's one extra parameter for mps_ap_create:
    <br />
      mps_res_t mps_ap_create(mps_ap_t *ap, mps_pool_t pool,
                          mps_bool_t is_obj);
    <br />
    Specifying true for "is_obj" means you want to allocate objects with references of "RANKExact" in them, false means only objects with no references in them.  We call the former "
    object allocation points
    " and the latter "
    string allocation points".
    <br />
   </p>
   <p>
    Objects of any size (that is a multiple of the alignment) may be allocated, but they are considered to be vectors of "grains", each being the size of the alignment.  Each grain can be independe
    ntly
     reclaimed by the garbage collector
    .  
    Fixing a reference to an EPVM pool applies to the grain 
    being referenced only.  
    Therefore, the scanning method of 
    any pool or root which references an object in an EPVM pool must separately fix every grain that the reference is used to access.  This also implies that the 
    Skip method should advance by the size of the alignment.
   </p>
   <p>Only exact and weak references to EPVM objects are supported at the moment.</p>
   <p>
    GC in EPVM pools does not move objects.  This means that vectors of grains will stay contiguous, and subvectors can be represented by a pointer into the middle of the vector and a length.  References to subvectors allocated from object allocation points must be aligned, but subvectors from string 
    allocation points need not be.
   </p>
   <h2>
    <a id='section-A' name='section-A'>A. References</a>
   </h2>
   <h2>
    <a id='section-B' name='section-B'>B. Document History</a>
   </h2>
   <table>
    <tr valign='top'>
     <td>1998-01-22 18:31:16 +00</td>
     <td />
     <td>New document saved</td>
    </tr>
    <tr valign='top'>
     <td>1998-01-22 18:31:20 +00</td>
     <td>pekka</td>
     <td>New document saved</td>
    </tr>
    <tr valign='top'>
     <td>1998-01-23 14:06:40 +00</td>
     <td>pekka</td>
     <td>added more xrefs</td>
    </tr>
    <tr valign='top'>
     <td>1998-06-08 17:01:36 +01</td>
     <td>pekka</td>
     <td>Described Skip method</td>
    </tr>
    <tr valign='top'>
     <td>1998-06-09 14:16:36 +01</td>
     <td>pekka</td>
     <td>noted that only exact and weak references are supported</td>
    </tr>
    <tr valign='top'>
     <td>2000-05-22 16:23:27 +01</td>
     <td>pekka</td>
     <td>clean up</td>
    </tr>
    <tr valign='top'>
     <td>2001-09-26</td>
     <td>
      <a href='mailto:ndl@ravenbrook.com'>NDL</a>
     </td>
     <td>Converted from xml to html (second pass).</td>
    </tr>
   </table>
   <hr />
   <p>
    <small>Copyright &copy; 2001 Ravenbrook Limited.  This document is provided "as is", without any express or implied warranty.  In no event will the authors be held liable for any damages arising from the use of this document.  You may not duplicate or reproduce this document in any form without the express permission of the copyright holder.</small>
   </p>
   <div align='center'>
    <p>
     <code>$Id$</code>
    </p>
   </div>
  </body>
 </html>
