<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">

 <html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>
  <head>
   <title>MPS C Interface: function mps_fix</title>
  </head>
  <body bgcolor='#FFFFFF' text='#000000' link='#000099' vlink='#660066' alink='#FF0000'>
   <div align='center'>
    <h1>MPS C Interface: function mps_fix</h1>
    <p>draft</p>
    <address> <a href='mailto:grm@ravenbrook.com'>GRM</a>
, 1997-05-02</address>
   </div>
   <h2>
    <a id='section-name' name='section-name'>Name</a>
   </h2>
   <p>mps_fix</p>
   <h2>
    <a id='section-summary' name='section-summary'>Summary</a>
   </h2>
   <p>
    The function 
    mps_fix is the part of the scanning protocol used to indicate references to the MPS.  It may only be called from within a scanning function.
   </p>
   <h2>
    <a id='section-associated-protocols' name='section-associated-protocols'>Associated Protocols</a>
   </h2>
   <p>Scanning.</p>
   <h2>
    <a id='section-syntax' name='section-syntax'>Syntax</a>
   </h2>
   <p>mps_res_t mps_fix(mps_ss_t mps_ss, mps_addr_t *ref_io)</p>
   <h2>
    <a id='section-arguments' name='section-arguments'>Arguments</a>
   </h2>
   <p>mps_ss    the scan state argument that was passed to the scanning function</p>
   <p>ref_io    a pointer to a reference within the object being scanned</p>
   <h2>
    <a id='section-returned-values' name='section-returned-values'>Returned Values</a>
   </h2>
   <p>Returns a result code, see ERROR HANDLING.</p>
   <p>
    If the reference rank of the object being scanned is not 
    <code>MPS_RANK_AMBIG</code>
     then the reference pointed to by 
    <code>ref_io</code>
     may be modified by 
    <code>mps_fix</code>
    .
   </p>
   <h2>
    <a id='section-resources' name='section-resources'>Resources</a>
   </h2>
   <p>mps.h</p>
   <h2>
    <a id='section-description' name='section-description'>Description</a>
   </h2>
   <p>
    This function is the part of the scanning protocol used to indicate references.  Scanning functions apply it, 
    or 
    <code>MPS_FIX12,</code>
    or 
    <code>MPS_FIX1</code>
     and 
    <code>MPS_FIX2</code>
     to the references in the object being scanned.
   </p>
   <p>
    It may only be called from within a scanning function.  If it is called within a
    <code>MPS_SCAN_BEGIN</code>
     block, 
    <code>MPS_FIX_CALL</code>
     must be used (yes, really).
   </p>
   <p>
    This function does not perform any particular operation.  The MPS may call scanning functions for a number of reasons, and 
    <code>mps_fix</code>
     may take different actions depending on those reasons.
   </p>
   <h2>
    <a id='section-example' name='section-example'>Example</a>
   </h2>
   <p>
    mps_res_t scan_array(mps_ss_t ss, mps_addr_t object
    , size_t length
    )
    <br />
    {
    <br />
      size_t i;
   </p>
   <p>  mps_res_t res;</p>
   <p>  mps_addr_t *array = (mps_addr_t *)object;</p>
   <p>  for(i = 0; i &lt; length; ++i) {</p>
   <p>    res = mps_fix(ss, &amp;array[i]);</p>
   <p>    if(res != MPS_RES_OK) return res;</p>
   <p>  }</p>
   <p>
      return res;
    <br />
    }
   </p>
   <h2>
    <a id='section-error-handling' name='section-error-handling'>Error Handling</a>
   </h2>
   <p>The function returns MPS_RES_OK if it was successful, in which case the scanning function should continue to scan the rest of the object, applying mps_fix to the remaining references.  If mps_fix returns a value other than MPS_RES_OK, the scanning function must return that value, and may return without scanning further references.  Generally, it is better if it returns as soon as possible.</p>
   <h2>
    <a id='section-see-also' name='section-see-also'>See Also</a>
   </h2>
   <p>mps_ss_t, mps_root_scan_t, mps_fmt_scan_t, mps_reg_scan_t, MPS_SCAN_BEGIN, MPS_SCAN_END, MPS_FIX12, MPS_FIX1, MPS_FIX2, MPS_FIX_CALL</p>
   <h2>
    <a id='section-A' name='section-A'>A. References</a>
   </h2>
   <h2>
    <a id='section-B' name='section-B'>B. Document History</a>
   </h2>
   <table>
    <tr valign='top'>
     <td>1997-05-02 22:39:12 +01</td>
     <td />
     <td>New document saved</td>
    </tr>
    <tr valign='top'>
     <td>1997-05-02 22:40:03 +01</td>
     <td />
     <td></td>
    </tr>
    <tr valign='top'>
     <td>1997-05-02 22:54:14 +01</td>
     <td />
     <td></td>
    </tr>
    <tr valign='top'>
     <td>1997-05-05 17:02:51 +01</td>
     <td />
     <td></td>
    </tr>
    <tr valign='top'>
     <td>1997-05-06 14:45:56 +01</td>
     <td />
     <td></td>
    </tr>
    <tr valign='top'>
     <td>1997-05-06 14:49:24 +01</td>
     <td />
     <td></td>
    </tr>
    <tr valign='top'>
     <td>1997-05-06 14:53:09 +01</td>
     <td />
     <td></td>
    </tr>
    <tr valign='top'>
     <td>1997-06-10 15:00:34 -04</td>
     <td />
     <td>Some very minor edits.</td>
    </tr>
    <tr valign='top'>
     <td>1997-06-21 15:03:50 -04</td>
     <td>lmb</td>
     <td>Some small edits.</td>
    </tr>
    <tr valign='top'>
     <td>1997-06-21 15:14:21 -04</td>
     <td>lmb</td>
     <td>Changed title.</td>
    </tr>
    <tr valign='top'>
     <td>1997-10-28 12:40:56 -05</td>
     <td>lmb</td>
     <td>Deleted TYPE and STRUCTURE; added protocols to SEE ALSO</td>
    </tr>
    <tr valign='top'>
     <td>1997-12-03 13:45:23 +00</td>
     <td>pekka</td>
     <td>Added a proper description, with the MPS_SCAN_BEGIN restriction</td>
    </tr>
    <tr valign='top'>
     <td>1998-01-16 18:26:19 +00</td>
     <td>pekka</td>
     <td>Some minor edits</td>
    </tr>
    <tr valign='top'>
     <td>1998-01-23 19:31:44 +00</td>
     <td>pekka</td>
     <td>Removed obsolete comments</td>
    </tr>
    <tr valign='top'>
     <td>2000-05-22 16:26:27 +01</td>
     <td>pekka</td>
     <td>clean up</td>
    </tr>
    <tr valign='top'>
     <td>2000-06-06 15:37:05 +01</td>
     <td>pekka</td>
     <td>MPS_FIX12</td>
    </tr>
    <tr valign='top'>
     <td>2001-09-26</td>
     <td>
      <a href='mailto:ndl@ravenbrook.com'>NDL</a>
     </td>
     <td>Converted from xml to html (second pass).</td>
    </tr>
   </table>
   <hr />
   <p>
    <small>Copyright &copy; 2001 Ravenbrook Limited.  This document is provided "as is", without any express or implied warranty.  In no event will the authors be held liable for any damages arising from the use of this document.  You may not duplicate or reproduce this document in any form without the express permission of the copyright holder.</small>
   </p>
   <div align='center'>
    <p>
     <code>$Id$</code>
    </p>
   </div>
  </body>
 </html>
